{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.search.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\n\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\n\nvar _query = _interopRequireDefault(require(\"../../data/query\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar SEARCH_PANEL_CLASS = \"search-panel\";\nvar SEARCH_TEXT_CLASS = \"search-text\";\nvar HEADER_PANEL_CLASS = \"header-panel\";\nvar FILTERING_TIMEOUT = 700;\n\nfunction allowSearch(column) {\n  return (0, _type.isDefined)(column.allowSearch) ? column.allowSearch : column.allowFiltering;\n}\n\nfunction parseValue(column, text) {\n  var lookup = column.lookup;\n\n  if (!column.parseValue) {\n    return text;\n  }\n\n  if (lookup) {\n    return column.parseValue.call(lookup, text);\n  }\n\n  return column.parseValue(text);\n}\n\nvar _default = {\n  defaultOptions: function () {\n    return {\n      searchPanel: {\n        visible: false,\n        width: 160,\n        placeholder: _message.default.format(\"dxDataGrid-searchPanelPlaceholder\"),\n        highlightSearchText: true,\n        highlightCaseSensitive: false,\n        text: \"\",\n        searchVisibleColumnsOnly: false\n      }\n    };\n  },\n  extenders: {\n    controllers: {\n      data: function () {\n        var calculateSearchFilter = function (that, text) {\n          var i;\n          var column;\n\n          var columns = that._columnsController.getColumns();\n\n          var searchVisibleColumnsOnly = that.option(\"searchPanel.searchVisibleColumnsOnly\");\n          var lookup;\n          var filters = [];\n\n          if (!text) {\n            return null;\n          }\n\n          function onQueryDone(items) {\n            var valueGetter = (0, _data.compileGetter)(lookup.valueExpr);\n\n            for (var _i = 0; _i < items.length; _i++) {\n              var value = valueGetter(items[_i]);\n              filters.push(column.createFilterExpression(value, null, \"search\"));\n            }\n          }\n\n          for (i = 0; i < columns.length; i++) {\n            column = columns[i];\n\n            if (searchVisibleColumnsOnly && !column.visible) {\n              continue;\n            }\n\n            if (allowSearch(column) && column.calculateFilterExpression) {\n              lookup = column.lookup;\n              var filterValue = parseValue(column, text);\n\n              if (lookup && lookup.items) {\n                (0, _query.default)(lookup.items).filter(column.createFilterExpression.call({\n                  dataField: lookup.displayExpr,\n                  dataType: lookup.dataType,\n                  calculateFilterExpression: column.calculateFilterExpression\n                }, filterValue, null, \"search\")).enumerate().done(onQueryDone);\n              } else {\n                if (void 0 !== filterValue) {\n                  filters.push(column.createFilterExpression(filterValue, null, \"search\"));\n                }\n              }\n            }\n          }\n\n          return _uiGrid_core.default.combineFilters(filters, \"or\");\n        };\n\n        return {\n          publicMethods: function () {\n            return this.callBase().concat([\"searchByText\"]);\n          },\n          _calculateAdditionalFilter: function () {\n            var that = this;\n            var filter = that.callBase();\n            var searchFilter = calculateSearchFilter(that, that.option(\"searchPanel.text\"));\n            return _uiGrid_core.default.combineFilters([filter, searchFilter]);\n          },\n          searchByText: function (text) {\n            this.option(\"searchPanel.text\", text);\n          },\n          optionChanged: function (args) {\n            var that = this;\n\n            switch (args.fullName) {\n              case \"searchPanel.text\":\n              case \"searchPanel\":\n                that._applyFilter();\n\n                args.handled = true;\n                break;\n\n              default:\n                that.callBase(args);\n            }\n          }\n        };\n      }()\n    },\n    views: {\n      headerPanel: function () {\n        var getSearchPanelOptions = function (that) {\n          return that.option(\"searchPanel\");\n        };\n\n        return {\n          _getToolbarItems: function () {\n            var items = this.callBase();\n            return this._prepareSearchItem(items);\n          },\n          _prepareSearchItem: function (items) {\n            var that = this;\n            var dataController = that.getController(\"data\");\n            var searchPanelOptions = getSearchPanelOptions(that);\n\n            if (searchPanelOptions && searchPanelOptions.visible) {\n              var toolbarItem = {\n                template: function (data, index, container) {\n                  var $search = (0, _renderer.default)(\"<div>\").addClass(that.addWidgetPrefix(SEARCH_PANEL_CLASS)).appendTo(container);\n                  that.getController(\"editorFactory\").createEditor($search, {\n                    width: searchPanelOptions.width,\n                    placeholder: searchPanelOptions.placeholder,\n                    parentType: \"searchPanel\",\n                    value: that.option(\"searchPanel.text\"),\n                    updateValueTimeout: FILTERING_TIMEOUT,\n                    setValue: function (value) {\n                      dataController.searchByText(value);\n                    },\n                    editorOptions: {\n                      inputAttr: {\n                        \"aria-label\": _message.default.format(\"\".concat(that.component.NAME, \"-ariaSearchInGrid\"))\n                      }\n                    }\n                  });\n                  that.resize();\n                },\n                name: \"searchPanel\",\n                location: \"after\",\n                locateInMenu: \"never\",\n                sortIndex: 40\n              };\n              items.push(toolbarItem);\n            }\n\n            return items;\n          },\n          getSearchTextEditor: function () {\n            var that = this;\n            var $element = that.element();\n            var $searchPanel = $element.find(\".\" + that.addWidgetPrefix(SEARCH_PANEL_CLASS)).filter(function () {\n              return (0, _renderer.default)(this).closest(\".\" + that.addWidgetPrefix(HEADER_PANEL_CLASS)).is($element);\n            });\n\n            if ($searchPanel.length) {\n              return $searchPanel.dxTextBox(\"instance\");\n            }\n\n            return null;\n          },\n          isVisible: function () {\n            var searchPanelOptions = getSearchPanelOptions(this);\n            return this.callBase() || searchPanelOptions && searchPanelOptions.visible;\n          },\n          optionChanged: function (args) {\n            if (\"searchPanel\" === args.name) {\n              if (\"searchPanel.text\" === args.fullName) {\n                var editor = this.getSearchTextEditor();\n\n                if (editor) {\n                  editor.option(\"value\", args.value);\n                }\n              } else {\n                this._invalidate();\n              }\n\n              args.handled = true;\n            } else {\n              this.callBase(args);\n            }\n          }\n        };\n      }(),\n      rowsView: {\n        init: function () {\n          this.callBase.apply(this, arguments);\n          this._searchParams = [];\n        },\n        _getFormattedSearchText: function (column, searchText) {\n          var value = parseValue(column, searchText);\n\n          var formatOptions = _uiGrid_core.default.getFormatOptionsByColumn(column, \"search\");\n\n          return _uiGrid_core.default.formatValue(value, formatOptions);\n        },\n        _getStringNormalizer: function () {\n          var isCaseSensitive = this.option(\"searchPanel.highlightCaseSensitive\");\n          return function (str) {\n            return isCaseSensitive ? str : str.toLowerCase();\n          };\n        },\n        _findHighlightingTextNodes: function (column, cellElement, searchText) {\n          var _$items;\n\n          var that = this;\n          var $parent = cellElement.parent();\n          var $items;\n\n          var stringNormalizer = this._getStringNormalizer();\n\n          var normalizedSearchText = stringNormalizer(searchText);\n\n          if (!$parent.length) {\n            $parent = (0, _renderer.default)(\"<div>\").append(cellElement);\n          } else {\n            if (column) {\n              if (column.groupIndex >= 0 && !column.showWhenGrouped) {\n                $items = cellElement;\n              } else {\n                var columnIndex = that._columnsController.getVisibleIndex(column.index);\n\n                $items = $parent.children(\"td\").eq(columnIndex).find(\"*\");\n              }\n            }\n          }\n\n          $items = null !== (_$items = $items) && void 0 !== _$items && _$items.length ? $items : $parent.find(\"*\");\n          $items = $items.filter(function (_, element) {\n            var $contents = (0, _renderer.default)(element).contents();\n\n            for (var i = 0; i < $contents.length; i++) {\n              var node = $contents.get(i);\n\n              if (3 === node.nodeType) {\n                return stringNormalizer(node.textContent || node.nodeValue).indexOf(normalizedSearchText) > -1;\n              }\n\n              return false;\n            }\n          });\n          return $items;\n        },\n        _highlightSearchTextCore: function ($textNode, searchText) {\n          var that = this;\n          var $searchTextSpan = (0, _renderer.default)(\"<span>\").addClass(that.addWidgetPrefix(SEARCH_TEXT_CLASS));\n          var text = $textNode.text();\n          var firstContentElement = $textNode[0];\n\n          var stringNormalizer = this._getStringNormalizer();\n\n          var index = stringNormalizer(text).indexOf(stringNormalizer(searchText));\n\n          if (index >= 0) {\n            if (firstContentElement.textContent) {\n              firstContentElement.textContent = text.substr(0, index);\n            } else {\n              firstContentElement.nodeValue = text.substr(0, index);\n            }\n\n            $textNode.after($searchTextSpan.text(text.substr(index, searchText.length)));\n            $textNode = (0, _renderer.default)(_dom_adapter.default.createTextNode(text.substr(index + searchText.length))).insertAfter($searchTextSpan);\n            return that._highlightSearchTextCore($textNode, searchText);\n          }\n        },\n        _highlightSearchText: function (cellElement, isEquals, column) {\n          var that = this;\n\n          var stringNormalizer = this._getStringNormalizer();\n\n          var searchText = that.option(\"searchPanel.text\");\n\n          if (isEquals && column) {\n            searchText = searchText && that._getFormattedSearchText(column, searchText);\n          }\n\n          if (searchText && that.option(\"searchPanel.highlightSearchText\")) {\n            var textNodes = that._findHighlightingTextNodes(column, cellElement, searchText);\n\n            (0, _iterator.each)(textNodes, function (_, element) {\n              (0, _iterator.each)((0, _renderer.default)(element).contents(), function (_, textNode) {\n                if (isEquals) {\n                  if (stringNormalizer((0, _renderer.default)(textNode).text()) === stringNormalizer(searchText)) {\n                    (0, _renderer.default)(this).replaceWith((0, _renderer.default)(\"<span>\").addClass(that.addWidgetPrefix(SEARCH_TEXT_CLASS)).text((0, _renderer.default)(textNode).text()));\n                  }\n                } else {\n                  that._highlightSearchTextCore((0, _renderer.default)(textNode), searchText);\n                }\n              });\n            });\n          }\n        },\n        _renderCore: function () {\n          this.callBase.apply(this, arguments);\n\n          if (this.option(\"rowTemplate\")) {\n            if (this.option(\"templatesRenderAsynchronously\")) {\n              clearTimeout(this._highlightTimer);\n              this._highlightTimer = setTimeout(function () {\n                this._highlightSearchText(this.getTableElement());\n              }.bind(this));\n            } else {\n              this._highlightSearchText(this.getTableElement());\n            }\n          }\n        },\n        _updateCell: function ($cell, parameters) {\n          var column = parameters.column;\n          var dataType = column.lookup && column.lookup.dataType || column.dataType;\n          var isEquals = \"string\" !== dataType;\n\n          if (allowSearch(column) && !parameters.isOnForm) {\n            if (this.option(\"templatesRenderAsynchronously\")) {\n              if (!this._searchParams.length) {\n                clearTimeout(this._highlightTimer);\n                this._highlightTimer = setTimeout(function () {\n                  this._searchParams.forEach(function (params) {\n                    this._highlightSearchText.apply(this, params);\n                  }.bind(this));\n\n                  this._searchParams = [];\n                }.bind(this));\n              }\n\n              this._searchParams.push([$cell, isEquals, column]);\n            } else {\n              this._highlightSearchText($cell, isEquals, column);\n            }\n          }\n\n          this.callBase($cell, parameters);\n        },\n        dispose: function () {\n          clearTimeout(this._highlightTimer);\n          this.callBase();\n        }\n      }\n    }\n  }\n};\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["C:/Users/CapiniaC/Desktop/Collection/Work/project/security/node_modules/devextreme/ui/grid_core/ui.grid_core.search.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_dom_adapter","_type","_data","_iterator","_uiGrid_core","_message","_query","obj","__esModule","SEARCH_PANEL_CLASS","SEARCH_TEXT_CLASS","HEADER_PANEL_CLASS","FILTERING_TIMEOUT","allowSearch","column","isDefined","allowFiltering","parseValue","text","lookup","call","_default","defaultOptions","searchPanel","visible","width","placeholder","format","highlightSearchText","highlightCaseSensitive","searchVisibleColumnsOnly","extenders","controllers","data","calculateSearchFilter","that","i","columns","_columnsController","getColumns","option","filters","onQueryDone","items","valueGetter","compileGetter","valueExpr","_i","length","value","push","createFilterExpression","calculateFilterExpression","filterValue","filter","dataField","displayExpr","dataType","enumerate","done","combineFilters","publicMethods","callBase","concat","_calculateAdditionalFilter","searchFilter","searchByText","optionChanged","args","fullName","_applyFilter","handled","views","headerPanel","getSearchPanelOptions","_getToolbarItems","_prepareSearchItem","dataController","getController","searchPanelOptions","toolbarItem","template","index","container","$search","addClass","addWidgetPrefix","appendTo","createEditor","parentType","updateValueTimeout","setValue","editorOptions","inputAttr","component","NAME","resize","name","location","locateInMenu","sortIndex","getSearchTextEditor","$element","element","$searchPanel","find","closest","is","dxTextBox","isVisible","editor","_invalidate","rowsView","init","apply","arguments","_searchParams","_getFormattedSearchText","searchText","formatOptions","getFormatOptionsByColumn","formatValue","_getStringNormalizer","isCaseSensitive","str","toLowerCase","_findHighlightingTextNodes","cellElement","_$items","$parent","parent","$items","stringNormalizer","normalizedSearchText","append","groupIndex","showWhenGrouped","columnIndex","getVisibleIndex","children","eq","_","$contents","contents","node","get","nodeType","textContent","nodeValue","indexOf","_highlightSearchTextCore","$textNode","$searchTextSpan","firstContentElement","substr","after","createTextNode","insertAfter","_highlightSearchText","isEquals","textNodes","each","textNode","replaceWith","_renderCore","clearTimeout","_highlightTimer","setTimeout","getTableElement","bind","_updateCell","$cell","parameters","isOnForm","forEach","params","dispose","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.search.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\r\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\r\nvar _query = _interopRequireDefault(require(\"../../data/query\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar SEARCH_PANEL_CLASS = \"search-panel\";\r\nvar SEARCH_TEXT_CLASS = \"search-text\";\r\nvar HEADER_PANEL_CLASS = \"header-panel\";\r\nvar FILTERING_TIMEOUT = 700;\r\n\r\nfunction allowSearch(column) {\r\n    return (0, _type.isDefined)(column.allowSearch) ? column.allowSearch : column.allowFiltering\r\n}\r\n\r\nfunction parseValue(column, text) {\r\n    var lookup = column.lookup;\r\n    if (!column.parseValue) {\r\n        return text\r\n    }\r\n    if (lookup) {\r\n        return column.parseValue.call(lookup, text)\r\n    }\r\n    return column.parseValue(text)\r\n}\r\nvar _default = {\r\n    defaultOptions: function() {\r\n        return {\r\n            searchPanel: {\r\n                visible: false,\r\n                width: 160,\r\n                placeholder: _message.default.format(\"dxDataGrid-searchPanelPlaceholder\"),\r\n                highlightSearchText: true,\r\n                highlightCaseSensitive: false,\r\n                text: \"\",\r\n                searchVisibleColumnsOnly: false\r\n            }\r\n        }\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: function() {\r\n                var calculateSearchFilter = function(that, text) {\r\n                    var i;\r\n                    var column;\r\n                    var columns = that._columnsController.getColumns();\r\n                    var searchVisibleColumnsOnly = that.option(\"searchPanel.searchVisibleColumnsOnly\");\r\n                    var lookup;\r\n                    var filters = [];\r\n                    if (!text) {\r\n                        return null\r\n                    }\r\n\r\n                    function onQueryDone(items) {\r\n                        var valueGetter = (0, _data.compileGetter)(lookup.valueExpr);\r\n                        for (var _i = 0; _i < items.length; _i++) {\r\n                            var value = valueGetter(items[_i]);\r\n                            filters.push(column.createFilterExpression(value, null, \"search\"))\r\n                        }\r\n                    }\r\n                    for (i = 0; i < columns.length; i++) {\r\n                        column = columns[i];\r\n                        if (searchVisibleColumnsOnly && !column.visible) {\r\n                            continue\r\n                        }\r\n                        if (allowSearch(column) && column.calculateFilterExpression) {\r\n                            lookup = column.lookup;\r\n                            var filterValue = parseValue(column, text);\r\n                            if (lookup && lookup.items) {\r\n                                (0, _query.default)(lookup.items).filter(column.createFilterExpression.call({\r\n                                    dataField: lookup.displayExpr,\r\n                                    dataType: lookup.dataType,\r\n                                    calculateFilterExpression: column.calculateFilterExpression\r\n                                }, filterValue, null, \"search\")).enumerate().done(onQueryDone)\r\n                            } else {\r\n                                if (void 0 !== filterValue) {\r\n                                    filters.push(column.createFilterExpression(filterValue, null, \"search\"))\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return _uiGrid_core.default.combineFilters(filters, \"or\")\r\n                };\r\n                return {\r\n                    publicMethods: function() {\r\n                        return this.callBase().concat([\"searchByText\"])\r\n                    },\r\n                    _calculateAdditionalFilter: function() {\r\n                        var that = this;\r\n                        var filter = that.callBase();\r\n                        var searchFilter = calculateSearchFilter(that, that.option(\"searchPanel.text\"));\r\n                        return _uiGrid_core.default.combineFilters([filter, searchFilter])\r\n                    },\r\n                    searchByText: function(text) {\r\n                        this.option(\"searchPanel.text\", text)\r\n                    },\r\n                    optionChanged: function(args) {\r\n                        var that = this;\r\n                        switch (args.fullName) {\r\n                            case \"searchPanel.text\":\r\n                            case \"searchPanel\":\r\n                                that._applyFilter();\r\n                                args.handled = true;\r\n                                break;\r\n                            default:\r\n                                that.callBase(args)\r\n                        }\r\n                    }\r\n                }\r\n            }()\r\n        },\r\n        views: {\r\n            headerPanel: function() {\r\n                var getSearchPanelOptions = function(that) {\r\n                    return that.option(\"searchPanel\")\r\n                };\r\n                return {\r\n                    _getToolbarItems: function() {\r\n                        var items = this.callBase();\r\n                        return this._prepareSearchItem(items)\r\n                    },\r\n                    _prepareSearchItem: function(items) {\r\n                        var that = this;\r\n                        var dataController = that.getController(\"data\");\r\n                        var searchPanelOptions = getSearchPanelOptions(that);\r\n                        if (searchPanelOptions && searchPanelOptions.visible) {\r\n                            var toolbarItem = {\r\n                                template: function(data, index, container) {\r\n                                    var $search = (0, _renderer.default)(\"<div>\").addClass(that.addWidgetPrefix(SEARCH_PANEL_CLASS)).appendTo(container);\r\n                                    that.getController(\"editorFactory\").createEditor($search, {\r\n                                        width: searchPanelOptions.width,\r\n                                        placeholder: searchPanelOptions.placeholder,\r\n                                        parentType: \"searchPanel\",\r\n                                        value: that.option(\"searchPanel.text\"),\r\n                                        updateValueTimeout: FILTERING_TIMEOUT,\r\n                                        setValue: function(value) {\r\n                                            dataController.searchByText(value)\r\n                                        },\r\n                                        editorOptions: {\r\n                                            inputAttr: {\r\n                                                \"aria-label\": _message.default.format(\"\".concat(that.component.NAME, \"-ariaSearchInGrid\"))\r\n                                            }\r\n                                        }\r\n                                    });\r\n                                    that.resize()\r\n                                },\r\n                                name: \"searchPanel\",\r\n                                location: \"after\",\r\n                                locateInMenu: \"never\",\r\n                                sortIndex: 40\r\n                            };\r\n                            items.push(toolbarItem)\r\n                        }\r\n                        return items\r\n                    },\r\n                    getSearchTextEditor: function() {\r\n                        var that = this;\r\n                        var $element = that.element();\r\n                        var $searchPanel = $element.find(\".\" + that.addWidgetPrefix(SEARCH_PANEL_CLASS)).filter(function() {\r\n                            return (0, _renderer.default)(this).closest(\".\" + that.addWidgetPrefix(HEADER_PANEL_CLASS)).is($element)\r\n                        });\r\n                        if ($searchPanel.length) {\r\n                            return $searchPanel.dxTextBox(\"instance\")\r\n                        }\r\n                        return null\r\n                    },\r\n                    isVisible: function() {\r\n                        var searchPanelOptions = getSearchPanelOptions(this);\r\n                        return this.callBase() || searchPanelOptions && searchPanelOptions.visible\r\n                    },\r\n                    optionChanged: function(args) {\r\n                        if (\"searchPanel\" === args.name) {\r\n                            if (\"searchPanel.text\" === args.fullName) {\r\n                                var editor = this.getSearchTextEditor();\r\n                                if (editor) {\r\n                                    editor.option(\"value\", args.value)\r\n                                }\r\n                            } else {\r\n                                this._invalidate()\r\n                            }\r\n                            args.handled = true\r\n                        } else {\r\n                            this.callBase(args)\r\n                        }\r\n                    }\r\n                }\r\n            }(),\r\n            rowsView: {\r\n                init: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    this._searchParams = []\r\n                },\r\n                _getFormattedSearchText: function(column, searchText) {\r\n                    var value = parseValue(column, searchText);\r\n                    var formatOptions = _uiGrid_core.default.getFormatOptionsByColumn(column, \"search\");\r\n                    return _uiGrid_core.default.formatValue(value, formatOptions)\r\n                },\r\n                _getStringNormalizer: function() {\r\n                    var isCaseSensitive = this.option(\"searchPanel.highlightCaseSensitive\");\r\n                    return function(str) {\r\n                        return isCaseSensitive ? str : str.toLowerCase()\r\n                    }\r\n                },\r\n                _findHighlightingTextNodes: function(column, cellElement, searchText) {\r\n                    var _$items;\r\n                    var that = this;\r\n                    var $parent = cellElement.parent();\r\n                    var $items;\r\n                    var stringNormalizer = this._getStringNormalizer();\r\n                    var normalizedSearchText = stringNormalizer(searchText);\r\n                    if (!$parent.length) {\r\n                        $parent = (0, _renderer.default)(\"<div>\").append(cellElement)\r\n                    } else {\r\n                        if (column) {\r\n                            if (column.groupIndex >= 0 && !column.showWhenGrouped) {\r\n                                $items = cellElement\r\n                            } else {\r\n                                var columnIndex = that._columnsController.getVisibleIndex(column.index);\r\n                                $items = $parent.children(\"td\").eq(columnIndex).find(\"*\")\r\n                            }\r\n                        }\r\n                    }\r\n                    $items = null !== (_$items = $items) && void 0 !== _$items && _$items.length ? $items : $parent.find(\"*\");\r\n                    $items = $items.filter(function(_, element) {\r\n                        var $contents = (0, _renderer.default)(element).contents();\r\n                        for (var i = 0; i < $contents.length; i++) {\r\n                            var node = $contents.get(i);\r\n                            if (3 === node.nodeType) {\r\n                                return stringNormalizer(node.textContent || node.nodeValue).indexOf(normalizedSearchText) > -1\r\n                            }\r\n                            return false\r\n                        }\r\n                    });\r\n                    return $items\r\n                },\r\n                _highlightSearchTextCore: function($textNode, searchText) {\r\n                    var that = this;\r\n                    var $searchTextSpan = (0, _renderer.default)(\"<span>\").addClass(that.addWidgetPrefix(SEARCH_TEXT_CLASS));\r\n                    var text = $textNode.text();\r\n                    var firstContentElement = $textNode[0];\r\n                    var stringNormalizer = this._getStringNormalizer();\r\n                    var index = stringNormalizer(text).indexOf(stringNormalizer(searchText));\r\n                    if (index >= 0) {\r\n                        if (firstContentElement.textContent) {\r\n                            firstContentElement.textContent = text.substr(0, index)\r\n                        } else {\r\n                            firstContentElement.nodeValue = text.substr(0, index)\r\n                        }\r\n                        $textNode.after($searchTextSpan.text(text.substr(index, searchText.length)));\r\n                        $textNode = (0, _renderer.default)(_dom_adapter.default.createTextNode(text.substr(index + searchText.length))).insertAfter($searchTextSpan);\r\n                        return that._highlightSearchTextCore($textNode, searchText)\r\n                    }\r\n                },\r\n                _highlightSearchText: function(cellElement, isEquals, column) {\r\n                    var that = this;\r\n                    var stringNormalizer = this._getStringNormalizer();\r\n                    var searchText = that.option(\"searchPanel.text\");\r\n                    if (isEquals && column) {\r\n                        searchText = searchText && that._getFormattedSearchText(column, searchText)\r\n                    }\r\n                    if (searchText && that.option(\"searchPanel.highlightSearchText\")) {\r\n                        var textNodes = that._findHighlightingTextNodes(column, cellElement, searchText);\r\n                        (0, _iterator.each)(textNodes, function(_, element) {\r\n                            (0, _iterator.each)((0, _renderer.default)(element).contents(), function(_, textNode) {\r\n                                if (isEquals) {\r\n                                    if (stringNormalizer((0, _renderer.default)(textNode).text()) === stringNormalizer(searchText)) {\r\n                                        (0, _renderer.default)(this).replaceWith((0, _renderer.default)(\"<span>\").addClass(that.addWidgetPrefix(SEARCH_TEXT_CLASS)).text((0, _renderer.default)(textNode).text()))\r\n                                    }\r\n                                } else {\r\n                                    that._highlightSearchTextCore((0, _renderer.default)(textNode), searchText)\r\n                                }\r\n                            })\r\n                        })\r\n                    }\r\n                },\r\n                _renderCore: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    if (this.option(\"rowTemplate\")) {\r\n                        if (this.option(\"templatesRenderAsynchronously\")) {\r\n                            clearTimeout(this._highlightTimer);\r\n                            this._highlightTimer = setTimeout(function() {\r\n                                this._highlightSearchText(this.getTableElement())\r\n                            }.bind(this))\r\n                        } else {\r\n                            this._highlightSearchText(this.getTableElement())\r\n                        }\r\n                    }\r\n                },\r\n                _updateCell: function($cell, parameters) {\r\n                    var column = parameters.column;\r\n                    var dataType = column.lookup && column.lookup.dataType || column.dataType;\r\n                    var isEquals = \"string\" !== dataType;\r\n                    if (allowSearch(column) && !parameters.isOnForm) {\r\n                        if (this.option(\"templatesRenderAsynchronously\")) {\r\n                            if (!this._searchParams.length) {\r\n                                clearTimeout(this._highlightTimer);\r\n                                this._highlightTimer = setTimeout(function() {\r\n                                    this._searchParams.forEach(function(params) {\r\n                                        this._highlightSearchText.apply(this, params)\r\n                                    }.bind(this));\r\n                                    this._searchParams = []\r\n                                }.bind(this))\r\n                            }\r\n                            this._searchParams.push([$cell, isEquals, column])\r\n                        } else {\r\n                            this._highlightSearchText($cell, isEquals, column)\r\n                        }\r\n                    }\r\n                    this.callBase($cell, parameters)\r\n                },\r\n                dispose: function() {\r\n                    clearTimeout(this._highlightTimer);\r\n                    this.callBase()\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}