{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.columns_controller.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _callbacks = _interopRequireDefault(require(\"../../core/utils/callbacks\"));\n\nvar _variable_wrapper = _interopRequireDefault(require(\"../../core/utils/variable_wrapper\"));\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _position = require(\"../../core/utils/position\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _config = _interopRequireDefault(require(\"../../core/config\"));\n\nvar _object = require(\"../../core/utils/object\");\n\nvar _ui = _interopRequireDefault(require(\"../widget/ui.errors\"));\n\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.modules\"));\n\nvar _uiGrid_core2 = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\n\nvar _inflector = require(\"../../core/utils/inflector\");\n\nvar _date_serialization = _interopRequireDefault(require(\"../../core/utils/date_serialization\"));\n\nvar _number = _interopRequireDefault(require(\"../../localization/number\"));\n\nvar _date = _interopRequireDefault(require(\"../../localization/date\"));\n\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _abstract_store = _interopRequireDefault(require(\"../../data/abstract_store\"));\n\nvar _data_source = require(\"../../data/data_source/data_source\");\n\nvar _utils = require(\"../../data/data_source/utils\");\n\nvar _filtering = _interopRequireDefault(require(\"../shared/filtering\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else {\n      if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar USER_STATE_FIELD_NAMES_15_1 = [\"filterValues\", \"filterType\", \"fixed\", \"fixedPosition\"];\nvar USER_STATE_FIELD_NAMES = [\"visibleIndex\", \"dataField\", \"name\", \"dataType\", \"width\", \"visible\", \"sortOrder\", \"lastSortOrder\", \"sortIndex\", \"groupIndex\", \"filterValue\", \"selectedFilterOperation\", \"added\"].concat(USER_STATE_FIELD_NAMES_15_1);\nvar IGNORE_COLUMN_OPTION_NAMES = {\n  visibleWidth: true,\n  bestFitWidth: true,\n  bufferedFilterValue: true\n};\nvar COMMAND_EXPAND_CLASS = \"dx-command-expand\";\nvar MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER || 9007199254740991;\nvar GROUP_COMMAND_COLUMN_NAME = \"groupExpand\";\nvar regExp = /columns\\[(\\d+)\\]\\.?/gi;\nvar globalColumnId = 1;\nvar _default = {\n  defaultOptions: function () {\n    return {\n      commonColumnSettings: {\n        allowFiltering: true,\n        allowHiding: true,\n        allowSorting: true,\n        allowEditing: true,\n        encodeHtml: true,\n        trueText: _message.default.format(\"dxDataGrid-trueText\"),\n        falseText: _message.default.format(\"dxDataGrid-falseText\")\n      },\n      allowColumnReordering: false,\n      allowColumnResizing: false,\n      columnResizingMode: \"nextColumn\",\n      columnMinWidth: void 0,\n      columnWidth: void 0,\n      adaptColumnWidthByRatio: true,\n      columns: void 0,\n      regenerateColumnsByVisibleItems: false,\n      customizeColumns: null,\n      dateSerializationFormat: void 0\n    };\n  },\n  controllers: {\n    columns: _uiGrid_core.default.Controller.inherit(function () {\n      var DEFAULT_COLUMN_OPTIONS = {\n        visible: true,\n        showInColumnChooser: true\n      };\n      var DATATYPE_OPERATIONS = {\n        number: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"between\"],\n        string: [\"contains\", \"notcontains\", \"startswith\", \"endswith\", \"=\", \"<>\"],\n        date: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"between\"],\n        datetime: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"between\"]\n      };\n      var COLUMN_INDEX_OPTIONS = {\n        visibleIndex: true,\n        groupIndex: true,\n        grouped: true,\n        sortIndex: true,\n        sortOrder: true\n      };\n      var GROUP_LOCATION = \"group\";\n      var COLUMN_CHOOSER_LOCATION = \"columnChooser\";\n\n      var setFilterOperationsAsDefaultValues = function (column) {\n        column.filterOperations = column.defaultFilterOperations;\n      };\n\n      var createColumn = function (that, columnOptions, userStateColumnOptions, bandColumn) {\n        var commonColumnOptions = {};\n\n        if (columnOptions) {\n          if ((0, _type.isString)(columnOptions)) {\n            columnOptions = {\n              dataField: columnOptions\n            };\n          }\n\n          that.setName(columnOptions);\n          var result = {};\n\n          if (columnOptions.command) {\n            result = (0, _object.deepExtendArraySafe)(commonColumnOptions, columnOptions);\n          } else {\n            commonColumnOptions = that.getCommonSettings(columnOptions);\n\n            if (userStateColumnOptions && userStateColumnOptions.name && userStateColumnOptions.dataField) {\n              columnOptions = (0, _extend.extend)({}, columnOptions, {\n                dataField: userStateColumnOptions.dataField\n              });\n            }\n\n            var calculatedColumnOptions = that._createCalculatedColumnOptions(columnOptions, bandColumn);\n\n            if (!columnOptions.type) {\n              result = {\n                headerId: \"dx-col-\".concat(globalColumnId++)\n              };\n            }\n\n            result = (0, _object.deepExtendArraySafe)(result, DEFAULT_COLUMN_OPTIONS);\n            (0, _object.deepExtendArraySafe)(result, commonColumnOptions);\n            (0, _object.deepExtendArraySafe)(result, calculatedColumnOptions);\n            (0, _object.deepExtendArraySafe)(result, columnOptions);\n            (0, _object.deepExtendArraySafe)(result, {\n              selector: null\n            });\n          }\n\n          if (columnOptions.filterOperations === columnOptions.defaultFilterOperations) {\n            setFilterOperationsAsDefaultValues(result);\n          }\n\n          return result;\n        }\n      };\n\n      var createColumnsFromOptions = function createColumnsFromOptions(that, columnsOptions, bandColumn) {\n        var result = [];\n\n        if (columnsOptions) {\n          (0, _iterator.each)(columnsOptions, function (index, columnOptions) {\n            var userStateColumnOptions = that._columnsUserState && checkUserStateColumn(columnOptions, that._columnsUserState[index]) && that._columnsUserState[index];\n\n            var column = createColumn(that, columnOptions, userStateColumnOptions, bandColumn);\n\n            if (column) {\n              if (bandColumn) {\n                column.ownerBand = bandColumn;\n              }\n\n              result.push(column);\n\n              if (column.columns) {\n                result = result.concat(createColumnsFromOptions(that, column.columns, column));\n                delete column.columns;\n                column.hasColumns = true;\n              }\n            }\n          });\n        }\n\n        return result;\n      };\n\n      var getParentBandColumns = function (columnIndex, columnParentByIndex) {\n        var result = [];\n        var parent = columnParentByIndex[columnIndex];\n\n        while (parent) {\n          result.unshift(parent);\n          columnIndex = parent.index;\n          parent = columnParentByIndex[columnIndex];\n        }\n\n        return result;\n      };\n\n      var _getChildrenByBandColumn = function (columnIndex, columnChildrenByIndex, recursive) {\n        var result = [];\n        var children = columnChildrenByIndex[columnIndex];\n\n        if (children) {\n          for (var i = 0; i < children.length; i++) {\n            var column = children[i];\n\n            if (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped) {\n              result.push(column);\n\n              if (recursive && column.isBand) {\n                result = result.concat(_getChildrenByBandColumn(column.index, columnChildrenByIndex, recursive));\n              }\n            }\n          }\n        }\n\n        return result;\n      };\n\n      var getColumnByIndexes = function (that, columnIndexes) {\n        var result;\n        var columns;\n        var bandColumnsCache = that.getBandColumnsCache();\n\n        var callbackFilter = function (column) {\n          var ownerBand = result ? result.index : void 0;\n          return column.ownerBand === ownerBand;\n        };\n\n        if (bandColumnsCache.isPlain) {\n          result = that._columns[columnIndexes[0]];\n        } else {\n          columns = that._columns.filter(callbackFilter);\n\n          for (var i = 0; i < columnIndexes.length; i++) {\n            result = columns[columnIndexes[i]];\n\n            if (result) {\n              columns = that._columns.filter(callbackFilter);\n            }\n          }\n        }\n\n        return result;\n      };\n\n      var getColumnFullPath = function (that, column) {\n        var result = [];\n        var columns;\n        var bandColumnsCache = that.getBandColumnsCache();\n\n        var callbackFilter = function (item) {\n          return item.ownerBand === column.ownerBand;\n        };\n\n        if (bandColumnsCache.isPlain) {\n          var columnIndex = that._columns.indexOf(column);\n\n          if (columnIndex >= 0) {\n            result = [\"columns[\".concat(columnIndex, \"]\")];\n          }\n        } else {\n          columns = that._columns.filter(callbackFilter);\n\n          while (columns.length && columns.indexOf(column) !== -1) {\n            result.unshift(\"columns[\".concat(columns.indexOf(column), \"]\"));\n            column = bandColumnsCache.columnParentByIndex[column.index];\n            columns = column ? that._columns.filter(callbackFilter) : [];\n          }\n        }\n\n        return result.join(\".\");\n      };\n\n      var calculateColspan = function calculateColspan(that, columnID) {\n        var colspan = 0;\n        var columns = that.getChildrenByBandColumn(columnID, true);\n        (0, _iterator.each)(columns, function (_, column) {\n          if (column.isBand) {\n            column.colspan = column.colspan || calculateColspan(that, column.index);\n            colspan += column.colspan || 1;\n          } else {\n            colspan += 1;\n          }\n        });\n        return colspan;\n      };\n\n      var processBandColumns = function (that, columns, bandColumnsCache) {\n        var rowspan;\n\n        for (var i = 0; i < columns.length; i++) {\n          var column = columns[i];\n\n          if (column.visible || column.command) {\n            if (column.isBand) {\n              column.colspan = column.colspan || calculateColspan(that, column.index);\n            }\n\n            if (!column.isBand || !column.colspan) {\n              rowspan = that.getRowCount();\n\n              if (!column.command && (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped)) {\n                rowspan -= getParentBandColumns(column.index, bandColumnsCache.columnParentByIndex).length;\n              }\n\n              if (rowspan > 1) {\n                column.rowspan = rowspan;\n              }\n            }\n          }\n        }\n      };\n\n      var getValueDataType = function (value) {\n        var dataType = (0, _type.type)(value);\n\n        if (\"string\" !== dataType && \"boolean\" !== dataType && \"number\" !== dataType && \"date\" !== dataType && \"object\" !== dataType) {\n          dataType = void 0;\n        }\n\n        return dataType;\n      };\n\n      var getSerializationFormat = function (dataType, value) {\n        switch (dataType) {\n          case \"date\":\n          case \"datetime\":\n            return _date_serialization.default.getDateSerializationFormat(value);\n\n          case \"number\":\n            if ((0, _type.isString)(value)) {\n              return \"string\";\n            }\n\n            if ((0, _type.isNumeric)(value)) {\n              return null;\n            }\n\n        }\n      };\n\n      var updateSerializers = function (options, dataType) {\n        if (!options.deserializeValue) {\n          if (_uiGrid_core2.default.isDateType(dataType)) {\n            options.deserializeValue = function (value) {\n              return _date_serialization.default.deserializeDate(value);\n            };\n\n            options.serializeValue = function (value) {\n              return (0, _type.isString)(value) ? value : _date_serialization.default.serializeDate(value, this.serializationFormat);\n            };\n          }\n\n          if (\"number\" === dataType) {\n            options.deserializeValue = function (value) {\n              var parsedValue = parseFloat(value);\n              return isNaN(parsedValue) ? value : parsedValue;\n            };\n\n            options.serializeValue = function (value, target) {\n              if (\"filter\" === target) {\n                return value;\n              }\n\n              return (0, _type.isDefined)(value) && \"string\" === this.serializationFormat ? value.toString() : value;\n            };\n          }\n        }\n      };\n\n      var getAlignmentByDataType = function (dataType, isRTL) {\n        switch (dataType) {\n          case \"number\":\n            return \"right\";\n\n          case \"boolean\":\n            return \"center\";\n\n          default:\n            return (0, _position.getDefaultAlignment)(isRTL);\n        }\n      };\n\n      var customizeTextForBooleanDataType = function (e) {\n        if (true === e.value) {\n          return this.trueText || \"true\";\n        } else {\n          if (false === e.value) {\n            return this.falseText || \"false\";\n          } else {\n            return e.valueText || \"\";\n          }\n        }\n      };\n\n      var getCustomizeTextByDataType = function (dataType) {\n        if (\"boolean\" === dataType) {\n          return customizeTextForBooleanDataType;\n        }\n      };\n\n      var createColumnsFromDataSource = function (that, dataSource) {\n        var firstItems = that._getFirstItems(dataSource);\n\n        var fieldName;\n        var processedFields = {};\n        var result = [];\n\n        for (var i = 0; i < firstItems.length; i++) {\n          if (firstItems[i]) {\n            for (fieldName in firstItems[i]) {\n              if (!(0, _type.isFunction)(firstItems[i][fieldName]) || _variable_wrapper.default.isWrapped(firstItems[i][fieldName])) {\n                processedFields[fieldName] = true;\n              }\n            }\n          }\n        }\n\n        for (fieldName in processedFields) {\n          if (0 !== fieldName.indexOf(\"__\")) {\n            var column = createColumn(that, fieldName);\n            result.push(column);\n          }\n        }\n\n        return result;\n      };\n\n      var updateColumnIndexes = function (that) {\n        (0, _iterator.each)(that._columns, function (index, column) {\n          column.index = index;\n        });\n        (0, _iterator.each)(that._columns, function (index, column) {\n          if ((0, _type.isObject)(column.ownerBand)) {\n            column.ownerBand = column.ownerBand.index;\n          }\n        });\n        (0, _iterator.each)(that._commandColumns, function (index, column) {\n          column.index = -(index + 1);\n        });\n      };\n\n      var updateColumnGroupIndexes = function (that, currentColumn) {\n        (0, _array.normalizeIndexes)(that._columns, \"groupIndex\", currentColumn, function (column) {\n          var grouped = column.grouped;\n          delete column.grouped;\n          return grouped;\n        });\n      };\n\n      var updateColumnSortIndexes = function (that, currentColumn) {\n        (0, _iterator.each)(that._columns, function (index, column) {\n          if ((0, _type.isDefined)(column.sortIndex) && !isSortOrderValid(column.sortOrder)) {\n            delete column.sortIndex;\n          }\n        });\n        (0, _array.normalizeIndexes)(that._columns, \"sortIndex\", currentColumn, function (column) {\n          return !(0, _type.isDefined)(column.groupIndex) && isSortOrderValid(column.sortOrder);\n        });\n      };\n\n      var updateColumnVisibleIndexes = function (that, currentColumn) {\n        var key;\n        var column;\n        var bandColumns = {};\n        var result = [];\n        var bandColumnsCache = that.getBandColumnsCache();\n\n        var columns = that._columns.filter(function (column) {\n          return !column.command;\n        });\n\n        for (var i = 0; i < columns.length; i++) {\n          column = columns[i];\n          var parentBandColumns = getParentBandColumns(i, bandColumnsCache.columnParentByIndex);\n\n          if (parentBandColumns.length) {\n            var bandColumnIndex = parentBandColumns[parentBandColumns.length - 1].index;\n            bandColumns[bandColumnIndex] = bandColumns[bandColumnIndex] || [];\n            bandColumns[bandColumnIndex].push(column);\n          } else {\n            result.push(column);\n          }\n        }\n\n        for (key in bandColumns) {\n          (0, _array.normalizeIndexes)(bandColumns[key], \"visibleIndex\", currentColumn);\n        }\n\n        (0, _array.normalizeIndexes)(result, \"visibleIndex\", currentColumn);\n      };\n\n      var getColumnIndexByVisibleIndex = function (that, visibleIndex, location) {\n        var rowIndex = (0, _type.isObject)(visibleIndex) ? visibleIndex.rowIndex : null;\n        var columns = location === GROUP_LOCATION ? that.getGroupColumns() : location === COLUMN_CHOOSER_LOCATION ? that.getChooserColumns() : that.getVisibleColumns(rowIndex);\n        var column;\n        visibleIndex = (0, _type.isObject)(visibleIndex) ? visibleIndex.columnIndex : visibleIndex;\n        column = columns[visibleIndex];\n\n        if (column && column.type === GROUP_COMMAND_COLUMN_NAME) {\n          column = that._columns.filter(function (col) {\n            return column.type === col.type;\n          })[0] || column;\n        }\n\n        return column && (0, _type.isDefined)(column.index) ? column.index : -1;\n      };\n\n      var moveColumnToGroup = function (that, column, groupIndex) {\n        var groupColumns = that.getGroupColumns();\n        var i;\n\n        if (groupIndex >= 0) {\n          for (i = 0; i < groupColumns.length; i++) {\n            if (groupColumns[i].groupIndex >= groupIndex) {\n              groupColumns[i].groupIndex++;\n            }\n          }\n        } else {\n          groupIndex = 0;\n\n          for (i = 0; i < groupColumns.length; i++) {\n            groupIndex = Math.max(groupIndex, groupColumns[i].groupIndex + 1);\n          }\n        }\n\n        return groupIndex;\n      };\n\n      function checkUserStateColumn(column, userStateColumn) {\n        return column && userStateColumn && (userStateColumn.name === column.name || !column.name) && (userStateColumn.dataField === column.dataField || column.name);\n      }\n\n      var applyUserState = function (that) {\n        var columnsUserState = that._columnsUserState;\n        var ignoreColumnOptionNames = that._ignoreColumnOptionNames || [];\n        var columns = that._columns;\n        var columnCountById = {};\n        var resultColumns = [];\n        var allColumnsHaveState = true;\n        var userStateColumnIndexes = [];\n        var column;\n        var userStateColumnIndex;\n        var i;\n\n        function applyFieldsState(column, userStateColumn) {\n          if (!userStateColumn) {\n            return;\n          }\n\n          for (var index = 0; index < USER_STATE_FIELD_NAMES.length; index++) {\n            var fieldName = USER_STATE_FIELD_NAMES[index];\n\n            if ((0, _array.inArray)(fieldName, ignoreColumnOptionNames) >= 0) {\n              continue;\n            }\n\n            if (\"dataType\" === fieldName) {\n              column[fieldName] = column[fieldName] || userStateColumn[fieldName];\n            } else {\n              if ((0, _array.inArray)(fieldName, USER_STATE_FIELD_NAMES_15_1) >= 0) {\n                if (fieldName in userStateColumn) {\n                  column[fieldName] = userStateColumn[fieldName];\n                }\n              } else {\n                if (\"selectedFilterOperation\" === fieldName && userStateColumn[fieldName]) {\n                  column.defaultSelectedFilterOperation = column[fieldName] || null;\n                }\n\n                column[fieldName] = userStateColumn[fieldName];\n              }\n            }\n          }\n        }\n\n        function findUserStateColumn(columnsUserState, column) {\n          var id = column.name || column.dataField;\n          var count = columnCountById[id] || 0;\n\n          for (var j = 0; j < columnsUserState.length; j++) {\n            if (checkUserStateColumn(column, columnsUserState[j])) {\n              if (count) {\n                count--;\n              } else {\n                columnCountById[id] = columnCountById[id] || 0;\n                columnCountById[id]++;\n                return j;\n              }\n            }\n          }\n\n          return -1;\n        }\n\n        if (columnsUserState) {\n          for (i = 0; i < columns.length; i++) {\n            userStateColumnIndex = findUserStateColumn(columnsUserState, columns[i]);\n            allColumnsHaveState = allColumnsHaveState && userStateColumnIndex >= 0;\n            userStateColumnIndexes.push(userStateColumnIndex);\n          }\n\n          for (i = 0; i < columns.length; i++) {\n            column = columns[i];\n            userStateColumnIndex = userStateColumnIndexes[i];\n\n            if (that._hasUserState || allColumnsHaveState) {\n              applyFieldsState(column, columnsUserState[userStateColumnIndex]);\n            }\n\n            if (userStateColumnIndex >= 0 && (0, _type.isDefined)(columnsUserState[userStateColumnIndex].initialIndex)) {\n              resultColumns[userStateColumnIndex] = column;\n            } else {\n              resultColumns.push(column);\n            }\n          }\n\n          var hasAddedBands = false;\n\n          for (i = 0; i < columnsUserState.length; i++) {\n            var columnUserState = columnsUserState[i];\n\n            if (columnUserState.added && findUserStateColumn(columns, columnUserState) < 0) {\n              column = createColumn(that, columnUserState.added);\n              applyFieldsState(column, columnUserState);\n              resultColumns.push(column);\n\n              if (columnUserState.added.columns) {\n                hasAddedBands = true;\n              }\n            }\n          }\n\n          if (hasAddedBands) {\n            updateColumnIndexes(that);\n            resultColumns = createColumnsFromOptions(that, resultColumns);\n          }\n\n          assignColumns(that, resultColumns);\n        }\n      };\n\n      var updateIndexes = function (that, column) {\n        updateColumnIndexes(that);\n        updateColumnGroupIndexes(that, column);\n        updateColumnSortIndexes(that, column);\n        resetBandColumnsCache(that);\n        updateColumnVisibleIndexes(that, column);\n      };\n\n      var resetColumnsCache = function (that) {\n        that.resetColumnsCache();\n      };\n\n      function assignColumns(that, columns) {\n        that._columns = columns;\n        resetColumnsCache(that);\n        that.updateColumnDataTypes();\n      }\n\n      var updateColumnChanges = function (that, changeType, optionName, columnIndex) {\n        var columnChanges = that._columnChanges || {\n          optionNames: {\n            length: 0\n          },\n          changeTypes: {\n            length: 0\n          },\n          columnIndex: columnIndex\n        };\n        optionName = optionName || \"all\";\n        optionName = optionName.split(\".\")[0];\n        var changeTypes = columnChanges.changeTypes;\n\n        if (changeType && !changeTypes[changeType]) {\n          changeTypes[changeType] = true;\n          changeTypes.length++;\n        }\n\n        var optionNames = columnChanges.optionNames;\n\n        if (optionName && !optionNames[optionName]) {\n          optionNames[optionName] = true;\n          optionNames.length++;\n        }\n\n        if (void 0 === columnIndex || columnIndex !== columnChanges.columnIndex) {\n          delete columnChanges.columnIndex;\n        }\n\n        that._columnChanges = columnChanges;\n        resetColumnsCache(that);\n      };\n\n      var fireColumnsChanged = function (that) {\n        var onColumnsChanging = that.option(\"onColumnsChanging\");\n        var columnChanges = that._columnChanges;\n        var reinitOptionNames = [\"dataField\", \"lookup\", \"dataType\", \"columns\"];\n\n        var needReinit = function (options) {\n          return options && reinitOptionNames.some(function (name) {\n            return options[name];\n          });\n        };\n\n        if (that.isInitialized() && !that._updateLockCount && columnChanges) {\n          if (onColumnsChanging) {\n            that._updateLockCount++;\n            onColumnsChanging((0, _extend.extend)({\n              component: that.component\n            }, columnChanges));\n            that._updateLockCount--;\n          }\n\n          that._columnChanges = void 0;\n\n          if (needReinit(columnChanges.optionNames)) {\n            that.reinit();\n          } else {\n            that.columnsChanged.fire(columnChanges);\n          }\n        }\n      };\n\n      var updateSortOrderWhenGrouping = function (that, column, groupIndex, prevGroupIndex) {\n        var columnWasGrouped = prevGroupIndex >= 0;\n\n        if (groupIndex >= 0) {\n          if (!columnWasGrouped) {\n            column.lastSortOrder = column.sortOrder;\n          }\n        } else {\n          var sortMode = that.option(\"sorting.mode\");\n          var sortOrder = column.lastSortOrder;\n\n          if (\"single\" === sortMode) {\n            var sortedByAnotherColumn = that._columns.some(function (col) {\n              return col !== column && (0, _type.isDefined)(col.sortIndex);\n            });\n\n            if (sortedByAnotherColumn) {\n              sortOrder = void 0;\n            }\n          }\n\n          column.sortOrder = sortOrder;\n        }\n      };\n\n      var fireOptionChanged = function (that, options) {\n        var value = options.value;\n        var optionName = options.optionName;\n        var prevValue = options.prevValue;\n        var fullOptionName = options.fullOptionName;\n        var fullOptionPath = \"\".concat(fullOptionName, \".\").concat(optionName);\n\n        if (!IGNORE_COLUMN_OPTION_NAMES[optionName] && that._skipProcessingColumnsChange !== fullOptionPath) {\n          that._skipProcessingColumnsChange = fullOptionPath;\n\n          that.component._notifyOptionChanged(fullOptionPath, value, prevValue);\n\n          that._skipProcessingColumnsChange = false;\n        }\n      };\n\n      var columnOptionCore = function (that, column, optionName, value, notFireEvent) {\n        var optionGetter = (0, _data.compileGetter)(optionName);\n        var columnIndex = column.index;\n        var columns;\n        var changeType;\n        var initialColumn;\n\n        if (3 === arguments.length) {\n          return optionGetter(column, {\n            functionsAsIs: true\n          });\n        }\n\n        var prevValue = optionGetter(column, {\n          functionsAsIs: true\n        });\n\n        if (prevValue !== value) {\n          if (\"groupIndex\" === optionName || \"calculateGroupValue\" === optionName) {\n            changeType = \"grouping\";\n            updateSortOrderWhenGrouping(that, column, value, prevValue);\n          } else {\n            if (\"sortIndex\" === optionName || \"sortOrder\" === optionName || \"calculateSortValue\" === optionName) {\n              changeType = \"sorting\";\n            } else {\n              changeType = \"columns\";\n            }\n          }\n\n          var optionSetter = (0, _data.compileSetter)(optionName);\n          optionSetter(column, value, {\n            functionsAsIs: true\n          });\n          var fullOptionName = getColumnFullPath(that, column);\n\n          if (COLUMN_INDEX_OPTIONS[optionName]) {\n            updateIndexes(that, column);\n            value = optionGetter(column);\n          }\n\n          if (\"name\" === optionName || \"allowEditing\" === optionName) {\n            that._checkColumns();\n          }\n\n          fullOptionName && fireOptionChanged(that, {\n            fullOptionName: fullOptionName,\n            optionName: optionName,\n            value: value,\n            prevValue: prevValue\n          });\n\n          if (!(0, _type.isDefined)(prevValue) && !(0, _type.isDefined)(value) && 0 !== optionName.indexOf(\"buffer\")) {\n            notFireEvent = true;\n          }\n\n          if (!notFireEvent) {\n            if ((0, _array.inArray)(optionName, USER_STATE_FIELD_NAMES) < 0 && \"visibleWidth\" !== optionName) {\n              columns = that.option(\"columns\");\n              initialColumn = that.getColumnByPath(fullOptionName, columns);\n\n              if ((0, _type.isString)(initialColumn)) {\n                initialColumn = columns[columnIndex] = {\n                  dataField: initialColumn\n                };\n              }\n\n              if (initialColumn && checkUserStateColumn(initialColumn, column)) {\n                optionSetter(initialColumn, value, {\n                  functionsAsIs: true\n                });\n              }\n            }\n\n            updateColumnChanges(that, changeType, optionName, columnIndex);\n          } else {\n            resetColumnsCache(that);\n          }\n        }\n      };\n\n      function isSortOrderValid(sortOrder) {\n        return \"asc\" === sortOrder || \"desc\" === sortOrder;\n      }\n\n      var addExpandColumn = function (that) {\n        var options = that._getExpandColumnOptions();\n\n        that.addCommandColumn(options);\n      };\n\n      var defaultSetCellValue = function (data, value) {\n        var path = this.dataField.split(\".\");\n        var dotCount = path.length - 1;\n\n        if (this.serializeValue) {\n          value = this.serializeValue(value);\n        }\n\n        for (var i = 0; i < dotCount; i++) {\n          var name = path[i];\n          data = data[name] = data[name] || {};\n        }\n\n        data[path[dotCount]] = value;\n      };\n\n      var getDataColumns = function getDataColumns(columns, rowIndex, bandColumnID) {\n        var result = [];\n        rowIndex = rowIndex || 0;\n        columns[rowIndex] && (0, _iterator.each)(columns[rowIndex], function (_, column) {\n          if (column.ownerBand === bandColumnID || column.type === GROUP_COMMAND_COLUMN_NAME) {\n            if (!column.isBand || !column.colspan) {\n              if (!column.command || rowIndex < 1) {\n                result.push(column);\n              }\n            } else {\n              result.push.apply(result, getDataColumns(columns, rowIndex + 1, column.index));\n            }\n          }\n        });\n        return result;\n      };\n\n      var _getRowCount = function (that) {\n        var rowCount = 1;\n        var bandColumnsCache = that.getBandColumnsCache();\n        var columnParentByIndex = bandColumnsCache.columnParentByIndex;\n\n        that._columns.forEach(function (column) {\n          var parents = getParentBandColumns(column.index, columnParentByIndex);\n          var invisibleParents = parents.filter(function (column) {\n            return !column.visible;\n          });\n\n          if (column.visible && !invisibleParents.length) {\n            rowCount = Math.max(rowCount, parents.length + 1);\n          }\n        });\n\n        return rowCount;\n      };\n\n      var isCustomCommandColumn = function (that, commandColumn) {\n        return !!that._columns.filter(function (column) {\n          return column.type === commandColumn.type;\n        }).length;\n      };\n\n      var getFixedPosition = function (that, column) {\n        var rtlEnabled = that.option(\"rtlEnabled\");\n\n        if (column.command && !isCustomCommandColumn(that, column) || !column.fixedPosition) {\n          return rtlEnabled ? \"right\" : \"left\";\n        }\n\n        return column.fixedPosition;\n      };\n\n      var processExpandColumns = function (columns, expandColumns, type, columnIndex) {\n        var customColumnIndex;\n        var rowCount = this.getRowCount();\n        var rowspan = columns[columnIndex] && columns[columnIndex].rowspan;\n        var expandColumnsByType = expandColumns.filter(function (column) {\n          return column.type === type;\n        });\n        columns.forEach(function (column, index) {\n          if (column.type === type) {\n            customColumnIndex = index;\n            rowspan = columns[index + 1] ? columns[index + 1].rowspan : rowCount;\n          }\n        });\n\n        if (rowspan > 1) {\n          expandColumnsByType = (0, _iterator.map)(expandColumnsByType, function (expandColumn) {\n            return (0, _extend.extend)({}, expandColumn, {\n              rowspan: rowspan\n            });\n          });\n        }\n\n        expandColumnsByType.unshift.apply(expandColumnsByType, (0, _type.isDefined)(customColumnIndex) ? [customColumnIndex, 1] : [columnIndex, 0]);\n        columns.splice.apply(columns, expandColumnsByType);\n        return rowspan || 1;\n      };\n\n      var digitsCount = function (number) {\n        var i;\n\n        for (i = 0; number > 1; i++) {\n          number /= 10;\n        }\n\n        return i;\n      };\n\n      var numberToString = function (number, digitsCount) {\n        var str = number ? number.toString() : \"0\";\n\n        while (str.length < digitsCount) {\n          str = \"0\" + str;\n        }\n\n        return str;\n      };\n\n      var mergeColumns = function (that, columns, commandColumns, needToExtend) {\n        var column;\n        var commandColumnIndex;\n        var result = columns.slice().map(function (column) {\n          return (0, _extend.extend)({}, column);\n        });\n\n        var isColumnFixing = that._isColumnFixing();\n\n        var defaultCommandColumns = commandColumns.slice().map(function (column) {\n          return (0, _extend.extend)({\n            fixed: isColumnFixing\n          }, column);\n        });\n\n        var getCommandColumnIndex = function (column) {\n          return commandColumns.reduce(function (result, commandColumn, index) {\n            var columnType = needToExtend && column.type === GROUP_COMMAND_COLUMN_NAME ? \"expand\" : column.type;\n            return commandColumn.type === columnType || commandColumn.command === column.command ? index : result;\n          }, -1);\n        };\n\n        var callbackFilter = function (commandColumn) {\n          return commandColumn.command !== commandColumns[commandColumnIndex].command;\n        };\n\n        for (var i = 0; i < columns.length; i++) {\n          column = columns[i];\n          commandColumnIndex = column && (column.type || column.command) ? getCommandColumnIndex(column) : -1;\n\n          if (commandColumnIndex >= 0) {\n            if (needToExtend) {\n              result[i] = (0, _extend.extend)({\n                fixed: isColumnFixing\n              }, commandColumns[commandColumnIndex], column);\n\n              if (column.type !== GROUP_COMMAND_COLUMN_NAME) {\n                defaultCommandColumns = defaultCommandColumns.filter(callbackFilter);\n              }\n            } else {\n              var columnOptions = {\n                visibleIndex: column.visibleIndex,\n                index: column.index,\n                headerId: column.headerId,\n                allowFixing: 0 === column.groupIndex,\n                allowReordering: 0 === column.groupIndex,\n                groupIndex: column.groupIndex\n              };\n              result[i] = (0, _extend.extend)({}, column, commandColumns[commandColumnIndex], column.type === GROUP_COMMAND_COLUMN_NAME && columnOptions);\n            }\n          }\n        }\n\n        if (columns.length && needToExtend && defaultCommandColumns.length) {\n          result = result.concat(defaultCommandColumns);\n        }\n\n        return result;\n      };\n\n      var isColumnFixed = function (that, column) {\n        return (0, _type.isDefined)(column.fixed) || !column.type ? column.fixed : that._isColumnFixing();\n      };\n\n      var convertOwnerBandToColumnReference = function (columns) {\n        columns.forEach(function (column) {\n          if ((0, _type.isDefined)(column.ownerBand)) {\n            column.ownerBand = columns[column.ownerBand];\n          }\n        });\n      };\n\n      var resetBandColumnsCache = function (that) {\n        that._bandColumnsCache = void 0;\n      };\n\n      var findColumn = function (columns, identifier) {\n        var identifierOptionName = (0, _type.isString)(identifier) && identifier.substr(0, identifier.indexOf(\":\"));\n        var column;\n\n        if (void 0 === identifier) {\n          return;\n        }\n\n        if (identifierOptionName) {\n          identifier = identifier.substr(identifierOptionName.length + 1);\n        }\n\n        if (identifierOptionName) {\n          column = columns.filter(function (column) {\n            return \"\" + column[identifierOptionName] === identifier;\n          })[0];\n        } else {\n          [\"index\", \"name\", \"dataField\", \"caption\"].some(function (optionName) {\n            column = columns.filter(function (column) {\n              return column[optionName] === identifier;\n            })[0];\n            return !!column;\n          });\n        }\n\n        return column;\n      };\n\n      return {\n        _getExpandColumnOptions: function () {\n          return {\n            type: \"expand\",\n            command: \"expand\",\n            width: \"auto\",\n            cssClass: COMMAND_EXPAND_CLASS,\n            allowEditing: false,\n            allowGrouping: false,\n            allowSorting: false,\n            allowResizing: false,\n            allowReordering: false,\n            allowHiding: false\n          };\n        },\n        _getFirstItems: function (dataSource) {\n          var groupsCount;\n          var items = [];\n\n          var getFirstItemsCore = function getFirstItemsCore(items, groupsCount) {\n            if (!items || !groupsCount) {\n              return items;\n            }\n\n            for (var i = 0; i < items.length; i++) {\n              var childItems = getFirstItemsCore(items[i].items || items[i].collapsedItems, groupsCount - 1);\n\n              if (childItems && childItems.length) {\n                return childItems;\n              }\n            }\n          };\n\n          if (dataSource && dataSource.items().length > 0) {\n            groupsCount = _uiGrid_core2.default.normalizeSortingInfo(dataSource.group()).length;\n            items = getFirstItemsCore(dataSource.items(), groupsCount) || [];\n          }\n\n          return items;\n        },\n        _endUpdateCore: function () {\n          !this._skipProcessingColumnsChange && fireColumnsChanged(this);\n        },\n        init: function () {\n          var that = this;\n          var columns = that.option(\"columns\");\n          that._commandColumns = that._commandColumns || [];\n          that._columns = that._columns || [];\n          that._isColumnsFromOptions = !!columns;\n\n          if (that._isColumnsFromOptions) {\n            assignColumns(that, columns ? createColumnsFromOptions(that, columns) : []);\n            applyUserState(that);\n          } else {\n            assignColumns(that, that._columnsUserState ? createColumnsFromOptions(that, that._columnsUserState) : that._columns);\n          }\n\n          addExpandColumn(that);\n\n          if (that._dataSourceApplied) {\n            that.applyDataSource(that._dataSource, true);\n          } else {\n            updateIndexes(that);\n          }\n\n          that._checkColumns();\n        },\n        callbackNames: function () {\n          return [\"columnsChanged\"];\n        },\n        getColumnByPath: function (path, columns) {\n          var that = this;\n          var column;\n          var columnIndexes = [];\n          path.replace(regExp, function (_, columnIndex) {\n            columnIndexes.push(parseInt(columnIndex));\n            return \"\";\n          });\n\n          if (columnIndexes.length) {\n            if (columns) {\n              column = columnIndexes.reduce(function (column, index) {\n                return column && column.columns && column.columns[index];\n              }, {\n                columns: columns\n              });\n            } else {\n              column = getColumnByIndexes(that, columnIndexes);\n            }\n          }\n\n          return column;\n        },\n        optionChanged: function (args) {\n          var needUpdateRequireResize;\n\n          switch (args.name) {\n            case \"adaptColumnWidthByRatio\":\n              args.handled = true;\n              break;\n\n            case \"dataSource\":\n              if (args.value !== args.previousValue && !this.option(\"columns\") && (!Array.isArray(args.value) || !Array.isArray(args.previousValue))) {\n                this._columns = [];\n              }\n\n              break;\n\n            case \"columns\":\n              needUpdateRequireResize = this._skipProcessingColumnsChange;\n              args.handled = true;\n\n              if (!this._skipProcessingColumnsChange) {\n                if (args.name === args.fullName) {\n                  this._columnsUserState = null;\n                  this._ignoreColumnOptionNames = null;\n                  this.init();\n                } else {\n                  this._columnOptionChanged(args);\n\n                  needUpdateRequireResize = true;\n                }\n              }\n\n              if (needUpdateRequireResize) {\n                this._updateRequireResize(args);\n              }\n\n              break;\n\n            case \"commonColumnSettings\":\n            case \"columnAutoWidth\":\n            case \"allowColumnResizing\":\n            case \"allowColumnReordering\":\n            case \"columnFixing\":\n            case \"grouping\":\n            case \"groupPanel\":\n            case \"regenerateColumnsByVisibleItems\":\n            case \"customizeColumns\":\n            case \"editing\":\n            case \"columnHidingEnabled\":\n            case \"dateSerializationFormat\":\n            case \"columnResizingMode\":\n            case \"columnMinWidth\":\n            case \"columnWidth\":\n              var _args$fullName, _args$fullName2, _args$fullName3, _args$fullName4, _args$fullName5;\n\n              args.handled = true;\n              var ignoreColumnOptionNames = \"columnWidth\" === args.fullName && [\"width\"];\n              var isEditingPopup = 0 === (null === (_args$fullName = args.fullName) || void 0 === _args$fullName ? void 0 : _args$fullName.indexOf(\"editing.popup\"));\n              var isEditingForm = 0 === (null === (_args$fullName2 = args.fullName) || void 0 === _args$fullName2 ? void 0 : _args$fullName2.indexOf(\"editing.form\"));\n              var isEditRowKey = 0 === (null === (_args$fullName3 = args.fullName) || void 0 === _args$fullName3 ? void 0 : _args$fullName3.indexOf(\"editing.editRowKey\"));\n              var isEditColumnName = 0 === (null === (_args$fullName4 = args.fullName) || void 0 === _args$fullName4 ? void 0 : _args$fullName4.indexOf(\"editing.editColumnName\"));\n              var isChanges = 0 === (null === (_args$fullName5 = args.fullName) || void 0 === _args$fullName5 ? void 0 : _args$fullName5.indexOf(\"editing.changes\"));\n              var needReinit = !isEditingPopup && !isEditingForm && !isEditRowKey && !isChanges && !isEditColumnName;\n\n              if (needReinit) {\n                this.reinit(ignoreColumnOptionNames);\n              }\n\n              break;\n\n            case \"rtlEnabled\":\n              this.reinit();\n              break;\n\n            default:\n              this.callBase(args);\n          }\n        },\n        _columnOptionChanged: function (args) {\n          var columnOptionValue = {};\n          var column = this.getColumnByPath(args.fullName);\n          var columnOptionName = args.fullName.replace(regExp, \"\");\n\n          if (column) {\n            if (columnOptionName) {\n              columnOptionValue[columnOptionName] = args.value;\n            } else {\n              columnOptionValue = args.value;\n            }\n\n            this._skipProcessingColumnsChange = args.fullName;\n            this.columnOption(column.index, columnOptionValue);\n            this._skipProcessingColumnsChange = false;\n          }\n        },\n        _updateRequireResize: function (args) {\n          var component = this.component;\n\n          if (\"width\" === args.fullName.replace(regExp, \"\") && component._updateLockCount) {\n            component._requireResize = true;\n          }\n        },\n        publicMethods: function () {\n          return [\"addColumn\", \"deleteColumn\", \"columnOption\", \"columnCount\", \"clearSorting\", \"clearGrouping\", \"getVisibleColumns\", \"getVisibleColumnIndex\"];\n        },\n        applyDataSource: function (dataSource, forceApplying) {\n          var that = this;\n          var isDataSourceLoaded = dataSource && dataSource.isLoaded();\n          that._dataSource = dataSource;\n\n          if (!that._dataSourceApplied || 0 === that._dataSourceColumnsCount || forceApplying || that.option(\"regenerateColumnsByVisibleItems\")) {\n            if (isDataSourceLoaded) {\n              if (!that._isColumnsFromOptions) {\n                var columnsFromDataSource = createColumnsFromDataSource(that, dataSource);\n\n                if (columnsFromDataSource.length) {\n                  assignColumns(that, columnsFromDataSource);\n                  that._dataSourceColumnsCount = that._columns.length;\n                  applyUserState(that);\n                }\n              }\n\n              return that.updateColumns(dataSource, forceApplying);\n            } else {\n              that._dataSourceApplied = false;\n            }\n          } else {\n            if (isDataSourceLoaded && !that.isAllDataTypesDefined(true) && that.updateColumnDataTypes(dataSource)) {\n              updateColumnChanges(that, \"columns\");\n              fireColumnsChanged(that);\n              return new _deferred.Deferred().reject().promise();\n            }\n          }\n        },\n        reset: function () {\n          this._dataSourceApplied = false;\n          this._dataSourceColumnsCount = void 0;\n          this.reinit();\n        },\n        resetColumnsCache: function () {\n          var that = this;\n          that._visibleColumns = void 0;\n          that._fixedColumns = void 0;\n          that._rowCount = void 0;\n          resetBandColumnsCache(that);\n        },\n        reinit: function (ignoreColumnOptionNames) {\n          this._columnsUserState = this.getUserState();\n          this._ignoreColumnOptionNames = ignoreColumnOptionNames || null;\n          this.init();\n\n          if (ignoreColumnOptionNames) {\n            this._ignoreColumnOptionNames = null;\n          }\n        },\n        isInitialized: function () {\n          return !!this._columns.length || !!this.option(\"columns\");\n        },\n        isDataSourceApplied: function () {\n          return this._dataSourceApplied;\n        },\n        getCommonSettings: function (column) {\n          var commonColumnSettings = (!column || !column.type) && this.option(\"commonColumnSettings\") || {};\n          var groupingOptions = this.option(\"grouping\") || {};\n          var groupPanelOptions = this.option(\"groupPanel\") || {};\n          return (0, _extend.extend)({\n            allowFixing: this.option(\"columnFixing.enabled\"),\n            allowResizing: this.option(\"allowColumnResizing\") || void 0,\n            allowReordering: this.option(\"allowColumnReordering\"),\n            minWidth: this.option(\"columnMinWidth\"),\n            width: this.option(\"columnWidth\"),\n            autoExpandGroup: groupingOptions.autoExpandAll,\n            allowCollapsing: groupingOptions.allowCollapsing,\n            allowGrouping: groupPanelOptions.allowColumnDragging && groupPanelOptions.visible || groupingOptions.contextMenuEnabled\n          }, commonColumnSettings);\n        },\n        isColumnOptionUsed: function (optionName) {\n          for (var i = 0; i < this._columns.length; i++) {\n            if (this._columns[i][optionName]) {\n              return true;\n            }\n          }\n        },\n        isAllDataTypesDefined: function (checkSerializers) {\n          var columns = this._columns;\n\n          if (!columns.length) {\n            return false;\n          }\n\n          for (var i = 0; i < columns.length; i++) {\n            if (!columns[i].dataField && columns[i].calculateCellValue === columns[i].defaultCalculateCellValue) {\n              continue;\n            }\n\n            if (!columns[i].dataType || checkSerializers && columns[i].deserializeValue && void 0 === columns[i].serializationFormat) {\n              return false;\n            }\n          }\n\n          return true;\n        },\n        getColumns: function () {\n          return this._columns;\n        },\n        isBandColumnsUsed: function () {\n          return this.getColumns().some(function (column) {\n            return column.isBand;\n          });\n        },\n        getGroupColumns: function () {\n          var result = [];\n          (0, _iterator.each)(this._columns, function () {\n            var column = this;\n\n            if ((0, _type.isDefined)(column.groupIndex)) {\n              result[column.groupIndex] = column;\n            }\n          });\n          return result;\n        },\n        getVisibleColumns: function (rowIndex) {\n          this._visibleColumns = this._visibleColumns || this._getVisibleColumnsCore();\n          rowIndex = (0, _type.isDefined)(rowIndex) ? rowIndex : this._visibleColumns.length - 1;\n          return this._visibleColumns[rowIndex] || [];\n        },\n        getFixedColumns: function (rowIndex) {\n          this._fixedColumns = this._fixedColumns || this._getFixedColumnsCore();\n          rowIndex = (0, _type.isDefined)(rowIndex) ? rowIndex : this._fixedColumns.length - 1;\n          return this._fixedColumns[rowIndex] || [];\n        },\n        getFilteringColumns: function () {\n          return this.getColumns().filter(function (item) {\n            return (item.dataField || item.name) && (item.allowFiltering || item.allowHeaderFiltering);\n          }).map(function (item) {\n            var field = (0, _extend.extend)(true, {}, item);\n\n            if (!(0, _type.isDefined)(field.dataField)) {\n              field.dataField = field.name;\n            }\n\n            field.filterOperations = item.filterOperations !== item.defaultFilterOperations ? field.filterOperations : null;\n            return field;\n          });\n        },\n        getColumnIndexOffset: function () {\n          return 0;\n        },\n        _getFixedColumnsCore: function () {\n          var that = this;\n          var result = [];\n          var rowCount = that.getRowCount();\n\n          var isColumnFixing = that._isColumnFixing();\n\n          var transparentColumn = {\n            command: \"transparent\"\n          };\n          var transparentColspan = 0;\n          var notFixedColumnCount;\n          var transparentColumnIndex;\n          var lastFixedPosition;\n\n          if (isColumnFixing) {\n            for (var i = 0; i <= rowCount; i++) {\n              notFixedColumnCount = 0;\n              lastFixedPosition = null;\n              transparentColumnIndex = null;\n              var visibleColumns = that.getVisibleColumns(i, true);\n\n              for (var j = 0; j < visibleColumns.length; j++) {\n                var prevColumn = visibleColumns[j - 1];\n                var column = visibleColumns[j];\n\n                if (!column.fixed) {\n                  if (0 === i) {\n                    if (column.isBand && column.colspan) {\n                      transparentColspan += column.colspan;\n                    } else {\n                      transparentColspan++;\n                    }\n                  }\n\n                  notFixedColumnCount++;\n\n                  if (!(0, _type.isDefined)(transparentColumnIndex)) {\n                    transparentColumnIndex = j;\n                  }\n                } else {\n                  if (prevColumn && prevColumn.fixed && getFixedPosition(that, prevColumn) !== getFixedPosition(that, column)) {\n                    if (!(0, _type.isDefined)(transparentColumnIndex)) {\n                      transparentColumnIndex = j;\n                    }\n                  } else {\n                    lastFixedPosition = column.fixedPosition;\n                  }\n                }\n              }\n\n              if (0 === i && (0 === notFixedColumnCount || notFixedColumnCount >= visibleColumns.length)) {\n                return [];\n              }\n\n              if (!(0, _type.isDefined)(transparentColumnIndex)) {\n                transparentColumnIndex = \"right\" === lastFixedPosition ? 0 : visibleColumns.length;\n              }\n\n              result[i] = visibleColumns.slice(0);\n\n              if (!transparentColumn.colspan) {\n                transparentColumn.colspan = transparentColspan;\n              }\n\n              result[i].splice(transparentColumnIndex, notFixedColumnCount, transparentColumn);\n            }\n          }\n\n          return result.map(function (columns) {\n            return columns.map(function (column) {\n              var newColumn = _objectSpread({}, column);\n\n              if (newColumn.headerId) {\n                newColumn.headerId += \"-fixed\";\n              }\n\n              return newColumn;\n            });\n          });\n        },\n        _isColumnFixing: function () {\n          var isColumnFixing = this.option(\"columnFixing.enabled\");\n          !isColumnFixing && (0, _iterator.each)(this._columns, function (_, column) {\n            if (column.fixed) {\n              isColumnFixing = true;\n              return false;\n            }\n          });\n          return isColumnFixing;\n        },\n        _getExpandColumnsCore: function () {\n          return this.getGroupColumns();\n        },\n        getExpandColumns: function () {\n          var expandColumns = this._getExpandColumnsCore();\n\n          var expandColumn;\n          var firstGroupColumn = expandColumns.filter(function (column) {\n            return 0 === column.groupIndex;\n          })[0];\n          var isFixedFirstGroupColumn = firstGroupColumn && firstGroupColumn.fixed;\n\n          var isColumnFixing = this._isColumnFixing();\n\n          if (expandColumns.length) {\n            expandColumn = this.columnOption(\"command:expand\");\n          }\n\n          expandColumns = (0, _iterator.map)(expandColumns, function (column) {\n            return (0, _extend.extend)({}, column, {\n              visibleWidth: null,\n              minWidth: null,\n              cellTemplate: !(0, _type.isDefined)(column.groupIndex) ? column.cellTemplate : null,\n              headerCellTemplate: null,\n              fixed: !(0, _type.isDefined)(column.groupIndex) || !isFixedFirstGroupColumn ? isColumnFixing : true\n            }, expandColumn, {\n              index: column.index,\n              type: column.type || GROUP_COMMAND_COLUMN_NAME\n            });\n          });\n          return expandColumns;\n        },\n        getBandColumnsCache: function () {\n          if (!this._bandColumnsCache) {\n            var columns = this._columns;\n            var columnChildrenByIndex = {};\n            var columnParentByIndex = {};\n            var isPlain = true;\n            columns.forEach(function (column) {\n              var parentIndex = column.ownerBand;\n              var parent = columns[parentIndex];\n\n              if (column.hasColumns) {\n                isPlain = false;\n              }\n\n              if (column.colspan) {\n                column.colspan = void 0;\n              }\n\n              if (column.rowspan) {\n                column.rowspan = void 0;\n              }\n\n              if (parent) {\n                columnParentByIndex[column.index] = parent;\n              } else {\n                parentIndex = -1;\n              }\n\n              columnChildrenByIndex[parentIndex] = columnChildrenByIndex[parentIndex] || [];\n              columnChildrenByIndex[parentIndex].push(column);\n            });\n            this._bandColumnsCache = {\n              isPlain: isPlain,\n              columnChildrenByIndex: columnChildrenByIndex,\n              columnParentByIndex: columnParentByIndex\n            };\n          }\n\n          return this._bandColumnsCache;\n        },\n        _isColumnVisible: function (column) {\n          return column.visible && this.isParentColumnVisible(column.index);\n        },\n        _getVisibleColumnsCore: function () {\n          var that = this;\n          var i;\n          var result = [];\n          var rowspanGroupColumns = 0;\n          var rowspanExpandColumns = 0;\n          var rowCount = that.getRowCount();\n          var positiveIndexedColumns = [];\n          var negativeIndexedColumns = [];\n          var notGroupedColumnsCount = 0;\n          var isFixedToEnd;\n          var rtlEnabled = that.option(\"rtlEnabled\");\n          var bandColumnsCache = that.getBandColumnsCache();\n          var expandColumns = mergeColumns(that, that.getExpandColumns(), that._columns);\n          var columns = mergeColumns(that, that._columns, that._commandColumns, true);\n          var columnDigitsCount = digitsCount(columns.length);\n          processBandColumns(that, columns, bandColumnsCache);\n\n          for (i = 0; i < rowCount; i++) {\n            result[i] = [];\n            negativeIndexedColumns[i] = [{}];\n            positiveIndexedColumns[i] = [{}, {}, {}];\n          }\n\n          (0, _iterator.each)(columns, function () {\n            var column = this;\n            var visibleIndex = column.visibleIndex;\n            var indexedColumns;\n            var parentBandColumns = getParentBandColumns(column.index, bandColumnsCache.columnParentByIndex);\n\n            var visible = that._isColumnVisible(column);\n\n            if (visible && (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped)) {\n              var rowIndex = parentBandColumns.length;\n\n              if (visibleIndex < 0) {\n                visibleIndex = -visibleIndex;\n                indexedColumns = negativeIndexedColumns[rowIndex];\n              } else {\n                column.fixed = parentBandColumns.length ? parentBandColumns[0].fixed : column.fixed;\n                column.fixedPosition = parentBandColumns.length ? parentBandColumns[0].fixedPosition : column.fixedPosition;\n\n                if (column.fixed) {\n                  isFixedToEnd = \"right\" === column.fixedPosition;\n\n                  if (rtlEnabled && (!column.command || isCustomCommandColumn(that, column))) {\n                    isFixedToEnd = !isFixedToEnd;\n                  }\n\n                  if (isFixedToEnd) {\n                    indexedColumns = positiveIndexedColumns[rowIndex][2];\n                  } else {\n                    indexedColumns = positiveIndexedColumns[rowIndex][0];\n                  }\n                } else {\n                  indexedColumns = positiveIndexedColumns[rowIndex][1];\n                }\n              }\n\n              if (parentBandColumns.length) {\n                visibleIndex = numberToString(visibleIndex, columnDigitsCount);\n\n                for (i = parentBandColumns.length - 1; i >= 0; i--) {\n                  visibleIndex = numberToString(parentBandColumns[i].visibleIndex, columnDigitsCount) + visibleIndex;\n                }\n              }\n\n              indexedColumns[visibleIndex] = indexedColumns[visibleIndex] || [];\n              indexedColumns[visibleIndex].push(column);\n              notGroupedColumnsCount++;\n            }\n          });\n          (0, _iterator.each)(result, function (rowIndex) {\n            (0, _object.orderEach)(negativeIndexedColumns[rowIndex], function (_, columns) {\n              result[rowIndex].unshift.apply(result[rowIndex], columns);\n            });\n            var firstPositiveIndexColumn = result[rowIndex].length;\n            (0, _iterator.each)(positiveIndexedColumns[rowIndex], function (index, columnsByFixing) {\n              (0, _object.orderEach)(columnsByFixing, function (_, columnsByVisibleIndex) {\n                result[rowIndex].push.apply(result[rowIndex], columnsByVisibleIndex);\n              });\n            });\n\n            if (rowspanExpandColumns < rowIndex + 1) {\n              rowspanExpandColumns += processExpandColumns.call(that, result[rowIndex], expandColumns, \"detailExpand\", firstPositiveIndexColumn);\n            }\n\n            if (rowspanGroupColumns < rowIndex + 1) {\n              rowspanGroupColumns += processExpandColumns.call(that, result[rowIndex], expandColumns, GROUP_COMMAND_COLUMN_NAME, firstPositiveIndexColumn);\n            }\n          });\n          result.push(getDataColumns(result));\n\n          if (!notGroupedColumnsCount && that._columns.length) {\n            result[rowCount].push({\n              command: \"empty\"\n            });\n          }\n\n          return result;\n        },\n        getInvisibleColumns: function (columns, bandColumnIndex) {\n          var that = this;\n          var result = [];\n          var hiddenColumnsByBand;\n          columns = columns || that._columns;\n          (0, _iterator.each)(columns, function (_, column) {\n            if (column.ownerBand !== bandColumnIndex) {\n              return;\n            }\n\n            if (column.isBand) {\n              if (!column.visible) {\n                hiddenColumnsByBand = that.getChildrenByBandColumn(column.index);\n              } else {\n                hiddenColumnsByBand = that.getInvisibleColumns(that.getChildrenByBandColumn(column.index), column.index);\n              }\n\n              if (hiddenColumnsByBand.length) {\n                result.push(column);\n                result = result.concat(hiddenColumnsByBand);\n              }\n\n              return;\n            }\n\n            if (!column.visible) {\n              result.push(column);\n            }\n          });\n          return result;\n        },\n        getChooserColumns: function (getAllColumns) {\n          var columns = getAllColumns ? this.getColumns() : this.getInvisibleColumns();\n          return (0, _common.grep)(columns, function (column) {\n            return column.showInColumnChooser;\n          });\n        },\n        allowMoveColumn: function (fromVisibleIndex, toVisibleIndex, sourceLocation, targetLocation) {\n          var that = this;\n          var columnIndex = getColumnIndexByVisibleIndex(that, fromVisibleIndex, sourceLocation);\n          var sourceColumn = that._columns[columnIndex];\n\n          if (sourceColumn && (sourceColumn.allowReordering || sourceColumn.allowGrouping || sourceColumn.allowHiding)) {\n            if (sourceLocation === targetLocation) {\n              if (sourceLocation === COLUMN_CHOOSER_LOCATION) {\n                return false;\n              }\n\n              fromVisibleIndex = (0, _type.isObject)(fromVisibleIndex) ? fromVisibleIndex.columnIndex : fromVisibleIndex;\n              toVisibleIndex = (0, _type.isObject)(toVisibleIndex) ? toVisibleIndex.columnIndex : toVisibleIndex;\n              return fromVisibleIndex !== toVisibleIndex && fromVisibleIndex + 1 !== toVisibleIndex;\n            } else {\n              if (sourceLocation === GROUP_LOCATION && targetLocation !== COLUMN_CHOOSER_LOCATION || targetLocation === GROUP_LOCATION) {\n                return sourceColumn && sourceColumn.allowGrouping;\n              } else {\n                if (sourceLocation === COLUMN_CHOOSER_LOCATION || targetLocation === COLUMN_CHOOSER_LOCATION) {\n                  return sourceColumn && sourceColumn.allowHiding;\n                }\n              }\n            }\n\n            return true;\n          }\n\n          return false;\n        },\n        moveColumn: function (fromVisibleIndex, toVisibleIndex, sourceLocation, targetLocation) {\n          var that = this;\n          var options = {};\n          var prevGroupIndex;\n          var fromIndex = getColumnIndexByVisibleIndex(that, fromVisibleIndex, sourceLocation);\n          var toIndex = getColumnIndexByVisibleIndex(that, toVisibleIndex, targetLocation);\n          var targetGroupIndex;\n\n          if (fromIndex >= 0) {\n            var column = that._columns[fromIndex];\n            toVisibleIndex = (0, _type.isObject)(toVisibleIndex) ? toVisibleIndex.columnIndex : toVisibleIndex;\n            targetGroupIndex = toIndex >= 0 ? that._columns[toIndex].groupIndex : -1;\n\n            if ((0, _type.isDefined)(column.groupIndex) && sourceLocation === GROUP_LOCATION) {\n              if (targetGroupIndex > column.groupIndex) {\n                targetGroupIndex--;\n              }\n\n              if (targetLocation !== GROUP_LOCATION) {\n                options.groupIndex = void 0;\n              } else {\n                prevGroupIndex = column.groupIndex;\n                delete column.groupIndex;\n                updateColumnGroupIndexes(that);\n              }\n            }\n\n            if (targetLocation === GROUP_LOCATION) {\n              options.groupIndex = moveColumnToGroup(that, column, targetGroupIndex);\n              column.groupIndex = prevGroupIndex;\n            } else {\n              if (toVisibleIndex >= 0) {\n                var targetColumn = that._columns[toIndex];\n\n                if (!targetColumn || column.ownerBand !== targetColumn.ownerBand) {\n                  options.visibleIndex = MAX_SAFE_INTEGER;\n                } else {\n                  if (isColumnFixed(that, column) ^ isColumnFixed(that, targetColumn)) {\n                    options.visibleIndex = MAX_SAFE_INTEGER;\n                  } else {\n                    options.visibleIndex = targetColumn.visibleIndex;\n                  }\n                }\n              }\n            }\n\n            var isVisible = targetLocation !== COLUMN_CHOOSER_LOCATION;\n\n            if (column.visible !== isVisible) {\n              options.visible = isVisible;\n            }\n\n            that.columnOption(column.index, options);\n          }\n        },\n        changeSortOrder: function (columnIndex, sortOrder) {\n          var that = this;\n          var options = {};\n          var sortingOptions = that.option(\"sorting\");\n          var sortingMode = sortingOptions && sortingOptions.mode;\n          var needResetSorting = \"single\" === sortingMode || !sortOrder;\n          var allowSorting = \"single\" === sortingMode || \"multiple\" === sortingMode;\n          var column = that._columns[columnIndex];\n\n          var nextSortOrder = function (column) {\n            if (\"ctrl\" === sortOrder) {\n              if (!(\"sortOrder\" in column && \"sortIndex\" in column)) {\n                return false;\n              }\n\n              options.sortOrder = void 0;\n              options.sortIndex = void 0;\n            } else {\n              if ((0, _type.isDefined)(column.groupIndex) || (0, _type.isDefined)(column.sortIndex)) {\n                options.sortOrder = \"desc\" === column.sortOrder ? \"asc\" : \"desc\";\n              } else {\n                options.sortOrder = \"asc\";\n              }\n            }\n\n            return true;\n          };\n\n          if (allowSorting && column && column.allowSorting) {\n            if (needResetSorting && !(0, _type.isDefined)(column.groupIndex)) {\n              (0, _iterator.each)(that._columns, function (index) {\n                if (index !== columnIndex && this.sortOrder) {\n                  if (!(0, _type.isDefined)(this.groupIndex)) {\n                    delete this.sortOrder;\n                  }\n\n                  delete this.sortIndex;\n                }\n              });\n            }\n\n            if (isSortOrderValid(sortOrder)) {\n              if (column.sortOrder !== sortOrder) {\n                options.sortOrder = sortOrder;\n              }\n            } else {\n              if (\"none\" === sortOrder) {\n                if (column.sortOrder) {\n                  options.sortIndex = void 0;\n                  options.sortOrder = void 0;\n                }\n              } else {\n                nextSortOrder(column);\n              }\n            }\n          }\n\n          that.columnOption(column.index, options);\n        },\n        getSortDataSourceParameters: function (useLocalSelector) {\n          var that = this;\n          var sortColumns = [];\n          var sort = [];\n          (0, _iterator.each)(that._columns, function () {\n            if ((this.dataField || this.selector || this.calculateCellValue) && (0, _type.isDefined)(this.sortIndex) && !(0, _type.isDefined)(this.groupIndex)) {\n              sortColumns[this.sortIndex] = this;\n            }\n          });\n          (0, _iterator.each)(sortColumns, function () {\n            var sortOrder = this && this.sortOrder;\n\n            if (isSortOrderValid(sortOrder)) {\n              var sortItem = {\n                selector: this.calculateSortValue || this.displayField || this.calculateDisplayValue || useLocalSelector && this.selector || this.dataField || this.calculateCellValue,\n                desc: \"desc\" === this.sortOrder\n              };\n\n              if (this.sortingMethod) {\n                sortItem.compare = this.sortingMethod.bind(this);\n              }\n\n              sort.push(sortItem);\n            }\n          });\n          return sort.length > 0 ? sort : null;\n        },\n        getGroupDataSourceParameters: function (useLocalSelector) {\n          var group = [];\n          (0, _iterator.each)(this.getGroupColumns(), function () {\n            var selector = this.calculateGroupValue || this.displayField || this.calculateDisplayValue || useLocalSelector && this.selector || this.dataField || this.calculateCellValue;\n\n            if (selector) {\n              var groupItem = {\n                selector: selector,\n                desc: \"desc\" === this.sortOrder,\n                isExpanded: !!this.autoExpandGroup\n              };\n\n              if (this.sortingMethod) {\n                groupItem.compare = this.sortingMethod.bind(this);\n              }\n\n              group.push(groupItem);\n            }\n          });\n          return group.length > 0 ? group : null;\n        },\n        refresh: function (updateNewLookupsOnly) {\n          var deferreds = [];\n          (0, _iterator.each)(this._columns, function () {\n            var lookup = this.lookup;\n\n            if (lookup && !this.calculateDisplayValue) {\n              if (updateNewLookupsOnly && lookup.valueMap) {\n                return;\n              }\n\n              if (lookup.update) {\n                deferreds.push(lookup.update());\n              }\n            }\n          });\n          return _deferred.when.apply(_renderer.default, deferreds).done(resetColumnsCache.bind(null, this));\n        },\n        _updateColumnOptions: function (column, columnIndex) {\n          column.selector = column.selector || function (data) {\n            return column.calculateCellValue(data);\n          };\n\n          (0, _iterator.each)([\"calculateSortValue\", \"calculateGroupValue\", \"calculateDisplayValue\"], function (_, calculateCallbackName) {\n            var calculateCallback = column[calculateCallbackName];\n\n            if ((0, _type.isFunction)(calculateCallback) && !calculateCallback.originalCallback) {\n              column[calculateCallbackName] = function (data) {\n                return calculateCallback.call(column, data);\n              };\n\n              column[calculateCallbackName].originalCallback = calculateCallback;\n              column[calculateCallbackName].columnIndex = columnIndex;\n            }\n          });\n\n          if ((0, _type.isString)(column.calculateDisplayValue)) {\n            column.displayField = column.calculateDisplayValue;\n            column.calculateDisplayValue = (0, _data.compileGetter)(column.displayField);\n          }\n\n          if (column.calculateDisplayValue) {\n            column.displayValueMap = column.displayValueMap || {};\n          }\n\n          updateSerializers(column, column.dataType);\n          var lookup = column.lookup;\n\n          if (lookup) {\n            updateSerializers(lookup, lookup.dataType);\n          }\n\n          var dataType = lookup ? lookup.dataType : column.dataType;\n\n          if (dataType) {\n            column.alignment = column.alignment || getAlignmentByDataType(dataType, this.option(\"rtlEnabled\"));\n            column.format = column.format || _uiGrid_core2.default.getFormatByDataType(dataType);\n            column.customizeText = column.customizeText || getCustomizeTextByDataType(dataType);\n            column.defaultFilterOperations = column.defaultFilterOperations || !lookup && DATATYPE_OPERATIONS[dataType] || [];\n\n            if (!(0, _type.isDefined)(column.filterOperations)) {\n              setFilterOperationsAsDefaultValues(column);\n            }\n\n            column.defaultFilterOperation = column.filterOperations && column.filterOperations[0] || \"=\";\n            column.showEditorAlways = (0, _type.isDefined)(column.showEditorAlways) ? column.showEditorAlways : \"boolean\" === dataType && !column.cellTemplate;\n          }\n        },\n        updateColumnDataTypes: function (dataSource) {\n          var that = this;\n          var dateSerializationFormat = that.option(\"dateSerializationFormat\");\n\n          var firstItems = that._getFirstItems(dataSource);\n\n          var isColumnDataTypesUpdated = false;\n          (0, _iterator.each)(that._columns, function (index, column) {\n            var i;\n            var value;\n            var dataType;\n            var lookupDataType;\n            var valueDataType;\n            var lookup = column.lookup;\n\n            if (_uiGrid_core2.default.isDateType(column.dataType) && void 0 === column.serializationFormat) {\n              column.serializationFormat = dateSerializationFormat;\n            }\n\n            if (lookup && _uiGrid_core2.default.isDateType(lookup.dataType) && void 0 === column.serializationFormat) {\n              lookup.serializationFormat = dateSerializationFormat;\n            }\n\n            if (column.calculateCellValue && firstItems.length) {\n              if (!column.dataType || lookup && !lookup.dataType) {\n                for (i = 0; i < firstItems.length; i++) {\n                  value = column.calculateCellValue(firstItems[i]);\n\n                  if (!column.dataType) {\n                    valueDataType = getValueDataType(value);\n                    dataType = dataType || valueDataType;\n\n                    if (dataType && valueDataType && dataType !== valueDataType) {\n                      dataType = \"string\";\n                    }\n                  }\n\n                  if (lookup && !lookup.dataType) {\n                    valueDataType = getValueDataType(_uiGrid_core2.default.getDisplayValue(column, value, firstItems[i]));\n                    lookupDataType = lookupDataType || valueDataType;\n\n                    if (lookupDataType && valueDataType && lookupDataType !== valueDataType) {\n                      lookupDataType = \"string\";\n                    }\n                  }\n                }\n\n                if (dataType || lookupDataType) {\n                  if (dataType) {\n                    column.dataType = dataType;\n                  }\n\n                  if (lookup && lookupDataType) {\n                    lookup.dataType = lookupDataType;\n                  }\n\n                  isColumnDataTypesUpdated = true;\n                }\n              }\n\n              if (void 0 === column.serializationFormat || lookup && void 0 === lookup.serializationFormat) {\n                for (i = 0; i < firstItems.length; i++) {\n                  value = column.calculateCellValue(firstItems[i], true);\n\n                  if (void 0 === column.serializationFormat) {\n                    column.serializationFormat = getSerializationFormat(column.dataType, value);\n                  }\n\n                  if (lookup && void 0 === lookup.serializationFormat) {\n                    lookup.serializationFormat = getSerializationFormat(lookup.dataType, lookup.calculateCellValue(value, true));\n                  }\n                }\n              }\n            }\n\n            that._updateColumnOptions(column, index);\n          });\n          return isColumnDataTypesUpdated;\n        },\n        _customizeColumns: function (columns) {\n          var that = this;\n          var customizeColumns = that.option(\"customizeColumns\");\n\n          if (customizeColumns) {\n            var hasOwnerBand = columns.some(function (column) {\n              return (0, _type.isObject)(column.ownerBand);\n            });\n\n            if (hasOwnerBand) {\n              updateIndexes(that);\n            }\n\n            customizeColumns(columns);\n            assignColumns(that, createColumnsFromOptions(that, columns));\n          }\n        },\n        updateColumns: function (dataSource, forceApplying) {\n          var _this = this;\n\n          if (!forceApplying) {\n            this.updateSortingGrouping(dataSource);\n          }\n\n          if (!dataSource || dataSource.isLoaded()) {\n            var sortParameters = dataSource ? dataSource.sort() || [] : this.getSortDataSourceParameters();\n            var groupParameters = dataSource ? dataSource.group() || [] : this.getGroupDataSourceParameters();\n            var filterParameters = null === dataSource || void 0 === dataSource ? void 0 : dataSource.lastLoadOptions().filter;\n\n            this._customizeColumns(this._columns);\n\n            updateIndexes(this);\n            var columns = this._columns;\n            return (0, _deferred.when)(this.refresh(true)).always(function () {\n              if (_this._columns !== columns) {\n                return;\n              }\n\n              _this._updateChanges(dataSource, {\n                sorting: sortParameters,\n                grouping: groupParameters,\n                filtering: filterParameters\n              });\n\n              fireColumnsChanged(_this);\n            });\n          }\n        },\n        _updateChanges: function (dataSource, parameters) {\n          if (dataSource) {\n            this.updateColumnDataTypes(dataSource);\n            this._dataSourceApplied = true;\n          }\n\n          if (!_uiGrid_core2.default.equalSortParameters(parameters.sorting, this.getSortDataSourceParameters())) {\n            updateColumnChanges(this, \"sorting\");\n          }\n\n          if (!_uiGrid_core2.default.equalSortParameters(parameters.grouping, this.getGroupDataSourceParameters())) {\n            updateColumnChanges(this, \"grouping\");\n          }\n\n          var dataController = this.getController(\"data\");\n\n          if (dataController && !_uiGrid_core2.default.equalFilterParameters(parameters.filtering, dataController.getCombinedFilter())) {\n            updateColumnChanges(this, \"filtering\");\n          }\n\n          updateColumnChanges(this, \"columns\");\n        },\n        updateSortingGrouping: function (dataSource, fromDataSource) {\n          var that = this;\n          var sortParameters;\n          var isColumnsChanged;\n\n          var updateSortGroupParameterIndexes = function (columns, sortParameters, indexParameterName) {\n            (0, _iterator.each)(columns, function (index, column) {\n              delete column[indexParameterName];\n\n              if (sortParameters) {\n                for (var i = 0; i < sortParameters.length; i++) {\n                  var selector = sortParameters[i].selector;\n                  var isExpanded = sortParameters[i].isExpanded;\n\n                  if (selector === column.dataField || selector === column.name || selector === column.selector || selector === column.calculateCellValue || selector === column.calculateGroupValue || selector === column.calculateDisplayValue) {\n                    column.sortOrder = column.sortOrder || (sortParameters[i].desc ? \"desc\" : \"asc\");\n\n                    if (void 0 !== isExpanded) {\n                      column.autoExpandGroup = isExpanded;\n                    }\n\n                    column[indexParameterName] = i;\n                    break;\n                  }\n                }\n              }\n            });\n          };\n\n          if (dataSource) {\n            sortParameters = _uiGrid_core2.default.normalizeSortingInfo(dataSource.sort());\n\n            var groupParameters = _uiGrid_core2.default.normalizeSortingInfo(dataSource.group());\n\n            var columnsGroupParameters = that.getGroupDataSourceParameters();\n            var columnsSortParameters = that.getSortDataSourceParameters();\n\n            if (!that._columns.length) {\n              (0, _iterator.each)(groupParameters, function (index, group) {\n                that._columns.push(group.selector);\n              });\n              (0, _iterator.each)(sortParameters, function (index, sort) {\n                that._columns.push(sort.selector);\n              });\n              assignColumns(that, createColumnsFromOptions(that, that._columns));\n            }\n\n            if ((fromDataSource || !columnsGroupParameters && !that._hasUserState) && !_uiGrid_core2.default.equalSortParameters(groupParameters, columnsGroupParameters)) {\n              updateSortGroupParameterIndexes(that._columns, groupParameters, \"groupIndex\");\n\n              if (fromDataSource) {\n                updateColumnChanges(that, \"grouping\");\n                isColumnsChanged = true;\n              }\n            }\n\n            if ((fromDataSource || !columnsSortParameters && !that._hasUserState) && !_uiGrid_core2.default.equalSortParameters(sortParameters, columnsSortParameters)) {\n              updateSortGroupParameterIndexes(that._columns, sortParameters, \"sortIndex\");\n\n              if (fromDataSource) {\n                updateColumnChanges(that, \"sorting\");\n                isColumnsChanged = true;\n              }\n            }\n\n            if (isColumnsChanged) {\n              fireColumnsChanged(that);\n            }\n          }\n        },\n        updateFilter: function (filter, remoteFiltering, columnIndex, filterValue) {\n          var that = this;\n\n          if (!Array.isArray(filter)) {\n            return filter;\n          }\n\n          filter = (0, _extend.extend)([], filter);\n          columnIndex = void 0 !== filter.columnIndex ? filter.columnIndex : columnIndex;\n          filterValue = void 0 !== filter.filterValue ? filter.filterValue : filterValue;\n\n          if ((0, _type.isString)(filter[0]) && \"!\" !== filter[0]) {\n            var column = that.columnOption(filter[0]);\n\n            if (remoteFiltering) {\n              if ((0, _config.default)().forceIsoDateParsing && column && column.serializeValue && filter.length > 1) {\n                filter[filter.length - 1] = column.serializeValue(filter[filter.length - 1], \"filter\");\n              }\n            } else {\n              if (column && column.selector) {\n                filter[0] = column.selector;\n                filter[0].columnIndex = column.index;\n              }\n            }\n          } else {\n            if ((0, _type.isFunction)(filter[0])) {\n              filter[0].columnIndex = columnIndex;\n              filter[0].filterValue = filterValue;\n            }\n          }\n\n          for (var i = 0; i < filter.length; i++) {\n            filter[i] = that.updateFilter(filter[i], remoteFiltering, columnIndex, filterValue);\n          }\n\n          return filter;\n        },\n        columnCount: function () {\n          return this._columns ? this._columns.length : 0;\n        },\n        columnOption: function (identifier, option, value, notFireEvent) {\n          var that = this;\n\n          var columns = that._columns.concat(that._commandColumns);\n\n          var column = findColumn(columns, identifier);\n\n          if (column) {\n            if (1 === arguments.length) {\n              return (0, _extend.extend)({}, column);\n            }\n\n            if ((0, _type.isString)(option)) {\n              if (2 === arguments.length) {\n                return columnOptionCore(that, column, option);\n              } else {\n                columnOptionCore(that, column, option, value, notFireEvent);\n              }\n            } else {\n              if ((0, _type.isObject)(option)) {\n                (0, _iterator.each)(option, function (optionName, value) {\n                  columnOptionCore(that, column, optionName, value, notFireEvent);\n                });\n              }\n            }\n\n            fireColumnsChanged(that);\n          }\n        },\n        clearSorting: function () {\n          var that = this;\n          var columnCount = this.columnCount();\n          that.beginUpdate();\n\n          for (var i = 0; i < columnCount; i++) {\n            that.columnOption(i, \"sortOrder\", void 0);\n          }\n\n          that.endUpdate();\n        },\n        clearGrouping: function () {\n          var that = this;\n          var columnCount = this.columnCount();\n          that.beginUpdate();\n\n          for (var i = 0; i < columnCount; i++) {\n            that.columnOption(i, \"groupIndex\", void 0);\n          }\n\n          that.endUpdate();\n        },\n        getVisibleIndex: function (index, rowIndex) {\n          var columns = this.getVisibleColumns(rowIndex);\n\n          for (var i = columns.length - 1; i >= 0; i--) {\n            if (columns[i].index === index) {\n              return i;\n            }\n          }\n\n          return -1;\n        },\n        getVisibleColumnIndex: function (id, rowIndex) {\n          var index = this.columnOption(id, \"index\");\n          return this.getVisibleIndex(index, rowIndex);\n        },\n        addColumn: function (options) {\n          var that = this;\n          var column = createColumn(that, options);\n          var index = that._columns.length;\n\n          that._columns.push(column);\n\n          if (column.isBand) {\n            that._columns = createColumnsFromOptions(that, that._columns);\n            column = that._columns[index];\n          }\n\n          column.added = options;\n          updateIndexes(that, column);\n          that.updateColumns(that._dataSource);\n\n          that._checkColumns();\n        },\n        deleteColumn: function (id) {\n          var that = this;\n          var column = that.columnOption(id);\n\n          if (column && column.index >= 0) {\n            convertOwnerBandToColumnReference(that._columns);\n\n            that._columns.splice(column.index, 1);\n\n            if (column.isBand) {\n              var childIndexes = that.getChildrenByBandColumn(column.index).map(function (column) {\n                return column.index;\n              });\n              that._columns = that._columns.filter(function (column) {\n                return childIndexes.indexOf(column.index) < 0;\n              });\n            }\n\n            updateIndexes(that);\n            that.updateColumns(that._dataSource);\n          }\n        },\n        addCommandColumn: function (options) {\n          var commandColumn = this._commandColumns.filter(function (column) {\n            return column.command === options.command;\n          })[0];\n\n          if (!commandColumn) {\n            commandColumn = options;\n\n            this._commandColumns.push(commandColumn);\n          }\n        },\n        getUserState: function () {\n          var columns = this._columns;\n          var result = [];\n          var i;\n\n          function handleStateField(index, value) {\n            if (void 0 !== columns[i][value]) {\n              result[i][value] = columns[i][value];\n            }\n          }\n\n          for (i = 0; i < columns.length; i++) {\n            result[i] = {};\n            (0, _iterator.each)(USER_STATE_FIELD_NAMES, handleStateField);\n          }\n\n          return result;\n        },\n        setName: function (column) {\n          var dataField = column.dataField;\n\n          if (!(0, _type.isDefined)(column.name) && (0, _type.isDefined)(dataField)) {\n            column.name = dataField;\n          }\n        },\n        setUserState: function (state) {\n          var that = this;\n          var dataSource = that._dataSource;\n          var ignoreColumnOptionNames = that.option(\"stateStoring.ignoreColumnOptionNames\");\n          null === state || void 0 === state ? void 0 : state.forEach(this.setName);\n\n          if (!ignoreColumnOptionNames) {\n            ignoreColumnOptionNames = [];\n            var commonColumnSettings = that.getCommonSettings();\n\n            if (!that.option(\"columnChooser.enabled\")) {\n              ignoreColumnOptionNames.push(\"visible\");\n            }\n\n            if (\"none\" === that.option(\"sorting.mode\")) {\n              ignoreColumnOptionNames.push(\"sortIndex\", \"sortOrder\");\n            }\n\n            if (!commonColumnSettings.allowGrouping) {\n              ignoreColumnOptionNames.push(\"groupIndex\");\n            }\n\n            if (!commonColumnSettings.allowFixing) {\n              ignoreColumnOptionNames.push(\"fixed\", \"fixedPosition\");\n            }\n\n            if (!commonColumnSettings.allowResizing) {\n              ignoreColumnOptionNames.push(\"width\", \"visibleWidth\");\n            }\n\n            var isFilterPanelHidden = !that.option(\"filterPanel.visible\");\n\n            if (!that.option(\"filterRow.visible\") && isFilterPanelHidden) {\n              ignoreColumnOptionNames.push(\"filterValue\", \"selectedFilterOperation\");\n            }\n\n            if (!that.option(\"headerFilter.visible\") && isFilterPanelHidden) {\n              ignoreColumnOptionNames.push(\"filterValues\", \"filterType\");\n            }\n          }\n\n          that._columnsUserState = state;\n          that._ignoreColumnOptionNames = ignoreColumnOptionNames;\n          that._hasUserState = !!state;\n          updateColumnChanges(that, \"filtering\");\n          that.init();\n\n          if (dataSource) {\n            dataSource.sort(that.getSortDataSourceParameters());\n            dataSource.group(that.getGroupDataSourceParameters());\n          }\n        },\n        _checkColumns: function () {\n          var usedNames = {};\n          var hasEditableColumnWithoutName = false;\n          var duplicatedNames = [];\n\n          this._columns.forEach(function (column) {\n            var _column$columns;\n\n            var name = column.name;\n            var isBand = null === (_column$columns = column.columns) || void 0 === _column$columns ? void 0 : _column$columns.length;\n            var isEditable = column.allowEditing && (column.dataField || column.setCellValue) && !isBand;\n\n            if (name) {\n              if (usedNames[name]) {\n                duplicatedNames.push('\"'.concat(name, '\"'));\n              }\n\n              usedNames[name] = true;\n            } else {\n              if (isEditable) {\n                hasEditableColumnWithoutName = true;\n              }\n            }\n          });\n\n          if (duplicatedNames.length) {\n            _ui.default.log(\"E1059\", duplicatedNames.join(\", \"));\n          }\n\n          if (hasEditableColumnWithoutName) {\n            _ui.default.log(\"E1060\");\n          }\n        },\n        _createCalculatedColumnOptions: function (columnOptions, bandColumn) {\n          var calculatedColumnOptions = {};\n          var dataField = columnOptions.dataField;\n\n          if (Array.isArray(columnOptions.columns) && columnOptions.columns.length || columnOptions.isBand) {\n            calculatedColumnOptions.isBand = true;\n            dataField = null;\n          }\n\n          if (dataField) {\n            if ((0, _type.isString)(dataField)) {\n              var getter = (0, _data.compileGetter)(dataField);\n              calculatedColumnOptions = {\n                caption: (0, _inflector.captionize)(dataField),\n                calculateCellValue: function (data, skipDeserialization) {\n                  var value = getter(data);\n                  return this.deserializeValue && !skipDeserialization ? this.deserializeValue(value) : value;\n                },\n                setCellValue: defaultSetCellValue,\n                parseValue: function (text) {\n                  var column = this;\n                  var result;\n                  var parsedValue;\n\n                  if (\"number\" === column.dataType) {\n                    if ((0, _type.isString)(text) && column.format) {\n                      parsedValue = _number.default.parse(text);\n\n                      if ((0, _type.isNumeric)(parsedValue)) {\n                        result = parsedValue;\n                      }\n                    } else {\n                      if ((0, _type.isDefined)(text) && (0, _type.isNumeric)(text)) {\n                        result = Number(text);\n                      }\n                    }\n                  } else {\n                    if (\"boolean\" === column.dataType) {\n                      if (text === column.trueText) {\n                        result = true;\n                      } else {\n                        if (text === column.falseText) {\n                          result = false;\n                        }\n                      }\n                    } else {\n                      if (_uiGrid_core2.default.isDateType(column.dataType)) {\n                        parsedValue = _date.default.parse(text, column.format);\n\n                        if (parsedValue) {\n                          result = parsedValue;\n                        }\n                      } else {\n                        result = text;\n                      }\n                    }\n                  }\n\n                  return result;\n                }\n              };\n            }\n\n            calculatedColumnOptions.allowFiltering = true;\n          } else {\n            calculatedColumnOptions.allowFiltering = !!columnOptions.calculateFilterExpression;\n          }\n\n          calculatedColumnOptions.calculateFilterExpression = function () {\n            return _filtering.default.defaultCalculateFilterExpression.apply(this, arguments);\n          };\n\n          calculatedColumnOptions.createFilterExpression = function (filterValue) {\n            var result;\n\n            if (this.calculateFilterExpression) {\n              result = this.calculateFilterExpression.apply(this, arguments);\n            }\n\n            if ((0, _type.isFunction)(result)) {\n              result = [result, \"=\", true];\n            }\n\n            if (result) {\n              result.columnIndex = this.index;\n              result.filterValue = filterValue;\n            }\n\n            return result;\n          };\n\n          if (!dataField || !(0, _type.isString)(dataField)) {\n            (0, _extend.extend)(true, calculatedColumnOptions, {\n              allowSorting: false,\n              allowGrouping: false,\n              calculateCellValue: function () {\n                return null;\n              }\n            });\n          }\n\n          if (bandColumn) {\n            calculatedColumnOptions.allowFixing = false;\n          }\n\n          if (columnOptions.dataType) {\n            calculatedColumnOptions.userDataType = columnOptions.dataType;\n          }\n\n          if (columnOptions.selectedFilterOperation && !(\"defaultSelectedFilterOperation\" in calculatedColumnOptions)) {\n            calculatedColumnOptions.defaultSelectedFilterOperation = columnOptions.selectedFilterOperation;\n          }\n\n          if (columnOptions.lookup) {\n            calculatedColumnOptions.lookup = {\n              calculateCellValue: function (value, skipDeserialization) {\n                if (this.valueExpr) {\n                  value = this.valueMap && this.valueMap[value];\n                }\n\n                return this.deserializeValue && !skipDeserialization ? this.deserializeValue(value) : value;\n              },\n              updateValueMap: function () {\n                this.valueMap = {};\n\n                if (this.items) {\n                  var calculateValue = (0, _data.compileGetter)(this.valueExpr);\n                  var calculateDisplayValue = (0, _data.compileGetter)(this.displayExpr);\n\n                  for (var i = 0; i < this.items.length; i++) {\n                    var item = this.items[i];\n                    var displayValue = calculateDisplayValue(item);\n                    this.valueMap[calculateValue(item)] = displayValue;\n                    this.dataType = this.dataType || getValueDataType(displayValue);\n                  }\n                }\n              },\n              update: function () {\n                var that = this;\n                var dataSource = that.dataSource;\n\n                if (dataSource) {\n                  if ((0, _type.isFunction)(dataSource) && !_variable_wrapper.default.isWrapped(dataSource)) {\n                    dataSource = dataSource({});\n                  }\n\n                  if ((0, _type.isPlainObject)(dataSource) || dataSource instanceof _abstract_store.default || Array.isArray(dataSource)) {\n                    if (that.valueExpr) {\n                      var dataSourceOptions = (0, _utils.normalizeDataSourceOptions)(dataSource);\n                      dataSourceOptions.paginate = false;\n                      dataSource = new _data_source.DataSource(dataSourceOptions);\n                      return dataSource.load().done(function (data) {\n                        that.items = data;\n                        that.updateValueMap && that.updateValueMap();\n                      });\n                    }\n                  } else {\n                    _ui.default.log(\"E1016\");\n                  }\n                } else {\n                  that.updateValueMap && that.updateValueMap();\n                }\n              }\n            };\n          }\n\n          calculatedColumnOptions.resizedCallbacks = (0, _callbacks.default)();\n\n          if (columnOptions.resized) {\n            calculatedColumnOptions.resizedCallbacks.add(columnOptions.resized.bind(columnOptions));\n          }\n\n          (0, _iterator.each)(calculatedColumnOptions, function (optionName) {\n            if ((0, _type.isFunction)(calculatedColumnOptions[optionName]) && 0 !== optionName.indexOf(\"default\")) {\n              var defaultOptionName = \"default\" + optionName.charAt(0).toUpperCase() + optionName.substr(1);\n              calculatedColumnOptions[defaultOptionName] = calculatedColumnOptions[optionName];\n            }\n          });\n          return calculatedColumnOptions;\n        },\n        getRowCount: function () {\n          this._rowCount = this._rowCount || _getRowCount(this);\n          return this._rowCount;\n        },\n        getRowIndex: function (columnIndex, alwaysGetRowIndex) {\n          var column = this._columns[columnIndex];\n          var bandColumnsCache = this.getBandColumnsCache();\n          return column && (alwaysGetRowIndex || column.visible && !(column.command || (0, _type.isDefined)(column.groupIndex))) ? getParentBandColumns(columnIndex, bandColumnsCache.columnParentByIndex).length : 0;\n        },\n        getChildrenByBandColumn: function (bandColumnIndex, onlyVisibleDirectChildren) {\n          var that = this;\n          var bandColumnsCache = that.getBandColumnsCache();\n\n          var result = _getChildrenByBandColumn(bandColumnIndex, bandColumnsCache.columnChildrenByIndex, !onlyVisibleDirectChildren);\n\n          if (onlyVisibleDirectChildren) {\n            return result.filter(function (column) {\n              return column.visible && !column.command;\n            }).sort(function (column1, column2) {\n              return column1.visibleIndex - column2.visibleIndex;\n            });\n          }\n\n          return result;\n        },\n        isParentBandColumn: function (columnIndex, bandColumnIndex) {\n          var result = false;\n          var column = this._columns[columnIndex];\n          var bandColumnsCache = this.getBandColumnsCache();\n          var parentBandColumns = column && getParentBandColumns(columnIndex, bandColumnsCache.columnParentByIndex);\n\n          if (parentBandColumns) {\n            (0, _iterator.each)(parentBandColumns, function (_, bandColumn) {\n              if (bandColumn.index === bandColumnIndex) {\n                result = true;\n                return false;\n              }\n            });\n          }\n\n          return result;\n        },\n        isParentColumnVisible: function (columnIndex) {\n          var result = true;\n          var bandColumnsCache = this.getBandColumnsCache();\n          var bandColumns = columnIndex >= 0 && getParentBandColumns(columnIndex, bandColumnsCache.columnParentByIndex);\n          bandColumns && (0, _iterator.each)(bandColumns, function (_, bandColumn) {\n            result = result && bandColumn.visible;\n            return result;\n          });\n          return result;\n        },\n        getColumnId: function (column) {\n          if (column.command && column.type === GROUP_COMMAND_COLUMN_NAME) {\n            if (isCustomCommandColumn(this, column)) {\n              return \"type:\" + column.type;\n            }\n\n            return \"command:\" + column.command;\n          }\n\n          return column.index;\n        },\n        getCustomizeTextByDataType: getCustomizeTextByDataType,\n        getHeaderContentAlignment: function (columnAlignment) {\n          var rtlEnabled = this.option(\"rtlEnabled\");\n\n          if (rtlEnabled) {\n            return \"left\" === columnAlignment ? \"right\" : \"left\";\n          }\n\n          return columnAlignment;\n        }\n      };\n    }())\n  }\n};\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["C:/Users/CapiniaC/Desktop/Collection/Work/project/security/node_modules/devextreme/ui/grid_core/ui.grid_core.columns_controller.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_callbacks","_variable_wrapper","_data","_common","_type","_iterator","_position","_extend","_array","_config","_object","_ui","_uiGrid_core","_uiGrid_core2","_inflector","_date_serialization","_number","_date","_message","_deferred","_abstract_store","_data_source","_utils","_filtering","obj","__esModule","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","configurable","writable","USER_STATE_FIELD_NAMES_15_1","USER_STATE_FIELD_NAMES","concat","IGNORE_COLUMN_OPTION_NAMES","visibleWidth","bestFitWidth","bufferedFilterValue","COMMAND_EXPAND_CLASS","MAX_SAFE_INTEGER","Number","GROUP_COMMAND_COLUMN_NAME","regExp","globalColumnId","_default","defaultOptions","commonColumnSettings","allowFiltering","allowHiding","allowSorting","allowEditing","encodeHtml","trueText","format","falseText","allowColumnReordering","allowColumnResizing","columnResizingMode","columnMinWidth","columnWidth","adaptColumnWidthByRatio","columns","regenerateColumnsByVisibleItems","customizeColumns","dateSerializationFormat","controllers","Controller","inherit","DEFAULT_COLUMN_OPTIONS","visible","showInColumnChooser","DATATYPE_OPERATIONS","number","string","date","datetime","COLUMN_INDEX_OPTIONS","visibleIndex","groupIndex","grouped","sortIndex","sortOrder","GROUP_LOCATION","COLUMN_CHOOSER_LOCATION","setFilterOperationsAsDefaultValues","column","filterOperations","defaultFilterOperations","createColumn","that","columnOptions","userStateColumnOptions","bandColumn","commonColumnOptions","isString","dataField","setName","result","command","deepExtendArraySafe","getCommonSettings","name","extend","calculatedColumnOptions","_createCalculatedColumnOptions","type","headerId","selector","createColumnsFromOptions","columnsOptions","each","index","_columnsUserState","checkUserStateColumn","ownerBand","hasColumns","getParentBandColumns","columnIndex","columnParentByIndex","parent","unshift","_getChildrenByBandColumn","columnChildrenByIndex","recursive","children","isDefined","showWhenGrouped","isBand","getColumnByIndexes","columnIndexes","bandColumnsCache","getBandColumnsCache","callbackFilter","isPlain","_columns","getColumnFullPath","item","indexOf","join","calculateColspan","columnID","colspan","getChildrenByBandColumn","_","processBandColumns","rowspan","getRowCount","getValueDataType","dataType","getSerializationFormat","getDateSerializationFormat","isNumeric","updateSerializers","options","deserializeValue","isDateType","deserializeDate","serializeValue","serializeDate","serializationFormat","parsedValue","parseFloat","isNaN","toString","getAlignmentByDataType","isRTL","getDefaultAlignment","customizeTextForBooleanDataType","e","valueText","getCustomizeTextByDataType","createColumnsFromDataSource","dataSource","firstItems","_getFirstItems","fieldName","processedFields","isFunction","isWrapped","updateColumnIndexes","isObject","_commandColumns","updateColumnGroupIndexes","currentColumn","normalizeIndexes","updateColumnSortIndexes","isSortOrderValid","updateColumnVisibleIndexes","bandColumns","parentBandColumns","bandColumnIndex","getColumnIndexByVisibleIndex","location","rowIndex","getGroupColumns","getChooserColumns","getVisibleColumns","col","moveColumnToGroup","groupColumns","Math","max","userStateColumn","applyUserState","columnsUserState","ignoreColumnOptionNames","_ignoreColumnOptionNames","columnCountById","resultColumns","allColumnsHaveState","userStateColumnIndexes","userStateColumnIndex","applyFieldsState","inArray","defaultSelectedFilterOperation","findUserStateColumn","id","count","j","_hasUserState","initialIndex","hasAddedBands","columnUserState","added","assignColumns","updateIndexes","resetBandColumnsCache","resetColumnsCache","updateColumnDataTypes","updateColumnChanges","changeType","optionName","columnChanges","_columnChanges","optionNames","changeTypes","split","fireColumnsChanged","onColumnsChanging","option","reinitOptionNames","needReinit","some","isInitialized","_updateLockCount","component","reinit","columnsChanged","fire","updateSortOrderWhenGrouping","prevGroupIndex","columnWasGrouped","lastSortOrder","sortMode","sortedByAnotherColumn","fireOptionChanged","prevValue","fullOptionName","fullOptionPath","_skipProcessingColumnsChange","_notifyOptionChanged","columnOptionCore","notFireEvent","optionGetter","compileGetter","initialColumn","functionsAsIs","optionSetter","compileSetter","_checkColumns","getColumnByPath","addExpandColumn","_getExpandColumnOptions","addCommandColumn","defaultSetCellValue","data","path","dotCount","getDataColumns","bandColumnID","_getRowCount","rowCount","parents","invisibleParents","isCustomCommandColumn","commandColumn","getFixedPosition","rtlEnabled","fixedPosition","processExpandColumns","expandColumns","customColumnIndex","expandColumnsByType","map","expandColumn","splice","digitsCount","numberToString","str","mergeColumns","commandColumns","needToExtend","commandColumnIndex","slice","isColumnFixing","_isColumnFixing","defaultCommandColumns","fixed","getCommandColumnIndex","reduce","columnType","allowFixing","allowReordering","isColumnFixed","convertOwnerBandToColumnReference","_bandColumnsCache","findColumn","identifier","identifierOptionName","substr","width","cssClass","allowGrouping","allowResizing","groupsCount","items","getFirstItemsCore","childItems","collapsedItems","normalizeSortingInfo","group","_endUpdateCore","init","_isColumnsFromOptions","_dataSourceApplied","applyDataSource","_dataSource","callbackNames","replace","parseInt","optionChanged","args","needUpdateRequireResize","handled","previousValue","Array","isArray","fullName","_columnOptionChanged","_updateRequireResize","_args$fullName","_args$fullName2","_args$fullName3","_args$fullName4","_args$fullName5","isEditingPopup","isEditingForm","isEditRowKey","isEditColumnName","isChanges","callBase","columnOptionValue","columnOptionName","columnOption","_requireResize","publicMethods","forceApplying","isDataSourceLoaded","isLoaded","_dataSourceColumnsCount","columnsFromDataSource","updateColumns","isAllDataTypesDefined","Deferred","reject","promise","reset","_visibleColumns","_fixedColumns","_rowCount","getUserState","isDataSourceApplied","groupingOptions","groupPanelOptions","minWidth","autoExpandGroup","autoExpandAll","allowCollapsing","allowColumnDragging","contextMenuEnabled","isColumnOptionUsed","checkSerializers","calculateCellValue","defaultCalculateCellValue","getColumns","isBandColumnsUsed","_getVisibleColumnsCore","getFixedColumns","_getFixedColumnsCore","getFilteringColumns","allowHeaderFiltering","field","getColumnIndexOffset","transparentColumn","transparentColspan","notFixedColumnCount","transparentColumnIndex","lastFixedPosition","visibleColumns","prevColumn","newColumn","_getExpandColumnsCore","getExpandColumns","firstGroupColumn","isFixedFirstGroupColumn","cellTemplate","headerCellTemplate","parentIndex","_isColumnVisible","isParentColumnVisible","rowspanGroupColumns","rowspanExpandColumns","positiveIndexedColumns","negativeIndexedColumns","notGroupedColumnsCount","isFixedToEnd","columnDigitsCount","indexedColumns","orderEach","firstPositiveIndexColumn","columnsByFixing","columnsByVisibleIndex","call","getInvisibleColumns","hiddenColumnsByBand","getAllColumns","grep","allowMoveColumn","fromVisibleIndex","toVisibleIndex","sourceLocation","targetLocation","sourceColumn","moveColumn","fromIndex","toIndex","targetGroupIndex","targetColumn","isVisible","changeSortOrder","sortingOptions","sortingMode","mode","needResetSorting","nextSortOrder","getSortDataSourceParameters","useLocalSelector","sortColumns","sort","sortItem","calculateSortValue","displayField","calculateDisplayValue","desc","sortingMethod","compare","bind","getGroupDataSourceParameters","calculateGroupValue","groupItem","isExpanded","refresh","updateNewLookupsOnly","deferreds","lookup","valueMap","update","when","done","_updateColumnOptions","calculateCallbackName","calculateCallback","originalCallback","displayValueMap","alignment","getFormatByDataType","customizeText","defaultFilterOperation","showEditorAlways","isColumnDataTypesUpdated","lookupDataType","valueDataType","getDisplayValue","_customizeColumns","hasOwnerBand","_this","updateSortingGrouping","sortParameters","groupParameters","filterParameters","lastLoadOptions","always","_updateChanges","sorting","grouping","filtering","parameters","equalSortParameters","dataController","getController","equalFilterParameters","getCombinedFilter","fromDataSource","isColumnsChanged","updateSortGroupParameterIndexes","indexParameterName","columnsGroupParameters","columnsSortParameters","updateFilter","remoteFiltering","filterValue","forceIsoDateParsing","columnCount","clearSorting","beginUpdate","endUpdate","clearGrouping","getVisibleIndex","getVisibleColumnIndex","addColumn","deleteColumn","childIndexes","handleStateField","setUserState","state","isFilterPanelHidden","usedNames","hasEditableColumnWithoutName","duplicatedNames","_column$columns","isEditable","setCellValue","log","getter","caption","captionize","skipDeserialization","parseValue","text","parse","calculateFilterExpression","defaultCalculateFilterExpression","createFilterExpression","userDataType","selectedFilterOperation","valueExpr","updateValueMap","calculateValue","displayExpr","displayValue","isPlainObject","dataSourceOptions","normalizeDataSourceOptions","paginate","DataSource","load","resizedCallbacks","resized","add","defaultOptionName","charAt","toUpperCase","getRowIndex","alwaysGetRowIndex","onlyVisibleDirectChildren","column1","column2","isParentBandColumn","getColumnId","getHeaderContentAlignment","columnAlignment","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.columns_controller.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _callbacks = _interopRequireDefault(require(\"../../core/utils/callbacks\"));\r\nvar _variable_wrapper = _interopRequireDefault(require(\"../../core/utils/variable_wrapper\"));\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _position = require(\"../../core/utils/position\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _config = _interopRequireDefault(require(\"../../core/config\"));\r\nvar _object = require(\"../../core/utils/object\");\r\nvar _ui = _interopRequireDefault(require(\"../widget/ui.errors\"));\r\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.modules\"));\r\nvar _uiGrid_core2 = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\r\nvar _inflector = require(\"../../core/utils/inflector\");\r\nvar _date_serialization = _interopRequireDefault(require(\"../../core/utils/date_serialization\"));\r\nvar _number = _interopRequireDefault(require(\"../../localization/number\"));\r\nvar _date = _interopRequireDefault(require(\"../../localization/date\"));\r\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _abstract_store = _interopRequireDefault(require(\"../../data/abstract_store\"));\r\nvar _data_source = require(\"../../data/data_source/data_source\");\r\nvar _utils = require(\"../../data/data_source/utils\");\r\nvar _filtering = _interopRequireDefault(require(\"../shared/filtering\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction ownKeys(object, enumerableOnly) {\r\n    var keys = Object.keys(object);\r\n    if (Object.getOwnPropertySymbols) {\r\n        var symbols = Object.getOwnPropertySymbols(object);\r\n        if (enumerableOnly) {\r\n            symbols = symbols.filter(function(sym) {\r\n                return Object.getOwnPropertyDescriptor(object, sym).enumerable\r\n            })\r\n        }\r\n        keys.push.apply(keys, symbols)\r\n    }\r\n    return keys\r\n}\r\n\r\nfunction _objectSpread(target) {\r\n    for (var i = 1; i < arguments.length; i++) {\r\n        var source = null != arguments[i] ? arguments[i] : {};\r\n        if (i % 2) {\r\n            ownKeys(Object(source), true).forEach(function(key) {\r\n                _defineProperty(target, key, source[key])\r\n            })\r\n        } else {\r\n            if (Object.getOwnPropertyDescriptors) {\r\n                Object.defineProperties(target, Object.getOwnPropertyDescriptors(source))\r\n            } else {\r\n                ownKeys(Object(source)).forEach(function(key) {\r\n                    Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key))\r\n                })\r\n            }\r\n        }\r\n    }\r\n    return target\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n    if (key in obj) {\r\n        Object.defineProperty(obj, key, {\r\n            value: value,\r\n            enumerable: true,\r\n            configurable: true,\r\n            writable: true\r\n        })\r\n    } else {\r\n        obj[key] = value\r\n    }\r\n    return obj\r\n}\r\nvar USER_STATE_FIELD_NAMES_15_1 = [\"filterValues\", \"filterType\", \"fixed\", \"fixedPosition\"];\r\nvar USER_STATE_FIELD_NAMES = [\"visibleIndex\", \"dataField\", \"name\", \"dataType\", \"width\", \"visible\", \"sortOrder\", \"lastSortOrder\", \"sortIndex\", \"groupIndex\", \"filterValue\", \"selectedFilterOperation\", \"added\"].concat(USER_STATE_FIELD_NAMES_15_1);\r\nvar IGNORE_COLUMN_OPTION_NAMES = {\r\n    visibleWidth: true,\r\n    bestFitWidth: true,\r\n    bufferedFilterValue: true\r\n};\r\nvar COMMAND_EXPAND_CLASS = \"dx-command-expand\";\r\nvar MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER || 9007199254740991;\r\nvar GROUP_COMMAND_COLUMN_NAME = \"groupExpand\";\r\nvar regExp = /columns\\[(\\d+)\\]\\.?/gi;\r\nvar globalColumnId = 1;\r\nvar _default = {\r\n    defaultOptions: function() {\r\n        return {\r\n            commonColumnSettings: {\r\n                allowFiltering: true,\r\n                allowHiding: true,\r\n                allowSorting: true,\r\n                allowEditing: true,\r\n                encodeHtml: true,\r\n                trueText: _message.default.format(\"dxDataGrid-trueText\"),\r\n                falseText: _message.default.format(\"dxDataGrid-falseText\")\r\n            },\r\n            allowColumnReordering: false,\r\n            allowColumnResizing: false,\r\n            columnResizingMode: \"nextColumn\",\r\n            columnMinWidth: void 0,\r\n            columnWidth: void 0,\r\n            adaptColumnWidthByRatio: true,\r\n            columns: void 0,\r\n            regenerateColumnsByVisibleItems: false,\r\n            customizeColumns: null,\r\n            dateSerializationFormat: void 0\r\n        }\r\n    },\r\n    controllers: {\r\n        columns: _uiGrid_core.default.Controller.inherit(function() {\r\n            var DEFAULT_COLUMN_OPTIONS = {\r\n                visible: true,\r\n                showInColumnChooser: true\r\n            };\r\n            var DATATYPE_OPERATIONS = {\r\n                number: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"between\"],\r\n                string: [\"contains\", \"notcontains\", \"startswith\", \"endswith\", \"=\", \"<>\"],\r\n                date: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"between\"],\r\n                datetime: [\"=\", \"<>\", \"<\", \">\", \"<=\", \">=\", \"between\"]\r\n            };\r\n            var COLUMN_INDEX_OPTIONS = {\r\n                visibleIndex: true,\r\n                groupIndex: true,\r\n                grouped: true,\r\n                sortIndex: true,\r\n                sortOrder: true\r\n            };\r\n            var GROUP_LOCATION = \"group\";\r\n            var COLUMN_CHOOSER_LOCATION = \"columnChooser\";\r\n            var setFilterOperationsAsDefaultValues = function(column) {\r\n                column.filterOperations = column.defaultFilterOperations\r\n            };\r\n            var createColumn = function(that, columnOptions, userStateColumnOptions, bandColumn) {\r\n                var commonColumnOptions = {};\r\n                if (columnOptions) {\r\n                    if ((0, _type.isString)(columnOptions)) {\r\n                        columnOptions = {\r\n                            dataField: columnOptions\r\n                        }\r\n                    }\r\n                    that.setName(columnOptions);\r\n                    var result = {};\r\n                    if (columnOptions.command) {\r\n                        result = (0, _object.deepExtendArraySafe)(commonColumnOptions, columnOptions)\r\n                    } else {\r\n                        commonColumnOptions = that.getCommonSettings(columnOptions);\r\n                        if (userStateColumnOptions && userStateColumnOptions.name && userStateColumnOptions.dataField) {\r\n                            columnOptions = (0, _extend.extend)({}, columnOptions, {\r\n                                dataField: userStateColumnOptions.dataField\r\n                            })\r\n                        }\r\n                        var calculatedColumnOptions = that._createCalculatedColumnOptions(columnOptions, bandColumn);\r\n                        if (!columnOptions.type) {\r\n                            result = {\r\n                                headerId: \"dx-col-\".concat(globalColumnId++)\r\n                            }\r\n                        }\r\n                        result = (0, _object.deepExtendArraySafe)(result, DEFAULT_COLUMN_OPTIONS);\r\n                        (0, _object.deepExtendArraySafe)(result, commonColumnOptions);\r\n                        (0, _object.deepExtendArraySafe)(result, calculatedColumnOptions);\r\n                        (0, _object.deepExtendArraySafe)(result, columnOptions);\r\n                        (0, _object.deepExtendArraySafe)(result, {\r\n                            selector: null\r\n                        })\r\n                    }\r\n                    if (columnOptions.filterOperations === columnOptions.defaultFilterOperations) {\r\n                        setFilterOperationsAsDefaultValues(result)\r\n                    }\r\n                    return result\r\n                }\r\n            };\r\n            var createColumnsFromOptions = function createColumnsFromOptions(that, columnsOptions, bandColumn) {\r\n                var result = [];\r\n                if (columnsOptions) {\r\n                    (0, _iterator.each)(columnsOptions, function(index, columnOptions) {\r\n                        var userStateColumnOptions = that._columnsUserState && checkUserStateColumn(columnOptions, that._columnsUserState[index]) && that._columnsUserState[index];\r\n                        var column = createColumn(that, columnOptions, userStateColumnOptions, bandColumn);\r\n                        if (column) {\r\n                            if (bandColumn) {\r\n                                column.ownerBand = bandColumn\r\n                            }\r\n                            result.push(column);\r\n                            if (column.columns) {\r\n                                result = result.concat(createColumnsFromOptions(that, column.columns, column));\r\n                                delete column.columns;\r\n                                column.hasColumns = true\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n                return result\r\n            };\r\n            var getParentBandColumns = function(columnIndex, columnParentByIndex) {\r\n                var result = [];\r\n                var parent = columnParentByIndex[columnIndex];\r\n                while (parent) {\r\n                    result.unshift(parent);\r\n                    columnIndex = parent.index;\r\n                    parent = columnParentByIndex[columnIndex]\r\n                }\r\n                return result\r\n            };\r\n            var _getChildrenByBandColumn = function(columnIndex, columnChildrenByIndex, recursive) {\r\n                var result = [];\r\n                var children = columnChildrenByIndex[columnIndex];\r\n                if (children) {\r\n                    for (var i = 0; i < children.length; i++) {\r\n                        var column = children[i];\r\n                        if (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped) {\r\n                            result.push(column);\r\n                            if (recursive && column.isBand) {\r\n                                result = result.concat(_getChildrenByBandColumn(column.index, columnChildrenByIndex, recursive))\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return result\r\n            };\r\n            var getColumnByIndexes = function(that, columnIndexes) {\r\n                var result;\r\n                var columns;\r\n                var bandColumnsCache = that.getBandColumnsCache();\r\n                var callbackFilter = function(column) {\r\n                    var ownerBand = result ? result.index : void 0;\r\n                    return column.ownerBand === ownerBand\r\n                };\r\n                if (bandColumnsCache.isPlain) {\r\n                    result = that._columns[columnIndexes[0]]\r\n                } else {\r\n                    columns = that._columns.filter(callbackFilter);\r\n                    for (var i = 0; i < columnIndexes.length; i++) {\r\n                        result = columns[columnIndexes[i]];\r\n                        if (result) {\r\n                            columns = that._columns.filter(callbackFilter)\r\n                        }\r\n                    }\r\n                }\r\n                return result\r\n            };\r\n            var getColumnFullPath = function(that, column) {\r\n                var result = [];\r\n                var columns;\r\n                var bandColumnsCache = that.getBandColumnsCache();\r\n                var callbackFilter = function(item) {\r\n                    return item.ownerBand === column.ownerBand\r\n                };\r\n                if (bandColumnsCache.isPlain) {\r\n                    var columnIndex = that._columns.indexOf(column);\r\n                    if (columnIndex >= 0) {\r\n                        result = [\"columns[\".concat(columnIndex, \"]\")]\r\n                    }\r\n                } else {\r\n                    columns = that._columns.filter(callbackFilter);\r\n                    while (columns.length && columns.indexOf(column) !== -1) {\r\n                        result.unshift(\"columns[\".concat(columns.indexOf(column), \"]\"));\r\n                        column = bandColumnsCache.columnParentByIndex[column.index];\r\n                        columns = column ? that._columns.filter(callbackFilter) : []\r\n                    }\r\n                }\r\n                return result.join(\".\")\r\n            };\r\n            var calculateColspan = function calculateColspan(that, columnID) {\r\n                var colspan = 0;\r\n                var columns = that.getChildrenByBandColumn(columnID, true);\r\n                (0, _iterator.each)(columns, function(_, column) {\r\n                    if (column.isBand) {\r\n                        column.colspan = column.colspan || calculateColspan(that, column.index);\r\n                        colspan += column.colspan || 1\r\n                    } else {\r\n                        colspan += 1\r\n                    }\r\n                });\r\n                return colspan\r\n            };\r\n            var processBandColumns = function(that, columns, bandColumnsCache) {\r\n                var rowspan;\r\n                for (var i = 0; i < columns.length; i++) {\r\n                    var column = columns[i];\r\n                    if (column.visible || column.command) {\r\n                        if (column.isBand) {\r\n                            column.colspan = column.colspan || calculateColspan(that, column.index)\r\n                        }\r\n                        if (!column.isBand || !column.colspan) {\r\n                            rowspan = that.getRowCount();\r\n                            if (!column.command && (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped)) {\r\n                                rowspan -= getParentBandColumns(column.index, bandColumnsCache.columnParentByIndex).length\r\n                            }\r\n                            if (rowspan > 1) {\r\n                                column.rowspan = rowspan\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            var getValueDataType = function(value) {\r\n                var dataType = (0, _type.type)(value);\r\n                if (\"string\" !== dataType && \"boolean\" !== dataType && \"number\" !== dataType && \"date\" !== dataType && \"object\" !== dataType) {\r\n                    dataType = void 0\r\n                }\r\n                return dataType\r\n            };\r\n            var getSerializationFormat = function(dataType, value) {\r\n                switch (dataType) {\r\n                    case \"date\":\r\n                    case \"datetime\":\r\n                        return _date_serialization.default.getDateSerializationFormat(value);\r\n                    case \"number\":\r\n                        if ((0, _type.isString)(value)) {\r\n                            return \"string\"\r\n                        }\r\n                        if ((0, _type.isNumeric)(value)) {\r\n                            return null\r\n                        }\r\n                }\r\n            };\r\n            var updateSerializers = function(options, dataType) {\r\n                if (!options.deserializeValue) {\r\n                    if (_uiGrid_core2.default.isDateType(dataType)) {\r\n                        options.deserializeValue = function(value) {\r\n                            return _date_serialization.default.deserializeDate(value)\r\n                        };\r\n                        options.serializeValue = function(value) {\r\n                            return (0, _type.isString)(value) ? value : _date_serialization.default.serializeDate(value, this.serializationFormat)\r\n                        }\r\n                    }\r\n                    if (\"number\" === dataType) {\r\n                        options.deserializeValue = function(value) {\r\n                            var parsedValue = parseFloat(value);\r\n                            return isNaN(parsedValue) ? value : parsedValue\r\n                        };\r\n                        options.serializeValue = function(value, target) {\r\n                            if (\"filter\" === target) {\r\n                                return value\r\n                            }\r\n                            return (0, _type.isDefined)(value) && \"string\" === this.serializationFormat ? value.toString() : value\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            var getAlignmentByDataType = function(dataType, isRTL) {\r\n                switch (dataType) {\r\n                    case \"number\":\r\n                        return \"right\";\r\n                    case \"boolean\":\r\n                        return \"center\";\r\n                    default:\r\n                        return (0, _position.getDefaultAlignment)(isRTL)\r\n                }\r\n            };\r\n            var customizeTextForBooleanDataType = function(e) {\r\n                if (true === e.value) {\r\n                    return this.trueText || \"true\"\r\n                } else {\r\n                    if (false === e.value) {\r\n                        return this.falseText || \"false\"\r\n                    } else {\r\n                        return e.valueText || \"\"\r\n                    }\r\n                }\r\n            };\r\n            var getCustomizeTextByDataType = function(dataType) {\r\n                if (\"boolean\" === dataType) {\r\n                    return customizeTextForBooleanDataType\r\n                }\r\n            };\r\n            var createColumnsFromDataSource = function(that, dataSource) {\r\n                var firstItems = that._getFirstItems(dataSource);\r\n                var fieldName;\r\n                var processedFields = {};\r\n                var result = [];\r\n                for (var i = 0; i < firstItems.length; i++) {\r\n                    if (firstItems[i]) {\r\n                        for (fieldName in firstItems[i]) {\r\n                            if (!(0, _type.isFunction)(firstItems[i][fieldName]) || _variable_wrapper.default.isWrapped(firstItems[i][fieldName])) {\r\n                                processedFields[fieldName] = true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                for (fieldName in processedFields) {\r\n                    if (0 !== fieldName.indexOf(\"__\")) {\r\n                        var column = createColumn(that, fieldName);\r\n                        result.push(column)\r\n                    }\r\n                }\r\n                return result\r\n            };\r\n            var updateColumnIndexes = function(that) {\r\n                (0, _iterator.each)(that._columns, function(index, column) {\r\n                    column.index = index\r\n                });\r\n                (0, _iterator.each)(that._columns, function(index, column) {\r\n                    if ((0, _type.isObject)(column.ownerBand)) {\r\n                        column.ownerBand = column.ownerBand.index\r\n                    }\r\n                });\r\n                (0, _iterator.each)(that._commandColumns, function(index, column) {\r\n                    column.index = -(index + 1)\r\n                })\r\n            };\r\n            var updateColumnGroupIndexes = function(that, currentColumn) {\r\n                (0, _array.normalizeIndexes)(that._columns, \"groupIndex\", currentColumn, function(column) {\r\n                    var grouped = column.grouped;\r\n                    delete column.grouped;\r\n                    return grouped\r\n                })\r\n            };\r\n            var updateColumnSortIndexes = function(that, currentColumn) {\r\n                (0, _iterator.each)(that._columns, function(index, column) {\r\n                    if ((0, _type.isDefined)(column.sortIndex) && !isSortOrderValid(column.sortOrder)) {\r\n                        delete column.sortIndex\r\n                    }\r\n                });\r\n                (0, _array.normalizeIndexes)(that._columns, \"sortIndex\", currentColumn, function(column) {\r\n                    return !(0, _type.isDefined)(column.groupIndex) && isSortOrderValid(column.sortOrder)\r\n                })\r\n            };\r\n            var updateColumnVisibleIndexes = function(that, currentColumn) {\r\n                var key;\r\n                var column;\r\n                var bandColumns = {};\r\n                var result = [];\r\n                var bandColumnsCache = that.getBandColumnsCache();\r\n                var columns = that._columns.filter(function(column) {\r\n                    return !column.command\r\n                });\r\n                for (var i = 0; i < columns.length; i++) {\r\n                    column = columns[i];\r\n                    var parentBandColumns = getParentBandColumns(i, bandColumnsCache.columnParentByIndex);\r\n                    if (parentBandColumns.length) {\r\n                        var bandColumnIndex = parentBandColumns[parentBandColumns.length - 1].index;\r\n                        bandColumns[bandColumnIndex] = bandColumns[bandColumnIndex] || [];\r\n                        bandColumns[bandColumnIndex].push(column)\r\n                    } else {\r\n                        result.push(column)\r\n                    }\r\n                }\r\n                for (key in bandColumns) {\r\n                    (0, _array.normalizeIndexes)(bandColumns[key], \"visibleIndex\", currentColumn)\r\n                }(0, _array.normalizeIndexes)(result, \"visibleIndex\", currentColumn)\r\n            };\r\n            var getColumnIndexByVisibleIndex = function(that, visibleIndex, location) {\r\n                var rowIndex = (0, _type.isObject)(visibleIndex) ? visibleIndex.rowIndex : null;\r\n                var columns = location === GROUP_LOCATION ? that.getGroupColumns() : location === COLUMN_CHOOSER_LOCATION ? that.getChooserColumns() : that.getVisibleColumns(rowIndex);\r\n                var column;\r\n                visibleIndex = (0, _type.isObject)(visibleIndex) ? visibleIndex.columnIndex : visibleIndex;\r\n                column = columns[visibleIndex];\r\n                if (column && column.type === GROUP_COMMAND_COLUMN_NAME) {\r\n                    column = that._columns.filter(function(col) {\r\n                        return column.type === col.type\r\n                    })[0] || column\r\n                }\r\n                return column && (0, _type.isDefined)(column.index) ? column.index : -1\r\n            };\r\n            var moveColumnToGroup = function(that, column, groupIndex) {\r\n                var groupColumns = that.getGroupColumns();\r\n                var i;\r\n                if (groupIndex >= 0) {\r\n                    for (i = 0; i < groupColumns.length; i++) {\r\n                        if (groupColumns[i].groupIndex >= groupIndex) {\r\n                            groupColumns[i].groupIndex++\r\n                        }\r\n                    }\r\n                } else {\r\n                    groupIndex = 0;\r\n                    for (i = 0; i < groupColumns.length; i++) {\r\n                        groupIndex = Math.max(groupIndex, groupColumns[i].groupIndex + 1)\r\n                    }\r\n                }\r\n                return groupIndex\r\n            };\r\n\r\n            function checkUserStateColumn(column, userStateColumn) {\r\n                return column && userStateColumn && (userStateColumn.name === column.name || !column.name) && (userStateColumn.dataField === column.dataField || column.name)\r\n            }\r\n            var applyUserState = function(that) {\r\n                var columnsUserState = that._columnsUserState;\r\n                var ignoreColumnOptionNames = that._ignoreColumnOptionNames || [];\r\n                var columns = that._columns;\r\n                var columnCountById = {};\r\n                var resultColumns = [];\r\n                var allColumnsHaveState = true;\r\n                var userStateColumnIndexes = [];\r\n                var column;\r\n                var userStateColumnIndex;\r\n                var i;\r\n\r\n                function applyFieldsState(column, userStateColumn) {\r\n                    if (!userStateColumn) {\r\n                        return\r\n                    }\r\n                    for (var index = 0; index < USER_STATE_FIELD_NAMES.length; index++) {\r\n                        var fieldName = USER_STATE_FIELD_NAMES[index];\r\n                        if ((0, _array.inArray)(fieldName, ignoreColumnOptionNames) >= 0) {\r\n                            continue\r\n                        }\r\n                        if (\"dataType\" === fieldName) {\r\n                            column[fieldName] = column[fieldName] || userStateColumn[fieldName]\r\n                        } else {\r\n                            if ((0, _array.inArray)(fieldName, USER_STATE_FIELD_NAMES_15_1) >= 0) {\r\n                                if (fieldName in userStateColumn) {\r\n                                    column[fieldName] = userStateColumn[fieldName]\r\n                                }\r\n                            } else {\r\n                                if (\"selectedFilterOperation\" === fieldName && userStateColumn[fieldName]) {\r\n                                    column.defaultSelectedFilterOperation = column[fieldName] || null\r\n                                }\r\n                                column[fieldName] = userStateColumn[fieldName]\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                function findUserStateColumn(columnsUserState, column) {\r\n                    var id = column.name || column.dataField;\r\n                    var count = columnCountById[id] || 0;\r\n                    for (var j = 0; j < columnsUserState.length; j++) {\r\n                        if (checkUserStateColumn(column, columnsUserState[j])) {\r\n                            if (count) {\r\n                                count--\r\n                            } else {\r\n                                columnCountById[id] = columnCountById[id] || 0;\r\n                                columnCountById[id]++;\r\n                                return j\r\n                            }\r\n                        }\r\n                    }\r\n                    return -1\r\n                }\r\n                if (columnsUserState) {\r\n                    for (i = 0; i < columns.length; i++) {\r\n                        userStateColumnIndex = findUserStateColumn(columnsUserState, columns[i]);\r\n                        allColumnsHaveState = allColumnsHaveState && userStateColumnIndex >= 0;\r\n                        userStateColumnIndexes.push(userStateColumnIndex)\r\n                    }\r\n                    for (i = 0; i < columns.length; i++) {\r\n                        column = columns[i];\r\n                        userStateColumnIndex = userStateColumnIndexes[i];\r\n                        if (that._hasUserState || allColumnsHaveState) {\r\n                            applyFieldsState(column, columnsUserState[userStateColumnIndex])\r\n                        }\r\n                        if (userStateColumnIndex >= 0 && (0, _type.isDefined)(columnsUserState[userStateColumnIndex].initialIndex)) {\r\n                            resultColumns[userStateColumnIndex] = column\r\n                        } else {\r\n                            resultColumns.push(column)\r\n                        }\r\n                    }\r\n                    var hasAddedBands = false;\r\n                    for (i = 0; i < columnsUserState.length; i++) {\r\n                        var columnUserState = columnsUserState[i];\r\n                        if (columnUserState.added && findUserStateColumn(columns, columnUserState) < 0) {\r\n                            column = createColumn(that, columnUserState.added);\r\n                            applyFieldsState(column, columnUserState);\r\n                            resultColumns.push(column);\r\n                            if (columnUserState.added.columns) {\r\n                                hasAddedBands = true\r\n                            }\r\n                        }\r\n                    }\r\n                    if (hasAddedBands) {\r\n                        updateColumnIndexes(that);\r\n                        resultColumns = createColumnsFromOptions(that, resultColumns)\r\n                    }\r\n                    assignColumns(that, resultColumns)\r\n                }\r\n            };\r\n            var updateIndexes = function(that, column) {\r\n                updateColumnIndexes(that);\r\n                updateColumnGroupIndexes(that, column);\r\n                updateColumnSortIndexes(that, column);\r\n                resetBandColumnsCache(that);\r\n                updateColumnVisibleIndexes(that, column)\r\n            };\r\n            var resetColumnsCache = function(that) {\r\n                that.resetColumnsCache()\r\n            };\r\n\r\n            function assignColumns(that, columns) {\r\n                that._columns = columns;\r\n                resetColumnsCache(that);\r\n                that.updateColumnDataTypes()\r\n            }\r\n            var updateColumnChanges = function(that, changeType, optionName, columnIndex) {\r\n                var columnChanges = that._columnChanges || {\r\n                    optionNames: {\r\n                        length: 0\r\n                    },\r\n                    changeTypes: {\r\n                        length: 0\r\n                    },\r\n                    columnIndex: columnIndex\r\n                };\r\n                optionName = optionName || \"all\";\r\n                optionName = optionName.split(\".\")[0];\r\n                var changeTypes = columnChanges.changeTypes;\r\n                if (changeType && !changeTypes[changeType]) {\r\n                    changeTypes[changeType] = true;\r\n                    changeTypes.length++\r\n                }\r\n                var optionNames = columnChanges.optionNames;\r\n                if (optionName && !optionNames[optionName]) {\r\n                    optionNames[optionName] = true;\r\n                    optionNames.length++\r\n                }\r\n                if (void 0 === columnIndex || columnIndex !== columnChanges.columnIndex) {\r\n                    delete columnChanges.columnIndex\r\n                }\r\n                that._columnChanges = columnChanges;\r\n                resetColumnsCache(that)\r\n            };\r\n            var fireColumnsChanged = function(that) {\r\n                var onColumnsChanging = that.option(\"onColumnsChanging\");\r\n                var columnChanges = that._columnChanges;\r\n                var reinitOptionNames = [\"dataField\", \"lookup\", \"dataType\", \"columns\"];\r\n                var needReinit = function(options) {\r\n                    return options && reinitOptionNames.some(function(name) {\r\n                        return options[name]\r\n                    })\r\n                };\r\n                if (that.isInitialized() && !that._updateLockCount && columnChanges) {\r\n                    if (onColumnsChanging) {\r\n                        that._updateLockCount++;\r\n                        onColumnsChanging((0, _extend.extend)({\r\n                            component: that.component\r\n                        }, columnChanges));\r\n                        that._updateLockCount--\r\n                    }\r\n                    that._columnChanges = void 0;\r\n                    if (needReinit(columnChanges.optionNames)) {\r\n                        that.reinit()\r\n                    } else {\r\n                        that.columnsChanged.fire(columnChanges)\r\n                    }\r\n                }\r\n            };\r\n            var updateSortOrderWhenGrouping = function(that, column, groupIndex, prevGroupIndex) {\r\n                var columnWasGrouped = prevGroupIndex >= 0;\r\n                if (groupIndex >= 0) {\r\n                    if (!columnWasGrouped) {\r\n                        column.lastSortOrder = column.sortOrder\r\n                    }\r\n                } else {\r\n                    var sortMode = that.option(\"sorting.mode\");\r\n                    var sortOrder = column.lastSortOrder;\r\n                    if (\"single\" === sortMode) {\r\n                        var sortedByAnotherColumn = that._columns.some(function(col) {\r\n                            return col !== column && (0, _type.isDefined)(col.sortIndex)\r\n                        });\r\n                        if (sortedByAnotherColumn) {\r\n                            sortOrder = void 0\r\n                        }\r\n                    }\r\n                    column.sortOrder = sortOrder\r\n                }\r\n            };\r\n            var fireOptionChanged = function(that, options) {\r\n                var value = options.value;\r\n                var optionName = options.optionName;\r\n                var prevValue = options.prevValue;\r\n                var fullOptionName = options.fullOptionName;\r\n                var fullOptionPath = \"\".concat(fullOptionName, \".\").concat(optionName);\r\n                if (!IGNORE_COLUMN_OPTION_NAMES[optionName] && that._skipProcessingColumnsChange !== fullOptionPath) {\r\n                    that._skipProcessingColumnsChange = fullOptionPath;\r\n                    that.component._notifyOptionChanged(fullOptionPath, value, prevValue);\r\n                    that._skipProcessingColumnsChange = false\r\n                }\r\n            };\r\n            var columnOptionCore = function(that, column, optionName, value, notFireEvent) {\r\n                var optionGetter = (0, _data.compileGetter)(optionName);\r\n                var columnIndex = column.index;\r\n                var columns;\r\n                var changeType;\r\n                var initialColumn;\r\n                if (3 === arguments.length) {\r\n                    return optionGetter(column, {\r\n                        functionsAsIs: true\r\n                    })\r\n                }\r\n                var prevValue = optionGetter(column, {\r\n                    functionsAsIs: true\r\n                });\r\n                if (prevValue !== value) {\r\n                    if (\"groupIndex\" === optionName || \"calculateGroupValue\" === optionName) {\r\n                        changeType = \"grouping\";\r\n                        updateSortOrderWhenGrouping(that, column, value, prevValue)\r\n                    } else {\r\n                        if (\"sortIndex\" === optionName || \"sortOrder\" === optionName || \"calculateSortValue\" === optionName) {\r\n                            changeType = \"sorting\"\r\n                        } else {\r\n                            changeType = \"columns\"\r\n                        }\r\n                    }\r\n                    var optionSetter = (0, _data.compileSetter)(optionName);\r\n                    optionSetter(column, value, {\r\n                        functionsAsIs: true\r\n                    });\r\n                    var fullOptionName = getColumnFullPath(that, column);\r\n                    if (COLUMN_INDEX_OPTIONS[optionName]) {\r\n                        updateIndexes(that, column);\r\n                        value = optionGetter(column)\r\n                    }\r\n                    if (\"name\" === optionName || \"allowEditing\" === optionName) {\r\n                        that._checkColumns()\r\n                    }\r\n                    fullOptionName && fireOptionChanged(that, {\r\n                        fullOptionName: fullOptionName,\r\n                        optionName: optionName,\r\n                        value: value,\r\n                        prevValue: prevValue\r\n                    });\r\n                    if (!(0, _type.isDefined)(prevValue) && !(0, _type.isDefined)(value) && 0 !== optionName.indexOf(\"buffer\")) {\r\n                        notFireEvent = true\r\n                    }\r\n                    if (!notFireEvent) {\r\n                        if ((0, _array.inArray)(optionName, USER_STATE_FIELD_NAMES) < 0 && \"visibleWidth\" !== optionName) {\r\n                            columns = that.option(\"columns\");\r\n                            initialColumn = that.getColumnByPath(fullOptionName, columns);\r\n                            if ((0, _type.isString)(initialColumn)) {\r\n                                initialColumn = columns[columnIndex] = {\r\n                                    dataField: initialColumn\r\n                                }\r\n                            }\r\n                            if (initialColumn && checkUserStateColumn(initialColumn, column)) {\r\n                                optionSetter(initialColumn, value, {\r\n                                    functionsAsIs: true\r\n                                })\r\n                            }\r\n                        }\r\n                        updateColumnChanges(that, changeType, optionName, columnIndex)\r\n                    } else {\r\n                        resetColumnsCache(that)\r\n                    }\r\n                }\r\n            };\r\n\r\n            function isSortOrderValid(sortOrder) {\r\n                return \"asc\" === sortOrder || \"desc\" === sortOrder\r\n            }\r\n            var addExpandColumn = function(that) {\r\n                var options = that._getExpandColumnOptions();\r\n                that.addCommandColumn(options)\r\n            };\r\n            var defaultSetCellValue = function(data, value) {\r\n                var path = this.dataField.split(\".\");\r\n                var dotCount = path.length - 1;\r\n                if (this.serializeValue) {\r\n                    value = this.serializeValue(value)\r\n                }\r\n                for (var i = 0; i < dotCount; i++) {\r\n                    var name = path[i];\r\n                    data = data[name] = data[name] || {}\r\n                }\r\n                data[path[dotCount]] = value\r\n            };\r\n            var getDataColumns = function getDataColumns(columns, rowIndex, bandColumnID) {\r\n                var result = [];\r\n                rowIndex = rowIndex || 0;\r\n                columns[rowIndex] && (0, _iterator.each)(columns[rowIndex], function(_, column) {\r\n                    if (column.ownerBand === bandColumnID || column.type === GROUP_COMMAND_COLUMN_NAME) {\r\n                        if (!column.isBand || !column.colspan) {\r\n                            if (!column.command || rowIndex < 1) {\r\n                                result.push(column)\r\n                            }\r\n                        } else {\r\n                            result.push.apply(result, getDataColumns(columns, rowIndex + 1, column.index))\r\n                        }\r\n                    }\r\n                });\r\n                return result\r\n            };\r\n            var _getRowCount = function(that) {\r\n                var rowCount = 1;\r\n                var bandColumnsCache = that.getBandColumnsCache();\r\n                var columnParentByIndex = bandColumnsCache.columnParentByIndex;\r\n                that._columns.forEach(function(column) {\r\n                    var parents = getParentBandColumns(column.index, columnParentByIndex);\r\n                    var invisibleParents = parents.filter(function(column) {\r\n                        return !column.visible\r\n                    });\r\n                    if (column.visible && !invisibleParents.length) {\r\n                        rowCount = Math.max(rowCount, parents.length + 1)\r\n                    }\r\n                });\r\n                return rowCount\r\n            };\r\n            var isCustomCommandColumn = function(that, commandColumn) {\r\n                return !!that._columns.filter(function(column) {\r\n                    return column.type === commandColumn.type\r\n                }).length\r\n            };\r\n            var getFixedPosition = function(that, column) {\r\n                var rtlEnabled = that.option(\"rtlEnabled\");\r\n                if (column.command && !isCustomCommandColumn(that, column) || !column.fixedPosition) {\r\n                    return rtlEnabled ? \"right\" : \"left\"\r\n                }\r\n                return column.fixedPosition\r\n            };\r\n            var processExpandColumns = function(columns, expandColumns, type, columnIndex) {\r\n                var customColumnIndex;\r\n                var rowCount = this.getRowCount();\r\n                var rowspan = columns[columnIndex] && columns[columnIndex].rowspan;\r\n                var expandColumnsByType = expandColumns.filter(function(column) {\r\n                    return column.type === type\r\n                });\r\n                columns.forEach(function(column, index) {\r\n                    if (column.type === type) {\r\n                        customColumnIndex = index;\r\n                        rowspan = columns[index + 1] ? columns[index + 1].rowspan : rowCount\r\n                    }\r\n                });\r\n                if (rowspan > 1) {\r\n                    expandColumnsByType = (0, _iterator.map)(expandColumnsByType, function(expandColumn) {\r\n                        return (0, _extend.extend)({}, expandColumn, {\r\n                            rowspan: rowspan\r\n                        })\r\n                    })\r\n                }\r\n                expandColumnsByType.unshift.apply(expandColumnsByType, (0, _type.isDefined)(customColumnIndex) ? [customColumnIndex, 1] : [columnIndex, 0]);\r\n                columns.splice.apply(columns, expandColumnsByType);\r\n                return rowspan || 1\r\n            };\r\n            var digitsCount = function(number) {\r\n                var i;\r\n                for (i = 0; number > 1; i++) {\r\n                    number /= 10\r\n                }\r\n                return i\r\n            };\r\n            var numberToString = function(number, digitsCount) {\r\n                var str = number ? number.toString() : \"0\";\r\n                while (str.length < digitsCount) {\r\n                    str = \"0\" + str\r\n                }\r\n                return str\r\n            };\r\n            var mergeColumns = function(that, columns, commandColumns, needToExtend) {\r\n                var column;\r\n                var commandColumnIndex;\r\n                var result = columns.slice().map(function(column) {\r\n                    return (0, _extend.extend)({}, column)\r\n                });\r\n                var isColumnFixing = that._isColumnFixing();\r\n                var defaultCommandColumns = commandColumns.slice().map(function(column) {\r\n                    return (0, _extend.extend)({\r\n                        fixed: isColumnFixing\r\n                    }, column)\r\n                });\r\n                var getCommandColumnIndex = function(column) {\r\n                    return commandColumns.reduce(function(result, commandColumn, index) {\r\n                        var columnType = needToExtend && column.type === GROUP_COMMAND_COLUMN_NAME ? \"expand\" : column.type;\r\n                        return commandColumn.type === columnType || commandColumn.command === column.command ? index : result\r\n                    }, -1)\r\n                };\r\n                var callbackFilter = function(commandColumn) {\r\n                    return commandColumn.command !== commandColumns[commandColumnIndex].command\r\n                };\r\n                for (var i = 0; i < columns.length; i++) {\r\n                    column = columns[i];\r\n                    commandColumnIndex = column && (column.type || column.command) ? getCommandColumnIndex(column) : -1;\r\n                    if (commandColumnIndex >= 0) {\r\n                        if (needToExtend) {\r\n                            result[i] = (0, _extend.extend)({\r\n                                fixed: isColumnFixing\r\n                            }, commandColumns[commandColumnIndex], column);\r\n                            if (column.type !== GROUP_COMMAND_COLUMN_NAME) {\r\n                                defaultCommandColumns = defaultCommandColumns.filter(callbackFilter)\r\n                            }\r\n                        } else {\r\n                            var columnOptions = {\r\n                                visibleIndex: column.visibleIndex,\r\n                                index: column.index,\r\n                                headerId: column.headerId,\r\n                                allowFixing: 0 === column.groupIndex,\r\n                                allowReordering: 0 === column.groupIndex,\r\n                                groupIndex: column.groupIndex\r\n                            };\r\n                            result[i] = (0, _extend.extend)({}, column, commandColumns[commandColumnIndex], column.type === GROUP_COMMAND_COLUMN_NAME && columnOptions)\r\n                        }\r\n                    }\r\n                }\r\n                if (columns.length && needToExtend && defaultCommandColumns.length) {\r\n                    result = result.concat(defaultCommandColumns)\r\n                }\r\n                return result\r\n            };\r\n            var isColumnFixed = function(that, column) {\r\n                return (0, _type.isDefined)(column.fixed) || !column.type ? column.fixed : that._isColumnFixing()\r\n            };\r\n            var convertOwnerBandToColumnReference = function(columns) {\r\n                columns.forEach(function(column) {\r\n                    if ((0, _type.isDefined)(column.ownerBand)) {\r\n                        column.ownerBand = columns[column.ownerBand]\r\n                    }\r\n                })\r\n            };\r\n            var resetBandColumnsCache = function(that) {\r\n                that._bandColumnsCache = void 0\r\n            };\r\n            var findColumn = function(columns, identifier) {\r\n                var identifierOptionName = (0, _type.isString)(identifier) && identifier.substr(0, identifier.indexOf(\":\"));\r\n                var column;\r\n                if (void 0 === identifier) {\r\n                    return\r\n                }\r\n                if (identifierOptionName) {\r\n                    identifier = identifier.substr(identifierOptionName.length + 1)\r\n                }\r\n                if (identifierOptionName) {\r\n                    column = columns.filter(function(column) {\r\n                        return \"\" + column[identifierOptionName] === identifier\r\n                    })[0]\r\n                } else {\r\n                    [\"index\", \"name\", \"dataField\", \"caption\"].some(function(optionName) {\r\n                        column = columns.filter(function(column) {\r\n                            return column[optionName] === identifier\r\n                        })[0];\r\n                        return !!column\r\n                    })\r\n                }\r\n                return column\r\n            };\r\n            return {\r\n                _getExpandColumnOptions: function() {\r\n                    return {\r\n                        type: \"expand\",\r\n                        command: \"expand\",\r\n                        width: \"auto\",\r\n                        cssClass: COMMAND_EXPAND_CLASS,\r\n                        allowEditing: false,\r\n                        allowGrouping: false,\r\n                        allowSorting: false,\r\n                        allowResizing: false,\r\n                        allowReordering: false,\r\n                        allowHiding: false\r\n                    }\r\n                },\r\n                _getFirstItems: function(dataSource) {\r\n                    var groupsCount;\r\n                    var items = [];\r\n                    var getFirstItemsCore = function getFirstItemsCore(items, groupsCount) {\r\n                        if (!items || !groupsCount) {\r\n                            return items\r\n                        }\r\n                        for (var i = 0; i < items.length; i++) {\r\n                            var childItems = getFirstItemsCore(items[i].items || items[i].collapsedItems, groupsCount - 1);\r\n                            if (childItems && childItems.length) {\r\n                                return childItems\r\n                            }\r\n                        }\r\n                    };\r\n                    if (dataSource && dataSource.items().length > 0) {\r\n                        groupsCount = _uiGrid_core2.default.normalizeSortingInfo(dataSource.group()).length;\r\n                        items = getFirstItemsCore(dataSource.items(), groupsCount) || []\r\n                    }\r\n                    return items\r\n                },\r\n                _endUpdateCore: function() {\r\n                    !this._skipProcessingColumnsChange && fireColumnsChanged(this)\r\n                },\r\n                init: function() {\r\n                    var that = this;\r\n                    var columns = that.option(\"columns\");\r\n                    that._commandColumns = that._commandColumns || [];\r\n                    that._columns = that._columns || [];\r\n                    that._isColumnsFromOptions = !!columns;\r\n                    if (that._isColumnsFromOptions) {\r\n                        assignColumns(that, columns ? createColumnsFromOptions(that, columns) : []);\r\n                        applyUserState(that)\r\n                    } else {\r\n                        assignColumns(that, that._columnsUserState ? createColumnsFromOptions(that, that._columnsUserState) : that._columns)\r\n                    }\r\n                    addExpandColumn(that);\r\n                    if (that._dataSourceApplied) {\r\n                        that.applyDataSource(that._dataSource, true)\r\n                    } else {\r\n                        updateIndexes(that)\r\n                    }\r\n                    that._checkColumns()\r\n                },\r\n                callbackNames: function() {\r\n                    return [\"columnsChanged\"]\r\n                },\r\n                getColumnByPath: function(path, columns) {\r\n                    var that = this;\r\n                    var column;\r\n                    var columnIndexes = [];\r\n                    path.replace(regExp, function(_, columnIndex) {\r\n                        columnIndexes.push(parseInt(columnIndex));\r\n                        return \"\"\r\n                    });\r\n                    if (columnIndexes.length) {\r\n                        if (columns) {\r\n                            column = columnIndexes.reduce(function(column, index) {\r\n                                return column && column.columns && column.columns[index]\r\n                            }, {\r\n                                columns: columns\r\n                            })\r\n                        } else {\r\n                            column = getColumnByIndexes(that, columnIndexes)\r\n                        }\r\n                    }\r\n                    return column\r\n                },\r\n                optionChanged: function(args) {\r\n                    var needUpdateRequireResize;\r\n                    switch (args.name) {\r\n                        case \"adaptColumnWidthByRatio\":\r\n                            args.handled = true;\r\n                            break;\r\n                        case \"dataSource\":\r\n                            if (args.value !== args.previousValue && !this.option(\"columns\") && (!Array.isArray(args.value) || !Array.isArray(args.previousValue))) {\r\n                                this._columns = []\r\n                            }\r\n                            break;\r\n                        case \"columns\":\r\n                            needUpdateRequireResize = this._skipProcessingColumnsChange;\r\n                            args.handled = true;\r\n                            if (!this._skipProcessingColumnsChange) {\r\n                                if (args.name === args.fullName) {\r\n                                    this._columnsUserState = null;\r\n                                    this._ignoreColumnOptionNames = null;\r\n                                    this.init()\r\n                                } else {\r\n                                    this._columnOptionChanged(args);\r\n                                    needUpdateRequireResize = true\r\n                                }\r\n                            }\r\n                            if (needUpdateRequireResize) {\r\n                                this._updateRequireResize(args)\r\n                            }\r\n                            break;\r\n                        case \"commonColumnSettings\":\r\n                        case \"columnAutoWidth\":\r\n                        case \"allowColumnResizing\":\r\n                        case \"allowColumnReordering\":\r\n                        case \"columnFixing\":\r\n                        case \"grouping\":\r\n                        case \"groupPanel\":\r\n                        case \"regenerateColumnsByVisibleItems\":\r\n                        case \"customizeColumns\":\r\n                        case \"editing\":\r\n                        case \"columnHidingEnabled\":\r\n                        case \"dateSerializationFormat\":\r\n                        case \"columnResizingMode\":\r\n                        case \"columnMinWidth\":\r\n                        case \"columnWidth\":\r\n                            var _args$fullName, _args$fullName2, _args$fullName3, _args$fullName4, _args$fullName5;\r\n                            args.handled = true;\r\n                            var ignoreColumnOptionNames = \"columnWidth\" === args.fullName && [\"width\"];\r\n                            var isEditingPopup = 0 === (null === (_args$fullName = args.fullName) || void 0 === _args$fullName ? void 0 : _args$fullName.indexOf(\"editing.popup\"));\r\n                            var isEditingForm = 0 === (null === (_args$fullName2 = args.fullName) || void 0 === _args$fullName2 ? void 0 : _args$fullName2.indexOf(\"editing.form\"));\r\n                            var isEditRowKey = 0 === (null === (_args$fullName3 = args.fullName) || void 0 === _args$fullName3 ? void 0 : _args$fullName3.indexOf(\"editing.editRowKey\"));\r\n                            var isEditColumnName = 0 === (null === (_args$fullName4 = args.fullName) || void 0 === _args$fullName4 ? void 0 : _args$fullName4.indexOf(\"editing.editColumnName\"));\r\n                            var isChanges = 0 === (null === (_args$fullName5 = args.fullName) || void 0 === _args$fullName5 ? void 0 : _args$fullName5.indexOf(\"editing.changes\"));\r\n                            var needReinit = !isEditingPopup && !isEditingForm && !isEditRowKey && !isChanges && !isEditColumnName;\r\n                            if (needReinit) {\r\n                                this.reinit(ignoreColumnOptionNames)\r\n                            }\r\n                            break;\r\n                        case \"rtlEnabled\":\r\n                            this.reinit();\r\n                            break;\r\n                        default:\r\n                            this.callBase(args)\r\n                    }\r\n                },\r\n                _columnOptionChanged: function(args) {\r\n                    var columnOptionValue = {};\r\n                    var column = this.getColumnByPath(args.fullName);\r\n                    var columnOptionName = args.fullName.replace(regExp, \"\");\r\n                    if (column) {\r\n                        if (columnOptionName) {\r\n                            columnOptionValue[columnOptionName] = args.value\r\n                        } else {\r\n                            columnOptionValue = args.value\r\n                        }\r\n                        this._skipProcessingColumnsChange = args.fullName;\r\n                        this.columnOption(column.index, columnOptionValue);\r\n                        this._skipProcessingColumnsChange = false\r\n                    }\r\n                },\r\n                _updateRequireResize: function(args) {\r\n                    var component = this.component;\r\n                    if (\"width\" === args.fullName.replace(regExp, \"\") && component._updateLockCount) {\r\n                        component._requireResize = true\r\n                    }\r\n                },\r\n                publicMethods: function() {\r\n                    return [\"addColumn\", \"deleteColumn\", \"columnOption\", \"columnCount\", \"clearSorting\", \"clearGrouping\", \"getVisibleColumns\", \"getVisibleColumnIndex\"]\r\n                },\r\n                applyDataSource: function(dataSource, forceApplying) {\r\n                    var that = this;\r\n                    var isDataSourceLoaded = dataSource && dataSource.isLoaded();\r\n                    that._dataSource = dataSource;\r\n                    if (!that._dataSourceApplied || 0 === that._dataSourceColumnsCount || forceApplying || that.option(\"regenerateColumnsByVisibleItems\")) {\r\n                        if (isDataSourceLoaded) {\r\n                            if (!that._isColumnsFromOptions) {\r\n                                var columnsFromDataSource = createColumnsFromDataSource(that, dataSource);\r\n                                if (columnsFromDataSource.length) {\r\n                                    assignColumns(that, columnsFromDataSource);\r\n                                    that._dataSourceColumnsCount = that._columns.length;\r\n                                    applyUserState(that)\r\n                                }\r\n                            }\r\n                            return that.updateColumns(dataSource, forceApplying)\r\n                        } else {\r\n                            that._dataSourceApplied = false\r\n                        }\r\n                    } else {\r\n                        if (isDataSourceLoaded && !that.isAllDataTypesDefined(true) && that.updateColumnDataTypes(dataSource)) {\r\n                            updateColumnChanges(that, \"columns\");\r\n                            fireColumnsChanged(that);\r\n                            return (new _deferred.Deferred).reject().promise()\r\n                        }\r\n                    }\r\n                },\r\n                reset: function() {\r\n                    this._dataSourceApplied = false;\r\n                    this._dataSourceColumnsCount = void 0;\r\n                    this.reinit()\r\n                },\r\n                resetColumnsCache: function() {\r\n                    var that = this;\r\n                    that._visibleColumns = void 0;\r\n                    that._fixedColumns = void 0;\r\n                    that._rowCount = void 0;\r\n                    resetBandColumnsCache(that)\r\n                },\r\n                reinit: function(ignoreColumnOptionNames) {\r\n                    this._columnsUserState = this.getUserState();\r\n                    this._ignoreColumnOptionNames = ignoreColumnOptionNames || null;\r\n                    this.init();\r\n                    if (ignoreColumnOptionNames) {\r\n                        this._ignoreColumnOptionNames = null\r\n                    }\r\n                },\r\n                isInitialized: function() {\r\n                    return !!this._columns.length || !!this.option(\"columns\")\r\n                },\r\n                isDataSourceApplied: function() {\r\n                    return this._dataSourceApplied\r\n                },\r\n                getCommonSettings: function(column) {\r\n                    var commonColumnSettings = (!column || !column.type) && this.option(\"commonColumnSettings\") || {};\r\n                    var groupingOptions = this.option(\"grouping\") || {};\r\n                    var groupPanelOptions = this.option(\"groupPanel\") || {};\r\n                    return (0, _extend.extend)({\r\n                        allowFixing: this.option(\"columnFixing.enabled\"),\r\n                        allowResizing: this.option(\"allowColumnResizing\") || void 0,\r\n                        allowReordering: this.option(\"allowColumnReordering\"),\r\n                        minWidth: this.option(\"columnMinWidth\"),\r\n                        width: this.option(\"columnWidth\"),\r\n                        autoExpandGroup: groupingOptions.autoExpandAll,\r\n                        allowCollapsing: groupingOptions.allowCollapsing,\r\n                        allowGrouping: groupPanelOptions.allowColumnDragging && groupPanelOptions.visible || groupingOptions.contextMenuEnabled\r\n                    }, commonColumnSettings)\r\n                },\r\n                isColumnOptionUsed: function(optionName) {\r\n                    for (var i = 0; i < this._columns.length; i++) {\r\n                        if (this._columns[i][optionName]) {\r\n                            return true\r\n                        }\r\n                    }\r\n                },\r\n                isAllDataTypesDefined: function(checkSerializers) {\r\n                    var columns = this._columns;\r\n                    if (!columns.length) {\r\n                        return false\r\n                    }\r\n                    for (var i = 0; i < columns.length; i++) {\r\n                        if (!columns[i].dataField && columns[i].calculateCellValue === columns[i].defaultCalculateCellValue) {\r\n                            continue\r\n                        }\r\n                        if (!columns[i].dataType || checkSerializers && columns[i].deserializeValue && void 0 === columns[i].serializationFormat) {\r\n                            return false\r\n                        }\r\n                    }\r\n                    return true\r\n                },\r\n                getColumns: function() {\r\n                    return this._columns\r\n                },\r\n                isBandColumnsUsed: function() {\r\n                    return this.getColumns().some(function(column) {\r\n                        return column.isBand\r\n                    })\r\n                },\r\n                getGroupColumns: function() {\r\n                    var result = [];\r\n                    (0, _iterator.each)(this._columns, function() {\r\n                        var column = this;\r\n                        if ((0, _type.isDefined)(column.groupIndex)) {\r\n                            result[column.groupIndex] = column\r\n                        }\r\n                    });\r\n                    return result\r\n                },\r\n                getVisibleColumns: function(rowIndex) {\r\n                    this._visibleColumns = this._visibleColumns || this._getVisibleColumnsCore();\r\n                    rowIndex = (0, _type.isDefined)(rowIndex) ? rowIndex : this._visibleColumns.length - 1;\r\n                    return this._visibleColumns[rowIndex] || []\r\n                },\r\n                getFixedColumns: function(rowIndex) {\r\n                    this._fixedColumns = this._fixedColumns || this._getFixedColumnsCore();\r\n                    rowIndex = (0, _type.isDefined)(rowIndex) ? rowIndex : this._fixedColumns.length - 1;\r\n                    return this._fixedColumns[rowIndex] || []\r\n                },\r\n                getFilteringColumns: function() {\r\n                    return this.getColumns().filter(function(item) {\r\n                        return (item.dataField || item.name) && (item.allowFiltering || item.allowHeaderFiltering)\r\n                    }).map(function(item) {\r\n                        var field = (0, _extend.extend)(true, {}, item);\r\n                        if (!(0, _type.isDefined)(field.dataField)) {\r\n                            field.dataField = field.name\r\n                        }\r\n                        field.filterOperations = item.filterOperations !== item.defaultFilterOperations ? field.filterOperations : null;\r\n                        return field\r\n                    })\r\n                },\r\n                getColumnIndexOffset: function() {\r\n                    return 0\r\n                },\r\n                _getFixedColumnsCore: function() {\r\n                    var that = this;\r\n                    var result = [];\r\n                    var rowCount = that.getRowCount();\r\n                    var isColumnFixing = that._isColumnFixing();\r\n                    var transparentColumn = {\r\n                        command: \"transparent\"\r\n                    };\r\n                    var transparentColspan = 0;\r\n                    var notFixedColumnCount;\r\n                    var transparentColumnIndex;\r\n                    var lastFixedPosition;\r\n                    if (isColumnFixing) {\r\n                        for (var i = 0; i <= rowCount; i++) {\r\n                            notFixedColumnCount = 0;\r\n                            lastFixedPosition = null;\r\n                            transparentColumnIndex = null;\r\n                            var visibleColumns = that.getVisibleColumns(i, true);\r\n                            for (var j = 0; j < visibleColumns.length; j++) {\r\n                                var prevColumn = visibleColumns[j - 1];\r\n                                var column = visibleColumns[j];\r\n                                if (!column.fixed) {\r\n                                    if (0 === i) {\r\n                                        if (column.isBand && column.colspan) {\r\n                                            transparentColspan += column.colspan\r\n                                        } else {\r\n                                            transparentColspan++\r\n                                        }\r\n                                    }\r\n                                    notFixedColumnCount++;\r\n                                    if (!(0, _type.isDefined)(transparentColumnIndex)) {\r\n                                        transparentColumnIndex = j\r\n                                    }\r\n                                } else {\r\n                                    if (prevColumn && prevColumn.fixed && getFixedPosition(that, prevColumn) !== getFixedPosition(that, column)) {\r\n                                        if (!(0, _type.isDefined)(transparentColumnIndex)) {\r\n                                            transparentColumnIndex = j\r\n                                        }\r\n                                    } else {\r\n                                        lastFixedPosition = column.fixedPosition\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (0 === i && (0 === notFixedColumnCount || notFixedColumnCount >= visibleColumns.length)) {\r\n                                return []\r\n                            }\r\n                            if (!(0, _type.isDefined)(transparentColumnIndex)) {\r\n                                transparentColumnIndex = \"right\" === lastFixedPosition ? 0 : visibleColumns.length\r\n                            }\r\n                            result[i] = visibleColumns.slice(0);\r\n                            if (!transparentColumn.colspan) {\r\n                                transparentColumn.colspan = transparentColspan\r\n                            }\r\n                            result[i].splice(transparentColumnIndex, notFixedColumnCount, transparentColumn)\r\n                        }\r\n                    }\r\n                    return result.map(function(columns) {\r\n                        return columns.map(function(column) {\r\n                            var newColumn = _objectSpread({}, column);\r\n                            if (newColumn.headerId) {\r\n                                newColumn.headerId += \"-fixed\"\r\n                            }\r\n                            return newColumn\r\n                        })\r\n                    })\r\n                },\r\n                _isColumnFixing: function() {\r\n                    var isColumnFixing = this.option(\"columnFixing.enabled\");\r\n                    !isColumnFixing && (0, _iterator.each)(this._columns, function(_, column) {\r\n                        if (column.fixed) {\r\n                            isColumnFixing = true;\r\n                            return false\r\n                        }\r\n                    });\r\n                    return isColumnFixing\r\n                },\r\n                _getExpandColumnsCore: function() {\r\n                    return this.getGroupColumns()\r\n                },\r\n                getExpandColumns: function() {\r\n                    var expandColumns = this._getExpandColumnsCore();\r\n                    var expandColumn;\r\n                    var firstGroupColumn = expandColumns.filter(function(column) {\r\n                        return 0 === column.groupIndex\r\n                    })[0];\r\n                    var isFixedFirstGroupColumn = firstGroupColumn && firstGroupColumn.fixed;\r\n                    var isColumnFixing = this._isColumnFixing();\r\n                    if (expandColumns.length) {\r\n                        expandColumn = this.columnOption(\"command:expand\")\r\n                    }\r\n                    expandColumns = (0, _iterator.map)(expandColumns, function(column) {\r\n                        return (0, _extend.extend)({}, column, {\r\n                            visibleWidth: null,\r\n                            minWidth: null,\r\n                            cellTemplate: !(0, _type.isDefined)(column.groupIndex) ? column.cellTemplate : null,\r\n                            headerCellTemplate: null,\r\n                            fixed: !(0, _type.isDefined)(column.groupIndex) || !isFixedFirstGroupColumn ? isColumnFixing : true\r\n                        }, expandColumn, {\r\n                            index: column.index,\r\n                            type: column.type || GROUP_COMMAND_COLUMN_NAME\r\n                        })\r\n                    });\r\n                    return expandColumns\r\n                },\r\n                getBandColumnsCache: function() {\r\n                    if (!this._bandColumnsCache) {\r\n                        var columns = this._columns;\r\n                        var columnChildrenByIndex = {};\r\n                        var columnParentByIndex = {};\r\n                        var isPlain = true;\r\n                        columns.forEach(function(column) {\r\n                            var parentIndex = column.ownerBand;\r\n                            var parent = columns[parentIndex];\r\n                            if (column.hasColumns) {\r\n                                isPlain = false\r\n                            }\r\n                            if (column.colspan) {\r\n                                column.colspan = void 0\r\n                            }\r\n                            if (column.rowspan) {\r\n                                column.rowspan = void 0\r\n                            }\r\n                            if (parent) {\r\n                                columnParentByIndex[column.index] = parent\r\n                            } else {\r\n                                parentIndex = -1\r\n                            }\r\n                            columnChildrenByIndex[parentIndex] = columnChildrenByIndex[parentIndex] || [];\r\n                            columnChildrenByIndex[parentIndex].push(column)\r\n                        });\r\n                        this._bandColumnsCache = {\r\n                            isPlain: isPlain,\r\n                            columnChildrenByIndex: columnChildrenByIndex,\r\n                            columnParentByIndex: columnParentByIndex\r\n                        }\r\n                    }\r\n                    return this._bandColumnsCache\r\n                },\r\n                _isColumnVisible: function(column) {\r\n                    return column.visible && this.isParentColumnVisible(column.index)\r\n                },\r\n                _getVisibleColumnsCore: function() {\r\n                    var that = this;\r\n                    var i;\r\n                    var result = [];\r\n                    var rowspanGroupColumns = 0;\r\n                    var rowspanExpandColumns = 0;\r\n                    var rowCount = that.getRowCount();\r\n                    var positiveIndexedColumns = [];\r\n                    var negativeIndexedColumns = [];\r\n                    var notGroupedColumnsCount = 0;\r\n                    var isFixedToEnd;\r\n                    var rtlEnabled = that.option(\"rtlEnabled\");\r\n                    var bandColumnsCache = that.getBandColumnsCache();\r\n                    var expandColumns = mergeColumns(that, that.getExpandColumns(), that._columns);\r\n                    var columns = mergeColumns(that, that._columns, that._commandColumns, true);\r\n                    var columnDigitsCount = digitsCount(columns.length);\r\n                    processBandColumns(that, columns, bandColumnsCache);\r\n                    for (i = 0; i < rowCount; i++) {\r\n                        result[i] = [];\r\n                        negativeIndexedColumns[i] = [{}];\r\n                        positiveIndexedColumns[i] = [{}, {}, {}]\r\n                    }(0, _iterator.each)(columns, function() {\r\n                        var column = this;\r\n                        var visibleIndex = column.visibleIndex;\r\n                        var indexedColumns;\r\n                        var parentBandColumns = getParentBandColumns(column.index, bandColumnsCache.columnParentByIndex);\r\n                        var visible = that._isColumnVisible(column);\r\n                        if (visible && (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped)) {\r\n                            var rowIndex = parentBandColumns.length;\r\n                            if (visibleIndex < 0) {\r\n                                visibleIndex = -visibleIndex;\r\n                                indexedColumns = negativeIndexedColumns[rowIndex]\r\n                            } else {\r\n                                column.fixed = parentBandColumns.length ? parentBandColumns[0].fixed : column.fixed;\r\n                                column.fixedPosition = parentBandColumns.length ? parentBandColumns[0].fixedPosition : column.fixedPosition;\r\n                                if (column.fixed) {\r\n                                    isFixedToEnd = \"right\" === column.fixedPosition;\r\n                                    if (rtlEnabled && (!column.command || isCustomCommandColumn(that, column))) {\r\n                                        isFixedToEnd = !isFixedToEnd\r\n                                    }\r\n                                    if (isFixedToEnd) {\r\n                                        indexedColumns = positiveIndexedColumns[rowIndex][2]\r\n                                    } else {\r\n                                        indexedColumns = positiveIndexedColumns[rowIndex][0]\r\n                                    }\r\n                                } else {\r\n                                    indexedColumns = positiveIndexedColumns[rowIndex][1]\r\n                                }\r\n                            }\r\n                            if (parentBandColumns.length) {\r\n                                visibleIndex = numberToString(visibleIndex, columnDigitsCount);\r\n                                for (i = parentBandColumns.length - 1; i >= 0; i--) {\r\n                                    visibleIndex = numberToString(parentBandColumns[i].visibleIndex, columnDigitsCount) + visibleIndex\r\n                                }\r\n                            }\r\n                            indexedColumns[visibleIndex] = indexedColumns[visibleIndex] || [];\r\n                            indexedColumns[visibleIndex].push(column);\r\n                            notGroupedColumnsCount++\r\n                        }\r\n                    });\r\n                    (0, _iterator.each)(result, function(rowIndex) {\r\n                        (0, _object.orderEach)(negativeIndexedColumns[rowIndex], function(_, columns) {\r\n                            result[rowIndex].unshift.apply(result[rowIndex], columns)\r\n                        });\r\n                        var firstPositiveIndexColumn = result[rowIndex].length;\r\n                        (0, _iterator.each)(positiveIndexedColumns[rowIndex], function(index, columnsByFixing) {\r\n                            (0, _object.orderEach)(columnsByFixing, function(_, columnsByVisibleIndex) {\r\n                                result[rowIndex].push.apply(result[rowIndex], columnsByVisibleIndex)\r\n                            })\r\n                        });\r\n                        if (rowspanExpandColumns < rowIndex + 1) {\r\n                            rowspanExpandColumns += processExpandColumns.call(that, result[rowIndex], expandColumns, \"detailExpand\", firstPositiveIndexColumn)\r\n                        }\r\n                        if (rowspanGroupColumns < rowIndex + 1) {\r\n                            rowspanGroupColumns += processExpandColumns.call(that, result[rowIndex], expandColumns, GROUP_COMMAND_COLUMN_NAME, firstPositiveIndexColumn)\r\n                        }\r\n                    });\r\n                    result.push(getDataColumns(result));\r\n                    if (!notGroupedColumnsCount && that._columns.length) {\r\n                        result[rowCount].push({\r\n                            command: \"empty\"\r\n                        })\r\n                    }\r\n                    return result\r\n                },\r\n                getInvisibleColumns: function(columns, bandColumnIndex) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    var hiddenColumnsByBand;\r\n                    columns = columns || that._columns;\r\n                    (0, _iterator.each)(columns, function(_, column) {\r\n                        if (column.ownerBand !== bandColumnIndex) {\r\n                            return\r\n                        }\r\n                        if (column.isBand) {\r\n                            if (!column.visible) {\r\n                                hiddenColumnsByBand = that.getChildrenByBandColumn(column.index)\r\n                            } else {\r\n                                hiddenColumnsByBand = that.getInvisibleColumns(that.getChildrenByBandColumn(column.index), column.index)\r\n                            }\r\n                            if (hiddenColumnsByBand.length) {\r\n                                result.push(column);\r\n                                result = result.concat(hiddenColumnsByBand)\r\n                            }\r\n                            return\r\n                        }\r\n                        if (!column.visible) {\r\n                            result.push(column)\r\n                        }\r\n                    });\r\n                    return result\r\n                },\r\n                getChooserColumns: function(getAllColumns) {\r\n                    var columns = getAllColumns ? this.getColumns() : this.getInvisibleColumns();\r\n                    return (0, _common.grep)(columns, function(column) {\r\n                        return column.showInColumnChooser\r\n                    })\r\n                },\r\n                allowMoveColumn: function(fromVisibleIndex, toVisibleIndex, sourceLocation, targetLocation) {\r\n                    var that = this;\r\n                    var columnIndex = getColumnIndexByVisibleIndex(that, fromVisibleIndex, sourceLocation);\r\n                    var sourceColumn = that._columns[columnIndex];\r\n                    if (sourceColumn && (sourceColumn.allowReordering || sourceColumn.allowGrouping || sourceColumn.allowHiding)) {\r\n                        if (sourceLocation === targetLocation) {\r\n                            if (sourceLocation === COLUMN_CHOOSER_LOCATION) {\r\n                                return false\r\n                            }\r\n                            fromVisibleIndex = (0, _type.isObject)(fromVisibleIndex) ? fromVisibleIndex.columnIndex : fromVisibleIndex;\r\n                            toVisibleIndex = (0, _type.isObject)(toVisibleIndex) ? toVisibleIndex.columnIndex : toVisibleIndex;\r\n                            return fromVisibleIndex !== toVisibleIndex && fromVisibleIndex + 1 !== toVisibleIndex\r\n                        } else {\r\n                            if (sourceLocation === GROUP_LOCATION && targetLocation !== COLUMN_CHOOSER_LOCATION || targetLocation === GROUP_LOCATION) {\r\n                                return sourceColumn && sourceColumn.allowGrouping\r\n                            } else {\r\n                                if (sourceLocation === COLUMN_CHOOSER_LOCATION || targetLocation === COLUMN_CHOOSER_LOCATION) {\r\n                                    return sourceColumn && sourceColumn.allowHiding\r\n                                }\r\n                            }\r\n                        }\r\n                        return true\r\n                    }\r\n                    return false\r\n                },\r\n                moveColumn: function(fromVisibleIndex, toVisibleIndex, sourceLocation, targetLocation) {\r\n                    var that = this;\r\n                    var options = {};\r\n                    var prevGroupIndex;\r\n                    var fromIndex = getColumnIndexByVisibleIndex(that, fromVisibleIndex, sourceLocation);\r\n                    var toIndex = getColumnIndexByVisibleIndex(that, toVisibleIndex, targetLocation);\r\n                    var targetGroupIndex;\r\n                    if (fromIndex >= 0) {\r\n                        var column = that._columns[fromIndex];\r\n                        toVisibleIndex = (0, _type.isObject)(toVisibleIndex) ? toVisibleIndex.columnIndex : toVisibleIndex;\r\n                        targetGroupIndex = toIndex >= 0 ? that._columns[toIndex].groupIndex : -1;\r\n                        if ((0, _type.isDefined)(column.groupIndex) && sourceLocation === GROUP_LOCATION) {\r\n                            if (targetGroupIndex > column.groupIndex) {\r\n                                targetGroupIndex--\r\n                            }\r\n                            if (targetLocation !== GROUP_LOCATION) {\r\n                                options.groupIndex = void 0\r\n                            } else {\r\n                                prevGroupIndex = column.groupIndex;\r\n                                delete column.groupIndex;\r\n                                updateColumnGroupIndexes(that)\r\n                            }\r\n                        }\r\n                        if (targetLocation === GROUP_LOCATION) {\r\n                            options.groupIndex = moveColumnToGroup(that, column, targetGroupIndex);\r\n                            column.groupIndex = prevGroupIndex\r\n                        } else {\r\n                            if (toVisibleIndex >= 0) {\r\n                                var targetColumn = that._columns[toIndex];\r\n                                if (!targetColumn || column.ownerBand !== targetColumn.ownerBand) {\r\n                                    options.visibleIndex = MAX_SAFE_INTEGER\r\n                                } else {\r\n                                    if (isColumnFixed(that, column) ^ isColumnFixed(that, targetColumn)) {\r\n                                        options.visibleIndex = MAX_SAFE_INTEGER\r\n                                    } else {\r\n                                        options.visibleIndex = targetColumn.visibleIndex\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        var isVisible = targetLocation !== COLUMN_CHOOSER_LOCATION;\r\n                        if (column.visible !== isVisible) {\r\n                            options.visible = isVisible\r\n                        }\r\n                        that.columnOption(column.index, options)\r\n                    }\r\n                },\r\n                changeSortOrder: function(columnIndex, sortOrder) {\r\n                    var that = this;\r\n                    var options = {};\r\n                    var sortingOptions = that.option(\"sorting\");\r\n                    var sortingMode = sortingOptions && sortingOptions.mode;\r\n                    var needResetSorting = \"single\" === sortingMode || !sortOrder;\r\n                    var allowSorting = \"single\" === sortingMode || \"multiple\" === sortingMode;\r\n                    var column = that._columns[columnIndex];\r\n                    var nextSortOrder = function(column) {\r\n                        if (\"ctrl\" === sortOrder) {\r\n                            if (!(\"sortOrder\" in column && \"sortIndex\" in column)) {\r\n                                return false\r\n                            }\r\n                            options.sortOrder = void 0;\r\n                            options.sortIndex = void 0\r\n                        } else {\r\n                            if ((0, _type.isDefined)(column.groupIndex) || (0, _type.isDefined)(column.sortIndex)) {\r\n                                options.sortOrder = \"desc\" === column.sortOrder ? \"asc\" : \"desc\"\r\n                            } else {\r\n                                options.sortOrder = \"asc\"\r\n                            }\r\n                        }\r\n                        return true\r\n                    };\r\n                    if (allowSorting && column && column.allowSorting) {\r\n                        if (needResetSorting && !(0, _type.isDefined)(column.groupIndex)) {\r\n                            (0, _iterator.each)(that._columns, function(index) {\r\n                                if (index !== columnIndex && this.sortOrder) {\r\n                                    if (!(0, _type.isDefined)(this.groupIndex)) {\r\n                                        delete this.sortOrder\r\n                                    }\r\n                                    delete this.sortIndex\r\n                                }\r\n                            })\r\n                        }\r\n                        if (isSortOrderValid(sortOrder)) {\r\n                            if (column.sortOrder !== sortOrder) {\r\n                                options.sortOrder = sortOrder\r\n                            }\r\n                        } else {\r\n                            if (\"none\" === sortOrder) {\r\n                                if (column.sortOrder) {\r\n                                    options.sortIndex = void 0;\r\n                                    options.sortOrder = void 0\r\n                                }\r\n                            } else {\r\n                                nextSortOrder(column)\r\n                            }\r\n                        }\r\n                    }\r\n                    that.columnOption(column.index, options)\r\n                },\r\n                getSortDataSourceParameters: function(useLocalSelector) {\r\n                    var that = this;\r\n                    var sortColumns = [];\r\n                    var sort = [];\r\n                    (0, _iterator.each)(that._columns, function() {\r\n                        if ((this.dataField || this.selector || this.calculateCellValue) && (0, _type.isDefined)(this.sortIndex) && !(0, _type.isDefined)(this.groupIndex)) {\r\n                            sortColumns[this.sortIndex] = this\r\n                        }\r\n                    });\r\n                    (0, _iterator.each)(sortColumns, function() {\r\n                        var sortOrder = this && this.sortOrder;\r\n                        if (isSortOrderValid(sortOrder)) {\r\n                            var sortItem = {\r\n                                selector: this.calculateSortValue || this.displayField || this.calculateDisplayValue || useLocalSelector && this.selector || this.dataField || this.calculateCellValue,\r\n                                desc: \"desc\" === this.sortOrder\r\n                            };\r\n                            if (this.sortingMethod) {\r\n                                sortItem.compare = this.sortingMethod.bind(this)\r\n                            }\r\n                            sort.push(sortItem)\r\n                        }\r\n                    });\r\n                    return sort.length > 0 ? sort : null\r\n                },\r\n                getGroupDataSourceParameters: function(useLocalSelector) {\r\n                    var group = [];\r\n                    (0, _iterator.each)(this.getGroupColumns(), function() {\r\n                        var selector = this.calculateGroupValue || this.displayField || this.calculateDisplayValue || useLocalSelector && this.selector || this.dataField || this.calculateCellValue;\r\n                        if (selector) {\r\n                            var groupItem = {\r\n                                selector: selector,\r\n                                desc: \"desc\" === this.sortOrder,\r\n                                isExpanded: !!this.autoExpandGroup\r\n                            };\r\n                            if (this.sortingMethod) {\r\n                                groupItem.compare = this.sortingMethod.bind(this)\r\n                            }\r\n                            group.push(groupItem)\r\n                        }\r\n                    });\r\n                    return group.length > 0 ? group : null\r\n                },\r\n                refresh: function(updateNewLookupsOnly) {\r\n                    var deferreds = [];\r\n                    (0, _iterator.each)(this._columns, function() {\r\n                        var lookup = this.lookup;\r\n                        if (lookup && !this.calculateDisplayValue) {\r\n                            if (updateNewLookupsOnly && lookup.valueMap) {\r\n                                return\r\n                            }\r\n                            if (lookup.update) {\r\n                                deferreds.push(lookup.update())\r\n                            }\r\n                        }\r\n                    });\r\n                    return _deferred.when.apply(_renderer.default, deferreds).done(resetColumnsCache.bind(null, this))\r\n                },\r\n                _updateColumnOptions: function(column, columnIndex) {\r\n                    column.selector = column.selector || function(data) {\r\n                        return column.calculateCellValue(data)\r\n                    };\r\n                    (0, _iterator.each)([\"calculateSortValue\", \"calculateGroupValue\", \"calculateDisplayValue\"], function(_, calculateCallbackName) {\r\n                        var calculateCallback = column[calculateCallbackName];\r\n                        if ((0, _type.isFunction)(calculateCallback) && !calculateCallback.originalCallback) {\r\n                            column[calculateCallbackName] = function(data) {\r\n                                return calculateCallback.call(column, data)\r\n                            };\r\n                            column[calculateCallbackName].originalCallback = calculateCallback;\r\n                            column[calculateCallbackName].columnIndex = columnIndex\r\n                        }\r\n                    });\r\n                    if ((0, _type.isString)(column.calculateDisplayValue)) {\r\n                        column.displayField = column.calculateDisplayValue;\r\n                        column.calculateDisplayValue = (0, _data.compileGetter)(column.displayField)\r\n                    }\r\n                    if (column.calculateDisplayValue) {\r\n                        column.displayValueMap = column.displayValueMap || {}\r\n                    }\r\n                    updateSerializers(column, column.dataType);\r\n                    var lookup = column.lookup;\r\n                    if (lookup) {\r\n                        updateSerializers(lookup, lookup.dataType)\r\n                    }\r\n                    var dataType = lookup ? lookup.dataType : column.dataType;\r\n                    if (dataType) {\r\n                        column.alignment = column.alignment || getAlignmentByDataType(dataType, this.option(\"rtlEnabled\"));\r\n                        column.format = column.format || _uiGrid_core2.default.getFormatByDataType(dataType);\r\n                        column.customizeText = column.customizeText || getCustomizeTextByDataType(dataType);\r\n                        column.defaultFilterOperations = column.defaultFilterOperations || !lookup && DATATYPE_OPERATIONS[dataType] || [];\r\n                        if (!(0, _type.isDefined)(column.filterOperations)) {\r\n                            setFilterOperationsAsDefaultValues(column)\r\n                        }\r\n                        column.defaultFilterOperation = column.filterOperations && column.filterOperations[0] || \"=\";\r\n                        column.showEditorAlways = (0, _type.isDefined)(column.showEditorAlways) ? column.showEditorAlways : \"boolean\" === dataType && !column.cellTemplate\r\n                    }\r\n                },\r\n                updateColumnDataTypes: function(dataSource) {\r\n                    var that = this;\r\n                    var dateSerializationFormat = that.option(\"dateSerializationFormat\");\r\n                    var firstItems = that._getFirstItems(dataSource);\r\n                    var isColumnDataTypesUpdated = false;\r\n                    (0, _iterator.each)(that._columns, function(index, column) {\r\n                        var i;\r\n                        var value;\r\n                        var dataType;\r\n                        var lookupDataType;\r\n                        var valueDataType;\r\n                        var lookup = column.lookup;\r\n                        if (_uiGrid_core2.default.isDateType(column.dataType) && void 0 === column.serializationFormat) {\r\n                            column.serializationFormat = dateSerializationFormat\r\n                        }\r\n                        if (lookup && _uiGrid_core2.default.isDateType(lookup.dataType) && void 0 === column.serializationFormat) {\r\n                            lookup.serializationFormat = dateSerializationFormat\r\n                        }\r\n                        if (column.calculateCellValue && firstItems.length) {\r\n                            if (!column.dataType || lookup && !lookup.dataType) {\r\n                                for (i = 0; i < firstItems.length; i++) {\r\n                                    value = column.calculateCellValue(firstItems[i]);\r\n                                    if (!column.dataType) {\r\n                                        valueDataType = getValueDataType(value);\r\n                                        dataType = dataType || valueDataType;\r\n                                        if (dataType && valueDataType && dataType !== valueDataType) {\r\n                                            dataType = \"string\"\r\n                                        }\r\n                                    }\r\n                                    if (lookup && !lookup.dataType) {\r\n                                        valueDataType = getValueDataType(_uiGrid_core2.default.getDisplayValue(column, value, firstItems[i]));\r\n                                        lookupDataType = lookupDataType || valueDataType;\r\n                                        if (lookupDataType && valueDataType && lookupDataType !== valueDataType) {\r\n                                            lookupDataType = \"string\"\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (dataType || lookupDataType) {\r\n                                    if (dataType) {\r\n                                        column.dataType = dataType\r\n                                    }\r\n                                    if (lookup && lookupDataType) {\r\n                                        lookup.dataType = lookupDataType\r\n                                    }\r\n                                    isColumnDataTypesUpdated = true\r\n                                }\r\n                            }\r\n                            if (void 0 === column.serializationFormat || lookup && void 0 === lookup.serializationFormat) {\r\n                                for (i = 0; i < firstItems.length; i++) {\r\n                                    value = column.calculateCellValue(firstItems[i], true);\r\n                                    if (void 0 === column.serializationFormat) {\r\n                                        column.serializationFormat = getSerializationFormat(column.dataType, value)\r\n                                    }\r\n                                    if (lookup && void 0 === lookup.serializationFormat) {\r\n                                        lookup.serializationFormat = getSerializationFormat(lookup.dataType, lookup.calculateCellValue(value, true))\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        that._updateColumnOptions(column, index)\r\n                    });\r\n                    return isColumnDataTypesUpdated\r\n                },\r\n                _customizeColumns: function(columns) {\r\n                    var that = this;\r\n                    var customizeColumns = that.option(\"customizeColumns\");\r\n                    if (customizeColumns) {\r\n                        var hasOwnerBand = columns.some(function(column) {\r\n                            return (0, _type.isObject)(column.ownerBand)\r\n                        });\r\n                        if (hasOwnerBand) {\r\n                            updateIndexes(that)\r\n                        }\r\n                        customizeColumns(columns);\r\n                        assignColumns(that, createColumnsFromOptions(that, columns))\r\n                    }\r\n                },\r\n                updateColumns: function(dataSource, forceApplying) {\r\n                    var _this = this;\r\n                    if (!forceApplying) {\r\n                        this.updateSortingGrouping(dataSource)\r\n                    }\r\n                    if (!dataSource || dataSource.isLoaded()) {\r\n                        var sortParameters = dataSource ? dataSource.sort() || [] : this.getSortDataSourceParameters();\r\n                        var groupParameters = dataSource ? dataSource.group() || [] : this.getGroupDataSourceParameters();\r\n                        var filterParameters = null === dataSource || void 0 === dataSource ? void 0 : dataSource.lastLoadOptions().filter;\r\n                        this._customizeColumns(this._columns);\r\n                        updateIndexes(this);\r\n                        var columns = this._columns;\r\n                        return (0, _deferred.when)(this.refresh(true)).always(function() {\r\n                            if (_this._columns !== columns) {\r\n                                return\r\n                            }\r\n                            _this._updateChanges(dataSource, {\r\n                                sorting: sortParameters,\r\n                                grouping: groupParameters,\r\n                                filtering: filterParameters\r\n                            });\r\n                            fireColumnsChanged(_this)\r\n                        })\r\n                    }\r\n                },\r\n                _updateChanges: function(dataSource, parameters) {\r\n                    if (dataSource) {\r\n                        this.updateColumnDataTypes(dataSource);\r\n                        this._dataSourceApplied = true\r\n                    }\r\n                    if (!_uiGrid_core2.default.equalSortParameters(parameters.sorting, this.getSortDataSourceParameters())) {\r\n                        updateColumnChanges(this, \"sorting\")\r\n                    }\r\n                    if (!_uiGrid_core2.default.equalSortParameters(parameters.grouping, this.getGroupDataSourceParameters())) {\r\n                        updateColumnChanges(this, \"grouping\")\r\n                    }\r\n                    var dataController = this.getController(\"data\");\r\n                    if (dataController && !_uiGrid_core2.default.equalFilterParameters(parameters.filtering, dataController.getCombinedFilter())) {\r\n                        updateColumnChanges(this, \"filtering\")\r\n                    }\r\n                    updateColumnChanges(this, \"columns\")\r\n                },\r\n                updateSortingGrouping: function(dataSource, fromDataSource) {\r\n                    var that = this;\r\n                    var sortParameters;\r\n                    var isColumnsChanged;\r\n                    var updateSortGroupParameterIndexes = function(columns, sortParameters, indexParameterName) {\r\n                        (0, _iterator.each)(columns, function(index, column) {\r\n                            delete column[indexParameterName];\r\n                            if (sortParameters) {\r\n                                for (var i = 0; i < sortParameters.length; i++) {\r\n                                    var selector = sortParameters[i].selector;\r\n                                    var isExpanded = sortParameters[i].isExpanded;\r\n                                    if (selector === column.dataField || selector === column.name || selector === column.selector || selector === column.calculateCellValue || selector === column.calculateGroupValue || selector === column.calculateDisplayValue) {\r\n                                        column.sortOrder = column.sortOrder || (sortParameters[i].desc ? \"desc\" : \"asc\");\r\n                                        if (void 0 !== isExpanded) {\r\n                                            column.autoExpandGroup = isExpanded\r\n                                        }\r\n                                        column[indexParameterName] = i;\r\n                                        break\r\n                                    }\r\n                                }\r\n                            }\r\n                        })\r\n                    };\r\n                    if (dataSource) {\r\n                        sortParameters = _uiGrid_core2.default.normalizeSortingInfo(dataSource.sort());\r\n                        var groupParameters = _uiGrid_core2.default.normalizeSortingInfo(dataSource.group());\r\n                        var columnsGroupParameters = that.getGroupDataSourceParameters();\r\n                        var columnsSortParameters = that.getSortDataSourceParameters();\r\n                        if (!that._columns.length) {\r\n                            (0, _iterator.each)(groupParameters, function(index, group) {\r\n                                that._columns.push(group.selector)\r\n                            });\r\n                            (0, _iterator.each)(sortParameters, function(index, sort) {\r\n                                that._columns.push(sort.selector)\r\n                            });\r\n                            assignColumns(that, createColumnsFromOptions(that, that._columns))\r\n                        }\r\n                        if ((fromDataSource || !columnsGroupParameters && !that._hasUserState) && !_uiGrid_core2.default.equalSortParameters(groupParameters, columnsGroupParameters)) {\r\n                            updateSortGroupParameterIndexes(that._columns, groupParameters, \"groupIndex\");\r\n                            if (fromDataSource) {\r\n                                updateColumnChanges(that, \"grouping\");\r\n                                isColumnsChanged = true\r\n                            }\r\n                        }\r\n                        if ((fromDataSource || !columnsSortParameters && !that._hasUserState) && !_uiGrid_core2.default.equalSortParameters(sortParameters, columnsSortParameters)) {\r\n                            updateSortGroupParameterIndexes(that._columns, sortParameters, \"sortIndex\");\r\n                            if (fromDataSource) {\r\n                                updateColumnChanges(that, \"sorting\");\r\n                                isColumnsChanged = true\r\n                            }\r\n                        }\r\n                        if (isColumnsChanged) {\r\n                            fireColumnsChanged(that)\r\n                        }\r\n                    }\r\n                },\r\n                updateFilter: function(filter, remoteFiltering, columnIndex, filterValue) {\r\n                    var that = this;\r\n                    if (!Array.isArray(filter)) {\r\n                        return filter\r\n                    }\r\n                    filter = (0, _extend.extend)([], filter);\r\n                    columnIndex = void 0 !== filter.columnIndex ? filter.columnIndex : columnIndex;\r\n                    filterValue = void 0 !== filter.filterValue ? filter.filterValue : filterValue;\r\n                    if ((0, _type.isString)(filter[0]) && \"!\" !== filter[0]) {\r\n                        var column = that.columnOption(filter[0]);\r\n                        if (remoteFiltering) {\r\n                            if ((0, _config.default)().forceIsoDateParsing && column && column.serializeValue && filter.length > 1) {\r\n                                filter[filter.length - 1] = column.serializeValue(filter[filter.length - 1], \"filter\")\r\n                            }\r\n                        } else {\r\n                            if (column && column.selector) {\r\n                                filter[0] = column.selector;\r\n                                filter[0].columnIndex = column.index\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if ((0, _type.isFunction)(filter[0])) {\r\n                            filter[0].columnIndex = columnIndex;\r\n                            filter[0].filterValue = filterValue\r\n                        }\r\n                    }\r\n                    for (var i = 0; i < filter.length; i++) {\r\n                        filter[i] = that.updateFilter(filter[i], remoteFiltering, columnIndex, filterValue)\r\n                    }\r\n                    return filter\r\n                },\r\n                columnCount: function() {\r\n                    return this._columns ? this._columns.length : 0\r\n                },\r\n                columnOption: function(identifier, option, value, notFireEvent) {\r\n                    var that = this;\r\n                    var columns = that._columns.concat(that._commandColumns);\r\n                    var column = findColumn(columns, identifier);\r\n                    if (column) {\r\n                        if (1 === arguments.length) {\r\n                            return (0, _extend.extend)({}, column)\r\n                        }\r\n                        if ((0, _type.isString)(option)) {\r\n                            if (2 === arguments.length) {\r\n                                return columnOptionCore(that, column, option)\r\n                            } else {\r\n                                columnOptionCore(that, column, option, value, notFireEvent)\r\n                            }\r\n                        } else {\r\n                            if ((0, _type.isObject)(option)) {\r\n                                (0, _iterator.each)(option, function(optionName, value) {\r\n                                    columnOptionCore(that, column, optionName, value, notFireEvent)\r\n                                })\r\n                            }\r\n                        }\r\n                        fireColumnsChanged(that)\r\n                    }\r\n                },\r\n                clearSorting: function() {\r\n                    var that = this;\r\n                    var columnCount = this.columnCount();\r\n                    that.beginUpdate();\r\n                    for (var i = 0; i < columnCount; i++) {\r\n                        that.columnOption(i, \"sortOrder\", void 0)\r\n                    }\r\n                    that.endUpdate()\r\n                },\r\n                clearGrouping: function() {\r\n                    var that = this;\r\n                    var columnCount = this.columnCount();\r\n                    that.beginUpdate();\r\n                    for (var i = 0; i < columnCount; i++) {\r\n                        that.columnOption(i, \"groupIndex\", void 0)\r\n                    }\r\n                    that.endUpdate()\r\n                },\r\n                getVisibleIndex: function(index, rowIndex) {\r\n                    var columns = this.getVisibleColumns(rowIndex);\r\n                    for (var i = columns.length - 1; i >= 0; i--) {\r\n                        if (columns[i].index === index) {\r\n                            return i\r\n                        }\r\n                    }\r\n                    return -1\r\n                },\r\n                getVisibleColumnIndex: function(id, rowIndex) {\r\n                    var index = this.columnOption(id, \"index\");\r\n                    return this.getVisibleIndex(index, rowIndex)\r\n                },\r\n                addColumn: function(options) {\r\n                    var that = this;\r\n                    var column = createColumn(that, options);\r\n                    var index = that._columns.length;\r\n                    that._columns.push(column);\r\n                    if (column.isBand) {\r\n                        that._columns = createColumnsFromOptions(that, that._columns);\r\n                        column = that._columns[index]\r\n                    }\r\n                    column.added = options;\r\n                    updateIndexes(that, column);\r\n                    that.updateColumns(that._dataSource);\r\n                    that._checkColumns()\r\n                },\r\n                deleteColumn: function(id) {\r\n                    var that = this;\r\n                    var column = that.columnOption(id);\r\n                    if (column && column.index >= 0) {\r\n                        convertOwnerBandToColumnReference(that._columns);\r\n                        that._columns.splice(column.index, 1);\r\n                        if (column.isBand) {\r\n                            var childIndexes = that.getChildrenByBandColumn(column.index).map(function(column) {\r\n                                return column.index\r\n                            });\r\n                            that._columns = that._columns.filter(function(column) {\r\n                                return childIndexes.indexOf(column.index) < 0\r\n                            })\r\n                        }\r\n                        updateIndexes(that);\r\n                        that.updateColumns(that._dataSource)\r\n                    }\r\n                },\r\n                addCommandColumn: function(options) {\r\n                    var commandColumn = this._commandColumns.filter(function(column) {\r\n                        return column.command === options.command\r\n                    })[0];\r\n                    if (!commandColumn) {\r\n                        commandColumn = options;\r\n                        this._commandColumns.push(commandColumn)\r\n                    }\r\n                },\r\n                getUserState: function() {\r\n                    var columns = this._columns;\r\n                    var result = [];\r\n                    var i;\r\n\r\n                    function handleStateField(index, value) {\r\n                        if (void 0 !== columns[i][value]) {\r\n                            result[i][value] = columns[i][value]\r\n                        }\r\n                    }\r\n                    for (i = 0; i < columns.length; i++) {\r\n                        result[i] = {};\r\n                        (0, _iterator.each)(USER_STATE_FIELD_NAMES, handleStateField)\r\n                    }\r\n                    return result\r\n                },\r\n                setName: function(column) {\r\n                    var dataField = column.dataField;\r\n                    if (!(0, _type.isDefined)(column.name) && (0, _type.isDefined)(dataField)) {\r\n                        column.name = dataField\r\n                    }\r\n                },\r\n                setUserState: function(state) {\r\n                    var that = this;\r\n                    var dataSource = that._dataSource;\r\n                    var ignoreColumnOptionNames = that.option(\"stateStoring.ignoreColumnOptionNames\");\r\n                    null === state || void 0 === state ? void 0 : state.forEach(this.setName);\r\n                    if (!ignoreColumnOptionNames) {\r\n                        ignoreColumnOptionNames = [];\r\n                        var commonColumnSettings = that.getCommonSettings();\r\n                        if (!that.option(\"columnChooser.enabled\")) {\r\n                            ignoreColumnOptionNames.push(\"visible\")\r\n                        }\r\n                        if (\"none\" === that.option(\"sorting.mode\")) {\r\n                            ignoreColumnOptionNames.push(\"sortIndex\", \"sortOrder\")\r\n                        }\r\n                        if (!commonColumnSettings.allowGrouping) {\r\n                            ignoreColumnOptionNames.push(\"groupIndex\")\r\n                        }\r\n                        if (!commonColumnSettings.allowFixing) {\r\n                            ignoreColumnOptionNames.push(\"fixed\", \"fixedPosition\")\r\n                        }\r\n                        if (!commonColumnSettings.allowResizing) {\r\n                            ignoreColumnOptionNames.push(\"width\", \"visibleWidth\")\r\n                        }\r\n                        var isFilterPanelHidden = !that.option(\"filterPanel.visible\");\r\n                        if (!that.option(\"filterRow.visible\") && isFilterPanelHidden) {\r\n                            ignoreColumnOptionNames.push(\"filterValue\", \"selectedFilterOperation\")\r\n                        }\r\n                        if (!that.option(\"headerFilter.visible\") && isFilterPanelHidden) {\r\n                            ignoreColumnOptionNames.push(\"filterValues\", \"filterType\")\r\n                        }\r\n                    }\r\n                    that._columnsUserState = state;\r\n                    that._ignoreColumnOptionNames = ignoreColumnOptionNames;\r\n                    that._hasUserState = !!state;\r\n                    updateColumnChanges(that, \"filtering\");\r\n                    that.init();\r\n                    if (dataSource) {\r\n                        dataSource.sort(that.getSortDataSourceParameters());\r\n                        dataSource.group(that.getGroupDataSourceParameters())\r\n                    }\r\n                },\r\n                _checkColumns: function() {\r\n                    var usedNames = {};\r\n                    var hasEditableColumnWithoutName = false;\r\n                    var duplicatedNames = [];\r\n                    this._columns.forEach(function(column) {\r\n                        var _column$columns;\r\n                        var name = column.name;\r\n                        var isBand = null === (_column$columns = column.columns) || void 0 === _column$columns ? void 0 : _column$columns.length;\r\n                        var isEditable = column.allowEditing && (column.dataField || column.setCellValue) && !isBand;\r\n                        if (name) {\r\n                            if (usedNames[name]) {\r\n                                duplicatedNames.push('\"'.concat(name, '\"'))\r\n                            }\r\n                            usedNames[name] = true\r\n                        } else {\r\n                            if (isEditable) {\r\n                                hasEditableColumnWithoutName = true\r\n                            }\r\n                        }\r\n                    });\r\n                    if (duplicatedNames.length) {\r\n                        _ui.default.log(\"E1059\", duplicatedNames.join(\", \"))\r\n                    }\r\n                    if (hasEditableColumnWithoutName) {\r\n                        _ui.default.log(\"E1060\")\r\n                    }\r\n                },\r\n                _createCalculatedColumnOptions: function(columnOptions, bandColumn) {\r\n                    var calculatedColumnOptions = {};\r\n                    var dataField = columnOptions.dataField;\r\n                    if (Array.isArray(columnOptions.columns) && columnOptions.columns.length || columnOptions.isBand) {\r\n                        calculatedColumnOptions.isBand = true;\r\n                        dataField = null\r\n                    }\r\n                    if (dataField) {\r\n                        if ((0, _type.isString)(dataField)) {\r\n                            var getter = (0, _data.compileGetter)(dataField);\r\n                            calculatedColumnOptions = {\r\n                                caption: (0, _inflector.captionize)(dataField),\r\n                                calculateCellValue: function(data, skipDeserialization) {\r\n                                    var value = getter(data);\r\n                                    return this.deserializeValue && !skipDeserialization ? this.deserializeValue(value) : value\r\n                                },\r\n                                setCellValue: defaultSetCellValue,\r\n                                parseValue: function(text) {\r\n                                    var column = this;\r\n                                    var result;\r\n                                    var parsedValue;\r\n                                    if (\"number\" === column.dataType) {\r\n                                        if ((0, _type.isString)(text) && column.format) {\r\n                                            parsedValue = _number.default.parse(text);\r\n                                            if ((0, _type.isNumeric)(parsedValue)) {\r\n                                                result = parsedValue\r\n                                            }\r\n                                        } else {\r\n                                            if ((0, _type.isDefined)(text) && (0, _type.isNumeric)(text)) {\r\n                                                result = Number(text)\r\n                                            }\r\n                                        }\r\n                                    } else {\r\n                                        if (\"boolean\" === column.dataType) {\r\n                                            if (text === column.trueText) {\r\n                                                result = true\r\n                                            } else {\r\n                                                if (text === column.falseText) {\r\n                                                    result = false\r\n                                                }\r\n                                            }\r\n                                        } else {\r\n                                            if (_uiGrid_core2.default.isDateType(column.dataType)) {\r\n                                                parsedValue = _date.default.parse(text, column.format);\r\n                                                if (parsedValue) {\r\n                                                    result = parsedValue\r\n                                                }\r\n                                            } else {\r\n                                                result = text\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    return result\r\n                                }\r\n                            }\r\n                        }\r\n                        calculatedColumnOptions.allowFiltering = true\r\n                    } else {\r\n                        calculatedColumnOptions.allowFiltering = !!columnOptions.calculateFilterExpression\r\n                    }\r\n                    calculatedColumnOptions.calculateFilterExpression = function() {\r\n                        return _filtering.default.defaultCalculateFilterExpression.apply(this, arguments)\r\n                    };\r\n                    calculatedColumnOptions.createFilterExpression = function(filterValue) {\r\n                        var result;\r\n                        if (this.calculateFilterExpression) {\r\n                            result = this.calculateFilterExpression.apply(this, arguments)\r\n                        }\r\n                        if ((0, _type.isFunction)(result)) {\r\n                            result = [result, \"=\", true]\r\n                        }\r\n                        if (result) {\r\n                            result.columnIndex = this.index;\r\n                            result.filterValue = filterValue\r\n                        }\r\n                        return result\r\n                    };\r\n                    if (!dataField || !(0, _type.isString)(dataField)) {\r\n                        (0, _extend.extend)(true, calculatedColumnOptions, {\r\n                            allowSorting: false,\r\n                            allowGrouping: false,\r\n                            calculateCellValue: function() {\r\n                                return null\r\n                            }\r\n                        })\r\n                    }\r\n                    if (bandColumn) {\r\n                        calculatedColumnOptions.allowFixing = false\r\n                    }\r\n                    if (columnOptions.dataType) {\r\n                        calculatedColumnOptions.userDataType = columnOptions.dataType\r\n                    }\r\n                    if (columnOptions.selectedFilterOperation && !(\"defaultSelectedFilterOperation\" in calculatedColumnOptions)) {\r\n                        calculatedColumnOptions.defaultSelectedFilterOperation = columnOptions.selectedFilterOperation\r\n                    }\r\n                    if (columnOptions.lookup) {\r\n                        calculatedColumnOptions.lookup = {\r\n                            calculateCellValue: function(value, skipDeserialization) {\r\n                                if (this.valueExpr) {\r\n                                    value = this.valueMap && this.valueMap[value]\r\n                                }\r\n                                return this.deserializeValue && !skipDeserialization ? this.deserializeValue(value) : value\r\n                            },\r\n                            updateValueMap: function() {\r\n                                this.valueMap = {};\r\n                                if (this.items) {\r\n                                    var calculateValue = (0, _data.compileGetter)(this.valueExpr);\r\n                                    var calculateDisplayValue = (0, _data.compileGetter)(this.displayExpr);\r\n                                    for (var i = 0; i < this.items.length; i++) {\r\n                                        var item = this.items[i];\r\n                                        var displayValue = calculateDisplayValue(item);\r\n                                        this.valueMap[calculateValue(item)] = displayValue;\r\n                                        this.dataType = this.dataType || getValueDataType(displayValue)\r\n                                    }\r\n                                }\r\n                            },\r\n                            update: function() {\r\n                                var that = this;\r\n                                var dataSource = that.dataSource;\r\n                                if (dataSource) {\r\n                                    if ((0, _type.isFunction)(dataSource) && !_variable_wrapper.default.isWrapped(dataSource)) {\r\n                                        dataSource = dataSource({})\r\n                                    }\r\n                                    if ((0, _type.isPlainObject)(dataSource) || dataSource instanceof _abstract_store.default || Array.isArray(dataSource)) {\r\n                                        if (that.valueExpr) {\r\n                                            var dataSourceOptions = (0, _utils.normalizeDataSourceOptions)(dataSource);\r\n                                            dataSourceOptions.paginate = false;\r\n                                            dataSource = new _data_source.DataSource(dataSourceOptions);\r\n                                            return dataSource.load().done(function(data) {\r\n                                                that.items = data;\r\n                                                that.updateValueMap && that.updateValueMap()\r\n                                            })\r\n                                        }\r\n                                    } else {\r\n                                        _ui.default.log(\"E1016\")\r\n                                    }\r\n                                } else {\r\n                                    that.updateValueMap && that.updateValueMap()\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    calculatedColumnOptions.resizedCallbacks = (0, _callbacks.default)();\r\n                    if (columnOptions.resized) {\r\n                        calculatedColumnOptions.resizedCallbacks.add(columnOptions.resized.bind(columnOptions))\r\n                    }(0, _iterator.each)(calculatedColumnOptions, function(optionName) {\r\n                        if ((0, _type.isFunction)(calculatedColumnOptions[optionName]) && 0 !== optionName.indexOf(\"default\")) {\r\n                            var defaultOptionName = \"default\" + optionName.charAt(0).toUpperCase() + optionName.substr(1);\r\n                            calculatedColumnOptions[defaultOptionName] = calculatedColumnOptions[optionName]\r\n                        }\r\n                    });\r\n                    return calculatedColumnOptions\r\n                },\r\n                getRowCount: function() {\r\n                    this._rowCount = this._rowCount || _getRowCount(this);\r\n                    return this._rowCount\r\n                },\r\n                getRowIndex: function(columnIndex, alwaysGetRowIndex) {\r\n                    var column = this._columns[columnIndex];\r\n                    var bandColumnsCache = this.getBandColumnsCache();\r\n                    return column && (alwaysGetRowIndex || column.visible && !(column.command || (0, _type.isDefined)(column.groupIndex))) ? getParentBandColumns(columnIndex, bandColumnsCache.columnParentByIndex).length : 0\r\n                },\r\n                getChildrenByBandColumn: function(bandColumnIndex, onlyVisibleDirectChildren) {\r\n                    var that = this;\r\n                    var bandColumnsCache = that.getBandColumnsCache();\r\n                    var result = _getChildrenByBandColumn(bandColumnIndex, bandColumnsCache.columnChildrenByIndex, !onlyVisibleDirectChildren);\r\n                    if (onlyVisibleDirectChildren) {\r\n                        return result.filter(function(column) {\r\n                            return column.visible && !column.command\r\n                        }).sort(function(column1, column2) {\r\n                            return column1.visibleIndex - column2.visibleIndex\r\n                        })\r\n                    }\r\n                    return result\r\n                },\r\n                isParentBandColumn: function(columnIndex, bandColumnIndex) {\r\n                    var result = false;\r\n                    var column = this._columns[columnIndex];\r\n                    var bandColumnsCache = this.getBandColumnsCache();\r\n                    var parentBandColumns = column && getParentBandColumns(columnIndex, bandColumnsCache.columnParentByIndex);\r\n                    if (parentBandColumns) {\r\n                        (0, _iterator.each)(parentBandColumns, function(_, bandColumn) {\r\n                            if (bandColumn.index === bandColumnIndex) {\r\n                                result = true;\r\n                                return false\r\n                            }\r\n                        })\r\n                    }\r\n                    return result\r\n                },\r\n                isParentColumnVisible: function(columnIndex) {\r\n                    var result = true;\r\n                    var bandColumnsCache = this.getBandColumnsCache();\r\n                    var bandColumns = columnIndex >= 0 && getParentBandColumns(columnIndex, bandColumnsCache.columnParentByIndex);\r\n                    bandColumns && (0, _iterator.each)(bandColumns, function(_, bandColumn) {\r\n                        result = result && bandColumn.visible;\r\n                        return result\r\n                    });\r\n                    return result\r\n                },\r\n                getColumnId: function(column) {\r\n                    if (column.command && column.type === GROUP_COMMAND_COLUMN_NAME) {\r\n                        if (isCustomCommandColumn(this, column)) {\r\n                            return \"type:\" + column.type\r\n                        }\r\n                        return \"command:\" + column.command\r\n                    }\r\n                    return column.index\r\n                },\r\n                getCustomizeTextByDataType: getCustomizeTextByDataType,\r\n                getHeaderContentAlignment: function(columnAlignment) {\r\n                    var rtlEnabled = this.option(\"rtlEnabled\");\r\n                    if (rtlEnabled) {\r\n                        return \"left\" === columnAlignment ? \"right\" : \"left\"\r\n                    }\r\n                    return columnAlignment\r\n                }\r\n            }\r\n        }())\r\n    }\r\n};\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}