{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.editor_factory.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\n\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\n\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.modules\"));\n\nvar _click = require(\"../../events/click\");\n\nvar _pointer = _interopRequireDefault(require(\"../../events/pointer\"));\n\nvar _position = _interopRequireDefault(require(\"../../animation/position\"));\n\nvar _index = require(\"../../events/utils/index\");\n\nvar _browser = _interopRequireDefault(require(\"../../core/utils/browser\"));\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _position2 = require(\"../../core/utils/position\");\n\nvar _ui = _interopRequireDefault(require(\"../shared/ui.editor_factory_mixin\"));\n\nvar _uiGrid_core2 = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar EDITOR_INLINE_BLOCK = \"dx-editor-inline-block\";\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar FOCUS_OVERLAY_CLASS = \"focus-overlay\";\nvar CONTENT_CLASS = \"content\";\nvar FOCUSED_ELEMENT_CLASS = \"dx-focused\";\nvar ROW_CLASS = \"dx-row\";\nvar MODULE_NAMESPACE = \"dxDataGridEditorFactory\";\nvar UPDATE_FOCUS_EVENTS = (0, _index.addNamespace)([_pointer.default.down, \"focusin\", _click.name].join(\" \"), MODULE_NAMESPACE);\nvar DX_HIDDEN = \"dx-hidden\";\n\nvar EditorFactory = _uiGrid_core.default.ViewController.inherit({\n  _getFocusedElement: function ($dataGridElement) {\n    var rowSelector = this.option(\"focusedRowEnabled\") ? \"tr[tabindex]:focus\" : \"tr[tabindex]:not(.dx-data-row):focus\";\n    var focusedElementSelector = \"td[tabindex]:focus, \".concat(rowSelector, \", input:focus, textarea:focus, .dx-lookup-field:focus, .dx-checkbox:focus, .dx-switch:focus, .dx-dropdownbutton:focus\");\n    return $dataGridElement.find(focusedElementSelector);\n  },\n  _getFocusCellSelector: function () {\n    return \".dx-row > td\";\n  },\n  _updateFocusCore: function () {\n    var $focus = this._$focusedElement;\n    var $dataGridElement = this.component && this.component.$element();\n    var $focusCell;\n    var hideBorders;\n\n    if ($dataGridElement) {\n      $focus = this._getFocusedElement($dataGridElement);\n\n      if ($focus.length) {\n        if (!$focus.hasClass(CELL_FOCUS_DISABLED_CLASS) && !$focus.hasClass(ROW_CLASS)) {\n          $focusCell = $focus.closest(this._getFocusCellSelector() + \", .\" + CELL_FOCUS_DISABLED_CLASS);\n          hideBorders = $focusCell.get(0) !== $focus.get(0) && $focusCell.hasClass(EDITOR_INLINE_BLOCK);\n          $focus = $focusCell;\n        }\n\n        if ($focus.length && !$focus.hasClass(CELL_FOCUS_DISABLED_CLASS)) {\n          this.focus($focus, hideBorders);\n          return;\n        }\n      }\n    }\n\n    this.loseFocus();\n  },\n  _updateFocus: function (e) {\n    var that = this;\n    var isFocusOverlay = e && e.event && (0, _renderer.default)(e.event.target).hasClass(that.addWidgetPrefix(FOCUS_OVERLAY_CLASS));\n    that._isFocusOverlay = that._isFocusOverlay || isFocusOverlay;\n    clearTimeout(that._updateFocusTimeoutID);\n    that._updateFocusTimeoutID = setTimeout(function () {\n      delete that._updateFocusTimeoutID;\n\n      if (!that._isFocusOverlay) {\n        that._updateFocusCore();\n      }\n\n      that._isFocusOverlay = false;\n    });\n  },\n  _updateFocusOverlaySize: function ($element, position) {\n    $element.hide();\n\n    var location = _position.default.calculate($element, (0, _extend.extend)({\n      collision: \"fit\"\n    }, position));\n\n    if (location.h.oversize > 0) {\n      $element.outerWidth($element.outerWidth() - location.h.oversize);\n    }\n\n    if (location.v.oversize > 0) {\n      $element.outerHeight($element.outerHeight() - location.v.oversize);\n    }\n\n    $element.show();\n  },\n  callbackNames: function () {\n    return [\"focused\"];\n  },\n  focus: function ($element, hideBorder) {\n    var that = this;\n\n    if (void 0 === $element) {\n      return that._$focusedElement;\n    } else {\n      if ($element) {\n        if (!$element.is(that._$focusedElement)) {\n          that._$focusedElement && that._$focusedElement.removeClass(FOCUSED_ELEMENT_CLASS);\n        }\n\n        that._$focusedElement = $element;\n        clearTimeout(that._focusTimeoutID);\n        that._focusTimeoutID = setTimeout(function () {\n          delete that._focusTimeoutID;\n          that.renderFocusOverlay($element, hideBorder);\n          $element.addClass(FOCUSED_ELEMENT_CLASS);\n          that.focused.fire($element);\n        });\n      }\n    }\n  },\n  refocus: function () {\n    var $focus = this.focus();\n    this.focus($focus);\n  },\n  renderFocusOverlay: function ($element, hideBorder) {\n    var that = this;\n\n    if (!_uiGrid_core2.default.isElementInCurrentGrid(this, $element)) {\n      return;\n    }\n\n    if (!that._$focusOverlay) {\n      that._$focusOverlay = (0, _renderer.default)(\"<div>\").addClass(that.addWidgetPrefix(FOCUS_OVERLAY_CLASS));\n    }\n\n    if (hideBorder) {\n      that._$focusOverlay.addClass(DX_HIDDEN);\n    } else {\n      if ($element.length) {\n        var align = _browser.default.msie ? \"left bottom\" : _browser.default.mozilla ? \"right bottom\" : \"left top\";\n        var $content = $element.closest(\".\" + that.addWidgetPrefix(CONTENT_CLASS));\n        var elemCoord = (0, _position2.getBoundingRect)($element.get(0));\n\n        that._$focusOverlay.removeClass(DX_HIDDEN).appendTo($content).outerWidth(elemCoord.right - elemCoord.left + 1).outerHeight(elemCoord.bottom - elemCoord.top + 1);\n\n        var focusOverlayPosition = {\n          precise: true,\n          my: align,\n          at: align,\n          of: $element,\n          boundary: $content.length && $content\n        };\n\n        that._updateFocusOverlaySize(that._$focusOverlay, focusOverlayPosition);\n\n        _position.default.setup(that._$focusOverlay, focusOverlayPosition);\n\n        that._$focusOverlay.css(\"visibility\", \"visible\");\n      }\n    }\n  },\n  resize: function () {\n    var $focusedElement = this._$focusedElement;\n\n    if ($focusedElement) {\n      this.focus($focusedElement);\n    }\n  },\n  loseFocus: function () {\n    this._$focusedElement && this._$focusedElement.removeClass(FOCUSED_ELEMENT_CLASS);\n    this._$focusedElement = null;\n    this._$focusOverlay && this._$focusOverlay.addClass(DX_HIDDEN);\n  },\n  init: function () {\n    this.createAction(\"onEditorPreparing\", {\n      excludeValidators: [\"disabled\", \"readOnly\"],\n      category: \"rendering\"\n    });\n    this.createAction(\"onEditorPrepared\", {\n      excludeValidators: [\"disabled\", \"readOnly\"],\n      category: \"rendering\"\n    });\n    this._updateFocusHandler = this._updateFocusHandler || this.createAction(this._updateFocus.bind(this));\n\n    _events_engine.default.on(_dom_adapter.default.getDocument(), UPDATE_FOCUS_EVENTS, this._updateFocusHandler);\n\n    this._attachContainerEventHandlers();\n  },\n  _attachContainerEventHandlers: function () {\n    var that = this;\n    var $container = that.component && that.component.$element();\n\n    if ($container) {\n      _events_engine.default.on($container, (0, _index.addNamespace)(\"keydown\", MODULE_NAMESPACE), function (e) {\n        if (\"tab\" === (0, _index.normalizeKeyName)(e)) {\n          that._updateFocusHandler(e);\n        }\n      });\n    }\n  },\n  dispose: function () {\n    clearTimeout(this._focusTimeoutID);\n    clearTimeout(this._updateFocusTimeoutID);\n\n    _events_engine.default.off(_dom_adapter.default.getDocument(), UPDATE_FOCUS_EVENTS, this._updateFocusHandler);\n  }\n}).include(_ui.default);\n\nvar _default = {\n  defaultOptions: function () {\n    return {};\n  },\n  controllers: {\n    editorFactory: EditorFactory\n  }\n};\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["C:/Users/CapiniaC/Desktop/Collection/Work/project/security/node_modules/devextreme/ui/grid_core/ui.grid_core.editor_factory.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_dom_adapter","_events_engine","_uiGrid_core","_click","_pointer","_position","_index","_browser","_extend","_position2","_ui","_uiGrid_core2","obj","__esModule","EDITOR_INLINE_BLOCK","CELL_FOCUS_DISABLED_CLASS","FOCUS_OVERLAY_CLASS","CONTENT_CLASS","FOCUSED_ELEMENT_CLASS","ROW_CLASS","MODULE_NAMESPACE","UPDATE_FOCUS_EVENTS","addNamespace","down","name","join","DX_HIDDEN","EditorFactory","ViewController","inherit","_getFocusedElement","$dataGridElement","rowSelector","option","focusedElementSelector","concat","find","_getFocusCellSelector","_updateFocusCore","$focus","_$focusedElement","component","$element","$focusCell","hideBorders","length","hasClass","closest","get","focus","loseFocus","_updateFocus","e","that","isFocusOverlay","event","target","addWidgetPrefix","_isFocusOverlay","clearTimeout","_updateFocusTimeoutID","setTimeout","_updateFocusOverlaySize","position","hide","location","calculate","extend","collision","h","oversize","outerWidth","v","outerHeight","show","callbackNames","hideBorder","is","removeClass","_focusTimeoutID","renderFocusOverlay","addClass","focused","fire","refocus","isElementInCurrentGrid","_$focusOverlay","align","msie","mozilla","$content","elemCoord","getBoundingRect","appendTo","right","left","bottom","top","focusOverlayPosition","precise","my","at","of","boundary","setup","css","resize","$focusedElement","init","createAction","excludeValidators","category","_updateFocusHandler","bind","on","getDocument","_attachContainerEventHandlers","$container","normalizeKeyName","dispose","off","include","_default","defaultOptions","controllers","editorFactory","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.editor_factory.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\r\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\r\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.modules\"));\r\nvar _click = require(\"../../events/click\");\r\nvar _pointer = _interopRequireDefault(require(\"../../events/pointer\"));\r\nvar _position = _interopRequireDefault(require(\"../../animation/position\"));\r\nvar _index = require(\"../../events/utils/index\");\r\nvar _browser = _interopRequireDefault(require(\"../../core/utils/browser\"));\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _position2 = require(\"../../core/utils/position\");\r\nvar _ui = _interopRequireDefault(require(\"../shared/ui.editor_factory_mixin\"));\r\nvar _uiGrid_core2 = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar EDITOR_INLINE_BLOCK = \"dx-editor-inline-block\";\r\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar FOCUS_OVERLAY_CLASS = \"focus-overlay\";\r\nvar CONTENT_CLASS = \"content\";\r\nvar FOCUSED_ELEMENT_CLASS = \"dx-focused\";\r\nvar ROW_CLASS = \"dx-row\";\r\nvar MODULE_NAMESPACE = \"dxDataGridEditorFactory\";\r\nvar UPDATE_FOCUS_EVENTS = (0, _index.addNamespace)([_pointer.default.down, \"focusin\", _click.name].join(\" \"), MODULE_NAMESPACE);\r\nvar DX_HIDDEN = \"dx-hidden\";\r\nvar EditorFactory = _uiGrid_core.default.ViewController.inherit({\r\n    _getFocusedElement: function($dataGridElement) {\r\n        var rowSelector = this.option(\"focusedRowEnabled\") ? \"tr[tabindex]:focus\" : \"tr[tabindex]:not(.dx-data-row):focus\";\r\n        var focusedElementSelector = \"td[tabindex]:focus, \".concat(rowSelector, \", input:focus, textarea:focus, .dx-lookup-field:focus, .dx-checkbox:focus, .dx-switch:focus, .dx-dropdownbutton:focus\");\r\n        return $dataGridElement.find(focusedElementSelector)\r\n    },\r\n    _getFocusCellSelector: function() {\r\n        return \".dx-row > td\"\r\n    },\r\n    _updateFocusCore: function() {\r\n        var $focus = this._$focusedElement;\r\n        var $dataGridElement = this.component && this.component.$element();\r\n        var $focusCell;\r\n        var hideBorders;\r\n        if ($dataGridElement) {\r\n            $focus = this._getFocusedElement($dataGridElement);\r\n            if ($focus.length) {\r\n                if (!$focus.hasClass(CELL_FOCUS_DISABLED_CLASS) && !$focus.hasClass(ROW_CLASS)) {\r\n                    $focusCell = $focus.closest(this._getFocusCellSelector() + \", .\" + CELL_FOCUS_DISABLED_CLASS);\r\n                    hideBorders = $focusCell.get(0) !== $focus.get(0) && $focusCell.hasClass(EDITOR_INLINE_BLOCK);\r\n                    $focus = $focusCell\r\n                }\r\n                if ($focus.length && !$focus.hasClass(CELL_FOCUS_DISABLED_CLASS)) {\r\n                    this.focus($focus, hideBorders);\r\n                    return\r\n                }\r\n            }\r\n        }\r\n        this.loseFocus()\r\n    },\r\n    _updateFocus: function(e) {\r\n        var that = this;\r\n        var isFocusOverlay = e && e.event && (0, _renderer.default)(e.event.target).hasClass(that.addWidgetPrefix(FOCUS_OVERLAY_CLASS));\r\n        that._isFocusOverlay = that._isFocusOverlay || isFocusOverlay;\r\n        clearTimeout(that._updateFocusTimeoutID);\r\n        that._updateFocusTimeoutID = setTimeout(function() {\r\n            delete that._updateFocusTimeoutID;\r\n            if (!that._isFocusOverlay) {\r\n                that._updateFocusCore()\r\n            }\r\n            that._isFocusOverlay = false\r\n        })\r\n    },\r\n    _updateFocusOverlaySize: function($element, position) {\r\n        $element.hide();\r\n        var location = _position.default.calculate($element, (0, _extend.extend)({\r\n            collision: \"fit\"\r\n        }, position));\r\n        if (location.h.oversize > 0) {\r\n            $element.outerWidth($element.outerWidth() - location.h.oversize)\r\n        }\r\n        if (location.v.oversize > 0) {\r\n            $element.outerHeight($element.outerHeight() - location.v.oversize)\r\n        }\r\n        $element.show()\r\n    },\r\n    callbackNames: function() {\r\n        return [\"focused\"]\r\n    },\r\n    focus: function($element, hideBorder) {\r\n        var that = this;\r\n        if (void 0 === $element) {\r\n            return that._$focusedElement\r\n        } else {\r\n            if ($element) {\r\n                if (!$element.is(that._$focusedElement)) {\r\n                    that._$focusedElement && that._$focusedElement.removeClass(FOCUSED_ELEMENT_CLASS)\r\n                }\r\n                that._$focusedElement = $element;\r\n                clearTimeout(that._focusTimeoutID);\r\n                that._focusTimeoutID = setTimeout(function() {\r\n                    delete that._focusTimeoutID;\r\n                    that.renderFocusOverlay($element, hideBorder);\r\n                    $element.addClass(FOCUSED_ELEMENT_CLASS);\r\n                    that.focused.fire($element)\r\n                })\r\n            }\r\n        }\r\n    },\r\n    refocus: function() {\r\n        var $focus = this.focus();\r\n        this.focus($focus)\r\n    },\r\n    renderFocusOverlay: function($element, hideBorder) {\r\n        var that = this;\r\n        if (!_uiGrid_core2.default.isElementInCurrentGrid(this, $element)) {\r\n            return\r\n        }\r\n        if (!that._$focusOverlay) {\r\n            that._$focusOverlay = (0, _renderer.default)(\"<div>\").addClass(that.addWidgetPrefix(FOCUS_OVERLAY_CLASS))\r\n        }\r\n        if (hideBorder) {\r\n            that._$focusOverlay.addClass(DX_HIDDEN)\r\n        } else {\r\n            if ($element.length) {\r\n                var align = _browser.default.msie ? \"left bottom\" : _browser.default.mozilla ? \"right bottom\" : \"left top\";\r\n                var $content = $element.closest(\".\" + that.addWidgetPrefix(CONTENT_CLASS));\r\n                var elemCoord = (0, _position2.getBoundingRect)($element.get(0));\r\n                that._$focusOverlay.removeClass(DX_HIDDEN).appendTo($content).outerWidth(elemCoord.right - elemCoord.left + 1).outerHeight(elemCoord.bottom - elemCoord.top + 1);\r\n                var focusOverlayPosition = {\r\n                    precise: true,\r\n                    my: align,\r\n                    at: align,\r\n                    of: $element,\r\n                    boundary: $content.length && $content\r\n                };\r\n                that._updateFocusOverlaySize(that._$focusOverlay, focusOverlayPosition);\r\n                _position.default.setup(that._$focusOverlay, focusOverlayPosition);\r\n                that._$focusOverlay.css(\"visibility\", \"visible\")\r\n            }\r\n        }\r\n    },\r\n    resize: function() {\r\n        var $focusedElement = this._$focusedElement;\r\n        if ($focusedElement) {\r\n            this.focus($focusedElement)\r\n        }\r\n    },\r\n    loseFocus: function() {\r\n        this._$focusedElement && this._$focusedElement.removeClass(FOCUSED_ELEMENT_CLASS);\r\n        this._$focusedElement = null;\r\n        this._$focusOverlay && this._$focusOverlay.addClass(DX_HIDDEN)\r\n    },\r\n    init: function() {\r\n        this.createAction(\"onEditorPreparing\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"],\r\n            category: \"rendering\"\r\n        });\r\n        this.createAction(\"onEditorPrepared\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"],\r\n            category: \"rendering\"\r\n        });\r\n        this._updateFocusHandler = this._updateFocusHandler || this.createAction(this._updateFocus.bind(this));\r\n        _events_engine.default.on(_dom_adapter.default.getDocument(), UPDATE_FOCUS_EVENTS, this._updateFocusHandler);\r\n        this._attachContainerEventHandlers()\r\n    },\r\n    _attachContainerEventHandlers: function() {\r\n        var that = this;\r\n        var $container = that.component && that.component.$element();\r\n        if ($container) {\r\n            _events_engine.default.on($container, (0, _index.addNamespace)(\"keydown\", MODULE_NAMESPACE), function(e) {\r\n                if (\"tab\" === (0, _index.normalizeKeyName)(e)) {\r\n                    that._updateFocusHandler(e)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    dispose: function() {\r\n        clearTimeout(this._focusTimeoutID);\r\n        clearTimeout(this._updateFocusTimeoutID);\r\n        _events_engine.default.off(_dom_adapter.default.getDocument(), UPDATE_FOCUS_EVENTS, this._updateFocusHandler)\r\n    }\r\n}).include(_ui.default);\r\nvar _default = {\r\n    defaultOptions: function() {\r\n        return {}\r\n    },\r\n    controllers: {\r\n        editorFactory: EditorFactory\r\n    }\r\n};\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}