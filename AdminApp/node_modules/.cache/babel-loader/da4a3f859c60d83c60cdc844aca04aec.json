{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.modules\"));\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _position = require(\"../../core/utils/position\");\n\nvar _uiGrid_core2 = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\n\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\n\nvar _browser = _interopRequireDefault(require(\"../../core/utils/browser\"));\n\nvar accessibility = _interopRequireWildcard(require(\"../shared/accessibility\"));\n\nfunction _getRequireWildcardCache() {\n  if (\"function\" !== typeof WeakMap) {\n    return null;\n  }\n\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (null === obj || \"object\" !== _typeof(obj) && \"function\" !== typeof obj) {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TABLE_CLASS = \"table\";\nvar BORDERS_CLASS = \"borders\";\nvar TABLE_FIXED_CLASS = \"table-fixed\";\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\nvar TEXT_CONTENT_CLASS = \"text-content\";\nvar HIDDEN_CLASS = \"dx-hidden\";\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\nvar EDITORS_INPUT_SELECTOR = \"input:not([type='hidden'])\";\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\n\nvar isPercentWidth = function (width) {\n  return (0, _type.isString)(width) && \"%\" === width.slice(-1);\n};\n\nvar isPixelWidth = function (width) {\n  return (0, _type.isString)(width) && \"px\" === width.slice(-2);\n};\n\nvar mergeArraysByMaxValue = function (values1, values2) {\n  var result = [];\n\n  if (values1 && values2 && values1.length && values1.length === values2.length) {\n    for (var i = 0; i < values1.length; i++) {\n      result.push(values1[i] > values2[i] ? values1[i] : values2[i]);\n    }\n  } else {\n    if (values1 && values1.length) {\n      result = values1;\n    } else {\n      if (values2) {\n        result = values2;\n      }\n    }\n  }\n\n  return result;\n};\n\nvar getContainerHeight = function ($container) {\n  var clientHeight = $container.get(0).clientHeight;\n  var paddingTop = parseFloat($container.css(\"paddingTop\"));\n  var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\n  return clientHeight - paddingTop - paddingBottom;\n};\n\nvar calculateFreeWidth = function (that, widths) {\n  var contentWidth = that._rowsView.contentWidth();\n\n  var totalWidth = that._getTotalWidth(widths, contentWidth);\n\n  return contentWidth - totalWidth;\n};\n\nvar calculateFreeWidthWithCurrentMinWidth = function (that, columnIndex, currentMinWidth, widths) {\n  return calculateFreeWidth(that, widths.map(function (width, index) {\n    return index === columnIndex ? currentMinWidth : width;\n  }));\n};\n\nvar restoreFocus = function (focusedElement, selectionRange) {\n  accessibility.hiddenFocus(focusedElement);\n\n  _uiGrid_core2.default.setSelectionRange(focusedElement, selectionRange);\n};\n\nvar ResizingController = _uiGrid_core.default.ViewController.inherit({\n  _initPostRenderHandlers: function () {\n    var that = this;\n    var dataController = that._dataController;\n\n    if (!that._refreshSizesHandler) {\n      that._refreshSizesHandler = function (e) {\n        dataController.changed.remove(that._refreshSizesHandler);\n        var resizeDeferred;\n        var changeType = e && e.changeType;\n        var isDelayed = e && e.isDelayed;\n        var items = dataController.items();\n\n        if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\n          if (!isDelayed) {\n            resizeDeferred = that.resize();\n          }\n        } else {\n          if (\"update\" === changeType && e.changeTypes) {\n            if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\n              (0, _common.deferUpdate)(function () {\n                that._rowsView.resize();\n              });\n            } else {\n              resizeDeferred = that.resize();\n            }\n          }\n        }\n\n        if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && !isDelayed) {\n          (0, _deferred.when)(resizeDeferred).done(function () {\n            that._setAriaRowColCount();\n\n            that.fireContentReadyAction();\n          });\n        }\n      };\n\n      that._dataController.changed.add(function () {\n        that._dataController.changed.add(that._refreshSizesHandler);\n      });\n    }\n  },\n  fireContentReadyAction: function () {\n    this.component._fireContentReadyAction();\n  },\n  _setAriaRowColCount: function () {\n    var component = this.component;\n    component.setAria({\n      rowCount: this._dataController.totalItemsCount(),\n      colCount: component.columnCount()\n    }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS));\n  },\n  _getBestFitWidths: function () {\n    var _this$_footerView;\n\n    var rowsView = this._rowsView;\n    var columnHeadersView = this._columnHeadersView;\n\n    if (!this.option(\"legacyRendering\")) {\n      var _widths;\n\n      var widths = rowsView.getColumnWidths();\n\n      if (!(null !== (_widths = widths) && void 0 !== _widths && _widths.length)) {\n        var _rowsView$getTableEle;\n\n        var headersTableElement = columnHeadersView.getTableElement();\n        columnHeadersView.setTableElement(null === (_rowsView$getTableEle = rowsView.getTableElement()) || void 0 === _rowsView$getTableEle ? void 0 : _rowsView$getTableEle.children(\".dx-header\"));\n        widths = columnHeadersView.getColumnWidths();\n        columnHeadersView.setTableElement(headersTableElement);\n      }\n\n      return widths;\n    }\n\n    var rowsColumnWidths = rowsView.getColumnWidths();\n    var headerColumnWidths = null === columnHeadersView || void 0 === columnHeadersView ? void 0 : columnHeadersView.getColumnWidths();\n    var footerColumnWidths = null === (_this$_footerView = this._footerView) || void 0 === _this$_footerView ? void 0 : _this$_footerView.getColumnWidths();\n    var resultWidths = mergeArraysByMaxValue(rowsColumnWidths, headerColumnWidths);\n    resultWidths = mergeArraysByMaxValue(resultWidths, footerColumnWidths);\n    return resultWidths;\n  },\n  _setVisibleWidths: function (visibleColumns, widths) {\n    var columnsController = this._columnsController;\n    columnsController.beginUpdate();\n    (0, _iterator.each)(visibleColumns, function (index, column) {\n      var columnId = columnsController.getColumnId(column);\n      columnsController.columnOption(columnId, \"visibleWidth\", widths[index]);\n    });\n    columnsController.endUpdate();\n  },\n  _toggleBestFitModeForView: function (view, className, isBestFit) {\n    var _this = this;\n\n    if (!view || !view.isVisible()) {\n      return;\n    }\n\n    var $rowsTables = this._rowsView.getTableElements();\n\n    var $viewTables = view.getTableElements();\n    (0, _iterator.each)($rowsTables, function (index, tableElement) {\n      var $tableBody;\n      var $rowsTable = (0, _renderer.default)(tableElement);\n      var $viewTable = $viewTables.eq(index);\n\n      if ($viewTable && $viewTable.length) {\n        if (isBestFit) {\n          $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable);\n        } else {\n          $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable);\n        }\n\n        $tableBody.toggleClass(className, isBestFit);\n        $tableBody.toggleClass(_this.addWidgetPrefix(\"best-fit\"), isBestFit);\n      }\n    });\n  },\n  _toggleBestFitMode: function (isBestFit) {\n    var $element = this.component.$element();\n    var that = this;\n\n    if (!that.option(\"legacyRendering\")) {\n      var $rowsTable = that._rowsView.getTableElement();\n\n      var $rowsFixedTable = that._rowsView.getTableElements().eq(1);\n\n      if (!$rowsTable) {\n        return;\n      }\n\n      $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\n      $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\n      $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n\n      that._toggleBestFitModeForView(that._columnHeadersView, \"dx-header\", isBestFit);\n\n      that._toggleBestFitModeForView(that._footerView, \"dx-footer\", isBestFit);\n\n      if (that._needStretch()) {\n        $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\";\n      }\n\n      if (_browser.default.msie && 11 === parseInt(_browser.default.version)) {\n        $rowsTable.find(\".\" + this.addWidgetPrefix(TABLE_FIXED_CLASS)).each(function () {\n          this.style.width = isBestFit ? \"10px\" : \"\";\n        });\n      }\n    } else {\n      $element.find(\".\" + this.addWidgetPrefix(TABLE_CLASS)).toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n      $element.find(EDITORS_INPUT_SELECTOR).toggleClass(HIDDEN_CLASS, isBestFit);\n      $element.find(\".dx-group-cell\").toggleClass(HIDDEN_CLASS, isBestFit);\n      $element.find(\".dx-header-row .\" + this.addWidgetPrefix(TEXT_CONTENT_CLASS)).css(\"maxWidth\", \"\");\n    }\n  },\n  _synchronizeColumns: function () {\n    var that = this;\n    var columnsController = that._columnsController;\n    var visibleColumns = columnsController.getVisibleColumns();\n    var columnAutoWidth = that.option(\"columnAutoWidth\");\n    var legacyRendering = that.option(\"legacyRendering\");\n\n    var needBestFit = that._needBestFit();\n\n    var hasMinWidth = false;\n    var resetBestFitMode;\n    var isColumnWidthsCorrected = false;\n    var resultWidths = [];\n    var focusedElement;\n    var selectionRange;\n\n    var normalizeWidthsByExpandColumns = function () {\n      var expandColumnWidth;\n      (0, _iterator.each)(visibleColumns, function (index, column) {\n        if (\"groupExpand\" === column.type) {\n          expandColumnWidth = resultWidths[index];\n        }\n      });\n      (0, _iterator.each)(visibleColumns, function (index, column) {\n        if (\"groupExpand\" === column.type && expandColumnWidth) {\n          resultWidths[index] = expandColumnWidth;\n        }\n      });\n    };\n\n    !needBestFit && (0, _iterator.each)(visibleColumns, function (index, column) {\n      if (\"auto\" === column.width || legacyRendering && column.fixed) {\n        needBestFit = true;\n        return false;\n      }\n    });\n    (0, _iterator.each)(visibleColumns, function (index, column) {\n      if (column.minWidth) {\n        hasMinWidth = true;\n        return false;\n      }\n    });\n\n    that._setVisibleWidths(visibleColumns, []);\n\n    if (needBestFit) {\n      focusedElement = _dom_adapter.default.getActiveElement();\n      selectionRange = _uiGrid_core2.default.getSelectionRange(focusedElement);\n\n      that._toggleBestFitMode(true);\n\n      resetBestFitMode = true;\n    }\n\n    (0, _common.deferUpdate)(function () {\n      if (needBestFit) {\n        resultWidths = that._getBestFitWidths();\n        (0, _iterator.each)(visibleColumns, function (index, column) {\n          var columnId = columnsController.getColumnId(column);\n          columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true);\n        });\n      } else {\n        if (hasMinWidth) {\n          resultWidths = that._getBestFitWidths();\n        }\n      }\n\n      (0, _iterator.each)(visibleColumns, function (index) {\n        var width = this.width;\n\n        if (\"auto\" !== width) {\n          if ((0, _type.isDefined)(width)) {\n            resultWidths[index] = (0, _type.isNumeric)(width) || isPixelWidth(width) ? parseFloat(width) : width;\n          } else {\n            if (!columnAutoWidth) {\n              resultWidths[index] = void 0;\n            }\n          }\n        }\n      });\n\n      if (resetBestFitMode) {\n        that._toggleBestFitMode(false);\n\n        resetBestFitMode = false;\n\n        if (focusedElement && focusedElement !== _dom_adapter.default.getActiveElement()) {\n          var isFocusOutsideWindow = (0, _position.getBoundingRect)(focusedElement).bottom < 0;\n\n          if (!isFocusOutsideWindow) {\n            if (_browser.default.msie) {\n              setTimeout(function () {\n                restoreFocus(focusedElement, selectionRange);\n              });\n            } else {\n              restoreFocus(focusedElement, selectionRange);\n            }\n          }\n        }\n      }\n\n      isColumnWidthsCorrected = that._correctColumnWidths(resultWidths, visibleColumns);\n\n      if (columnAutoWidth) {\n        normalizeWidthsByExpandColumns();\n\n        if (that._needStretch()) {\n          that._processStretch(resultWidths, visibleColumns);\n        }\n      }\n\n      (0, _common.deferRender)(function () {\n        if (needBestFit || isColumnWidthsCorrected) {\n          that._setVisibleWidths(visibleColumns, resultWidths);\n        }\n      });\n    });\n  },\n  _needBestFit: function () {\n    return this.option(\"columnAutoWidth\");\n  },\n  _needStretch: function () {\n    return this.option(\"legacyRendering\") || this._columnsController.getVisibleColumns().some(function (c) {\n      return \"auto\" === c.width && !c.command;\n    });\n  },\n  _getAverageColumnsWidth: function (resultWidths) {\n    var freeWidth = calculateFreeWidth(this, resultWidths);\n    var columnCountWithoutWidth = resultWidths.filter(function (width) {\n      return void 0 === width;\n    }).length;\n    return freeWidth / columnCountWithoutWidth;\n  },\n  _correctColumnWidths: function (resultWidths, visibleColumns) {\n    var that = this;\n    var i;\n    var hasPercentWidth = false;\n    var hasAutoWidth = false;\n    var isColumnWidthsCorrected = false;\n    var $element = that.component.$element();\n    var hasWidth = that._hasWidth;\n\n    var _loop = function () {\n      var index = i;\n      var column = visibleColumns[index];\n      var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\n      var width = resultWidths[index];\n      var minWidth = column.minWidth;\n\n      if (minWidth) {\n        if (void 0 === width) {\n          var averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\n\n          width = averageColumnsWidth;\n        } else {\n          if (isPercentWidth(width)) {\n            var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\n\n            if (freeWidth < 0) {\n              width = -1;\n            }\n          }\n        }\n      }\n\n      var realColumnWidth = that._getRealColumnWidth(index, resultWidths.map(function (columnWidth, columnIndex) {\n        return index === columnIndex ? width : columnWidth;\n      }));\n\n      if (minWidth && !isHiddenColumn && realColumnWidth < minWidth) {\n        resultWidths[index] = minWidth;\n        isColumnWidthsCorrected = true;\n        i = -1;\n      }\n\n      if (!(0, _type.isDefined)(column.width)) {\n        hasAutoWidth = true;\n      }\n\n      if (isPercentWidth(column.width)) {\n        hasPercentWidth = true;\n      }\n    };\n\n    for (i = 0; i < visibleColumns.length; i++) {\n      _loop();\n    }\n\n    if ($element && that._maxWidth) {\n      delete that._maxWidth;\n      $element.css(\"maxWidth\", \"\");\n    }\n\n    if (!hasAutoWidth && resultWidths.length) {\n      var contentWidth = that._rowsView.contentWidth();\n\n      var scrollbarWidth = that._rowsView.getScrollbarWidth();\n\n      var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\n\n      if (totalWidth < contentWidth) {\n        var lastColumnIndex = _uiGrid_core2.default.getLastResizableColumnIndex(visibleColumns, resultWidths);\n\n        if (lastColumnIndex >= 0) {\n          resultWidths[lastColumnIndex] = \"auto\";\n          isColumnWidthsCorrected = true;\n\n          if (false === hasWidth && !hasPercentWidth) {\n            that._maxWidth = totalWidth + scrollbarWidth + (that.option(\"showBorders\") ? 2 : 0);\n            $element.css(\"maxWidth\", that._maxWidth);\n          }\n        }\n      }\n    }\n\n    return isColumnWidthsCorrected;\n  },\n  _processStretch: function (resultSizes, visibleColumns) {\n    var groupSize = this._rowsView.contentWidth();\n\n    var tableSize = this._getTotalWidth(resultSizes, groupSize);\n\n    var unusedIndexes = {\n      length: 0\n    };\n\n    if (!resultSizes.length) {\n      return;\n    }\n\n    (0, _iterator.each)(visibleColumns, function (index) {\n      if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\n        unusedIndexes[index] = true;\n        unusedIndexes.length++;\n      }\n    });\n    var diff = groupSize - tableSize;\n    var diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\n    var onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\n\n    if (diff >= 0) {\n      for (var i = 0; i < resultSizes.length; i++) {\n        if (unusedIndexes[i]) {\n          continue;\n        }\n\n        resultSizes[i] += diffElement;\n\n        if (onePixelElementsCount > 0) {\n          if (onePixelElementsCount < 1) {\n            resultSizes[i] += onePixelElementsCount;\n            onePixelElementsCount = 0;\n          } else {\n            resultSizes[i]++;\n            onePixelElementsCount--;\n          }\n        }\n      }\n    }\n  },\n  _getRealColumnWidth: function (columnIndex, columnWidths, groupWidth) {\n    var ratio = 1;\n    var width = columnWidths[columnIndex];\n\n    if (!isPercentWidth(width)) {\n      return parseFloat(width);\n    }\n\n    var percentTotalWidth = columnWidths.reduce(function (sum, width, index) {\n      if (!isPercentWidth(width)) {\n        return sum;\n      }\n\n      return sum + parseFloat(width);\n    }, 0);\n    var pixelTotalWidth = columnWidths.reduce(function (sum, width) {\n      if (!width || width === HIDDEN_COLUMNS_WIDTH || isPercentWidth(width)) {\n        return sum;\n      }\n\n      return sum + parseFloat(width);\n    }, 0);\n    groupWidth = groupWidth || this._rowsView.contentWidth();\n    var freeSpace = groupWidth - pixelTotalWidth;\n    var percentTotalWidthInPixel = percentTotalWidth * groupWidth / 100;\n\n    if (pixelTotalWidth > 0 && percentTotalWidthInPixel + pixelTotalWidth >= groupWidth) {\n      ratio = percentTotalWidthInPixel > freeSpace ? freeSpace / percentTotalWidthInPixel : 1;\n    }\n\n    return parseFloat(width) * groupWidth * ratio / 100;\n  },\n  _getTotalWidth: function (widths, groupWidth) {\n    var result = 0;\n\n    for (var i = 0; i < widths.length; i++) {\n      var width = widths[i];\n\n      if (width && width !== HIDDEN_COLUMNS_WIDTH) {\n        result += this._getRealColumnWidth(i, widths, groupWidth);\n      }\n    }\n\n    return result;\n  },\n  updateSize: function ($rootElement) {\n    var that = this;\n    var $groupElement;\n    var width;\n    var importantMarginClass = that.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\n\n    if (void 0 === that._hasHeight && $rootElement && $rootElement.is(\":visible\") && $rootElement.width()) {\n      $groupElement = $rootElement.children(\".\" + that.getWidgetContainerClass());\n\n      if ($groupElement.length) {\n        $groupElement.detach();\n      }\n\n      that._hasHeight = !!getContainerHeight($rootElement);\n      width = $rootElement.width();\n      $rootElement.addClass(importantMarginClass);\n      that._hasWidth = $rootElement.width() === width;\n      $rootElement.removeClass(importantMarginClass);\n\n      if ($groupElement.length) {\n        $groupElement.appendTo($rootElement);\n      }\n    }\n  },\n  publicMethods: function () {\n    return [\"resize\", \"updateDimensions\"];\n  },\n  resize: function () {\n    return !this.component._requireResize && this.updateDimensions();\n  },\n  updateDimensions: function (checkSize) {\n    var that = this;\n\n    that._initPostRenderHandlers();\n\n    if (!that._checkSize(checkSize)) {\n      return;\n    }\n\n    var prevResult = that._resizeDeferred;\n    var result = that._resizeDeferred = new _deferred.Deferred();\n    (0, _deferred.when)(prevResult).always(function () {\n      (0, _common.deferRender)(function () {\n        if (that._dataController.isLoaded()) {\n          that._synchronizeColumns();\n        }\n\n        that._resetGroupElementHeight();\n\n        (0, _common.deferUpdate)(function () {\n          (0, _common.deferRender)(function () {\n            (0, _common.deferUpdate)(function () {\n              that._updateDimensionsCore();\n            });\n          });\n        });\n      }).done(result.resolve).fail(result.reject);\n    });\n    return result.promise();\n  },\n  _resetGroupElementHeight: function () {\n    var groupElement = this.component.$element().children().get(0);\n\n    var scrollable = this._rowsView.getScrollable();\n\n    if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\n      groupElement.style.height = \"\";\n    }\n  },\n  _checkSize: function (checkSize) {\n    var $rootElement = this.component.$element();\n\n    if (checkSize && (this._lastWidth === $rootElement.width() && this._lastHeight === $rootElement.height() || !$rootElement.is(\":visible\"))) {\n      return false;\n    }\n\n    return true;\n  },\n  _setScrollerSpacingCore: function (hasHeight) {\n    var that = this;\n    var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\n\n    var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\n\n    (0, _common.deferRender)(function () {\n      that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\n      that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\n\n      that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth);\n    });\n  },\n  _setScrollerSpacing: function (hasHeight) {\n    var _this2 = this;\n\n    if (true === this.option(\"scrolling.useNative\")) {\n      (0, _common.deferRender)(function () {\n        (0, _common.deferUpdate)(function () {\n          _this2._setScrollerSpacingCore(hasHeight);\n        });\n      });\n    } else {\n      this._setScrollerSpacingCore(hasHeight);\n    }\n  },\n  _updateDimensionsCore: function () {\n    var that = this;\n    var dataController = that._dataController;\n    var rowsView = that._rowsView;\n    var $rootElement = that.component.$element();\n    var groupElement = $rootElement.children().get(0);\n    var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || $rootElement.height());\n    var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\n    var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\n    var height = that.option(\"height\") || $rootElement.get(0).style.height;\n    var editorFactory = that.getController(\"editorFactory\");\n    var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\n    var $testDiv;\n    that.updateSize($rootElement);\n    var hasHeight = that._hasHeight || maxHeightHappened;\n\n    if (height && that._hasHeight ^ \"auto\" !== height) {\n      $testDiv = (0, _renderer.default)(\"<div>\").height(height).appendTo($rootElement);\n      that._hasHeight = !!$testDiv.height();\n      $testDiv.remove();\n    }\n\n    (0, _common.deferRender)(function () {\n      rowsView.height(null, hasHeight);\n\n      if (maxHeightHappened && !isMaxHeightApplied) {\n        (0, _renderer.default)(groupElement).css(\"height\", maxHeight);\n      }\n\n      if (!dataController.isLoaded()) {\n        rowsView.setLoading(dataController.isLoading());\n        return;\n      }\n\n      (0, _common.deferUpdate)(function () {\n        that._updateLastSizes($rootElement);\n\n        that._setScrollerSpacing(hasHeight);\n\n        (0, _iterator.each)(VIEW_NAMES, function (index, viewName) {\n          var view = that.getView(viewName);\n\n          if (view) {\n            view.resize();\n          }\n        });\n        editorFactory && editorFactory.resize();\n      });\n    });\n  },\n  _updateLastSizes: function ($rootElement) {\n    this._lastWidth = $rootElement.width();\n    this._lastHeight = $rootElement.height();\n  },\n  optionChanged: function (args) {\n    switch (args.name) {\n      case \"width\":\n      case \"height\":\n        this.component._renderDimensions();\n\n        this.resize();\n\n      case \"legacyRendering\":\n      case \"renderAsync\":\n        args.handled = true;\n        return;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  init: function () {\n    var that = this;\n    that._dataController = that.getController(\"data\");\n    that._columnsController = that.getController(\"columns\");\n    that._columnHeadersView = that.getView(\"columnHeadersView\");\n    that._footerView = that.getView(\"footerView\");\n    that._rowsView = that.getView(\"rowsView\");\n  }\n});\n\nvar SynchronizeScrollingController = _uiGrid_core.default.ViewController.inherit({\n  _scrollChangedHandler: function (views, pos, viewName) {\n    for (var j = 0; j < views.length; j++) {\n      if (views[j] && views[j].name !== viewName) {\n        views[j].scrollTo({\n          left: pos.left,\n          top: pos.top\n        });\n      }\n    }\n  },\n  init: function () {\n    var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\n\n    for (var i = 0; i < views.length; i++) {\n      var view = views[i];\n\n      if (view) {\n        view.scrollChanged.add(this._scrollChangedHandler.bind(this, views));\n      }\n    }\n  }\n});\n\nvar GridView = _uiGrid_core.default.View.inherit({\n  _endUpdateCore: function () {\n    if (this.component._requireResize) {\n      this.component._requireResize = false;\n\n      this._resizingController.resize();\n    }\n  },\n  _getWidgetAriaLabel: function () {\n    return \"dxDataGrid-ariaDataGrid\";\n  },\n  init: function () {\n    var that = this;\n    that._resizingController = that.getController(\"resizing\");\n    that._dataController = that.getController(\"data\");\n  },\n  getView: function (name) {\n    return this.component._views[name];\n  },\n  element: function () {\n    return this._groupElement;\n  },\n  optionChanged: function (args) {\n    var that = this;\n\n    if ((0, _type.isDefined)(that._groupElement) && \"showBorders\" === args.name) {\n      that._groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!args.value);\n\n      args.handled = true;\n    } else {\n      that.callBase(args);\n    }\n  },\n  _renderViews: function ($groupElement) {\n    var that = this;\n    (0, _iterator.each)(VIEW_NAMES, function (index, viewName) {\n      var view = that.getView(viewName);\n\n      if (view) {\n        view.render($groupElement);\n      }\n    });\n  },\n  _getTableRoleName: function () {\n    return \"grid\";\n  },\n  render: function ($rootElement) {\n    var that = this;\n    var isFirstRender = !that._groupElement;\n    var $groupElement = that._groupElement || (0, _renderer.default)(\"<div>\").addClass(that.getWidgetContainerClass());\n    $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\n    $groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!that.option(\"showBorders\"));\n    that.setAria(\"role\", \"presentation\", $rootElement);\n    that.component.setAria({\n      role: this._getTableRoleName(),\n      label: _message.default.format(that._getWidgetAriaLabel())\n    }, $groupElement);\n    that._rootElement = $rootElement || that._rootElement;\n\n    if (isFirstRender) {\n      that._groupElement = $groupElement;\n      (0, _window.hasWindow)() && that.getController(\"resizing\").updateSize($rootElement);\n      $groupElement.appendTo($rootElement);\n    }\n\n    that._renderViews($groupElement);\n  },\n  update: function () {\n    var that = this;\n    var $rootElement = that._rootElement;\n    var $groupElement = that._groupElement;\n    var resizingController = that.getController(\"resizing\");\n\n    if ($rootElement && $groupElement) {\n      resizingController.resize();\n\n      if (that._dataController.isLoaded()) {\n        that._resizingController.fireContentReadyAction();\n      }\n    }\n  }\n});\n\nvar _default = {\n  defaultOptions: function () {\n    return {\n      showBorders: false,\n      renderAsync: false,\n      legacyRendering: false\n    };\n  },\n  controllers: {\n    resizing: ResizingController,\n    synchronizeScrolling: SynchronizeScrollingController\n  },\n  views: {\n    gridView: GridView\n  }\n};\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["C:/Users/CapiniaC/Desktop/Collection/Work/project/security/node_modules/devextreme/ui/grid_core/ui.grid_core.grid_view.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","exports","default","_renderer","_interopRequireDefault","require","_uiGrid_core","_common","_window","_iterator","_type","_position","_uiGrid_core2","_message","_deferred","_dom_adapter","_browser","accessibility","_interopRequireWildcard","_getRequireWildcardCache","WeakMap","cache","__esModule","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","TABLE_CLASS","BORDERS_CLASS","TABLE_FIXED_CLASS","IMPORTANT_MARGIN_CLASS","TEXT_CONTENT_CLASS","HIDDEN_CLASS","GRIDBASE_CONTAINER_CLASS","HIDDEN_COLUMNS_WIDTH","EDITORS_INPUT_SELECTOR","VIEW_NAMES","isPercentWidth","width","isString","slice","isPixelWidth","mergeArraysByMaxValue","values1","values2","result","length","i","push","getContainerHeight","$container","clientHeight","paddingTop","parseFloat","css","paddingBottom","calculateFreeWidth","that","widths","contentWidth","_rowsView","totalWidth","_getTotalWidth","calculateFreeWidthWithCurrentMinWidth","columnIndex","currentMinWidth","map","index","restoreFocus","focusedElement","selectionRange","hiddenFocus","setSelectionRange","ResizingController","ViewController","inherit","_initPostRenderHandlers","dataController","_dataController","_refreshSizesHandler","e","changed","remove","resizeDeferred","changeType","isDelayed","items","resize","changeTypes","needUpdateDimensions","deferUpdate","when","done","_setAriaRowColCount","fireContentReadyAction","add","component","_fireContentReadyAction","setAria","rowCount","totalItemsCount","colCount","columnCount","$element","children","_getBestFitWidths","_this$_footerView","rowsView","columnHeadersView","_columnHeadersView","option","_widths","getColumnWidths","_rowsView$getTableEle","headersTableElement","getTableElement","setTableElement","rowsColumnWidths","headerColumnWidths","footerColumnWidths","_footerView","resultWidths","_setVisibleWidths","visibleColumns","columnsController","_columnsController","beginUpdate","each","column","columnId","getColumnId","columnOption","endUpdate","_toggleBestFitModeForView","view","className","isBestFit","_this","isVisible","$rowsTables","getTableElements","$viewTables","tableElement","$tableBody","$rowsTable","$viewTable","eq","appendTo","toggleClass","addWidgetPrefix","_toggleBestFitMode","$rowsFixedTable","_needStretch","style","msie","parseInt","version","find","_synchronizeColumns","getVisibleColumns","columnAutoWidth","legacyRendering","needBestFit","_needBestFit","hasMinWidth","resetBestFitMode","isColumnWidthsCorrected","normalizeWidthsByExpandColumns","expandColumnWidth","type","fixed","minWidth","getActiveElement","getSelectionRange","isDefined","isNumeric","isFocusOutsideWindow","getBoundingRect","bottom","setTimeout","_correctColumnWidths","_processStretch","deferRender","some","c","command","_getAverageColumnsWidth","freeWidth","columnCountWithoutWidth","filter","hasPercentWidth","hasAutoWidth","hasWidth","_hasWidth","_loop","isHiddenColumn","averageColumnsWidth","realColumnWidth","_getRealColumnWidth","columnWidth","_maxWidth","scrollbarWidth","getScrollbarWidth","lastColumnIndex","getLastResizableColumnIndex","resultSizes","groupSize","tableSize","unusedIndexes","diff","diffElement","Math","floor","onePixelElementsCount","columnWidths","groupWidth","ratio","percentTotalWidth","reduce","sum","pixelTotalWidth","freeSpace","percentTotalWidthInPixel","updateSize","$rootElement","$groupElement","importantMarginClass","_hasHeight","is","getWidgetContainerClass","detach","addClass","removeClass","publicMethods","_requireResize","updateDimensions","checkSize","_checkSize","prevResult","_resizeDeferred","Deferred","always","isLoaded","_resetGroupElementHeight","_updateDimensionsCore","resolve","fail","reject","promise","groupElement","scrollable","getScrollable","height","scrollTop","_lastWidth","_lastHeight","_setScrollerSpacingCore","hasHeight","vScrollbarWidth","hScrollbarWidth","setScrollerSpacing","_setScrollerSpacing","_this2","rootElementHeight","maxHeight","maxHeightHappened","editorFactory","getController","isMaxHeightApplied","scrollHeight","offsetHeight","$testDiv","setLoading","isLoading","_updateLastSizes","viewName","getView","optionChanged","args","name","_renderDimensions","handled","callBase","init","SynchronizeScrollingController","_scrollChangedHandler","views","pos","j","scrollTo","left","top","scrollChanged","bind","GridView","View","_endUpdateCore","_resizingController","_getWidgetAriaLabel","_views","element","_groupElement","value","_renderViews","render","_getTableRoleName","isFirstRender","role","label","format","_rootElement","hasWindow","update","resizingController","_default","defaultOptions","showBorders","renderAsync","controllers","resizing","synchronizeScrolling","gridView","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _uiGrid_core = _interopRequireDefault(require(\"./ui.grid_core.modules\"));\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _position = require(\"../../core/utils/position\");\r\nvar _uiGrid_core2 = _interopRequireDefault(require(\"./ui.grid_core.utils\"));\r\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\r\nvar _browser = _interopRequireDefault(require(\"../../core/utils/browser\"));\r\nvar accessibility = _interopRequireWildcard(require(\"../shared/accessibility\"));\r\n\r\nfunction _getRequireWildcardCache() {\r\n    if (\"function\" !== typeof WeakMap) {\r\n        return null\r\n    }\r\n    var cache = new WeakMap;\r\n    _getRequireWildcardCache = function() {\r\n        return cache\r\n    };\r\n    return cache\r\n}\r\n\r\nfunction _interopRequireWildcard(obj) {\r\n    if (obj && obj.__esModule) {\r\n        return obj\r\n    }\r\n    if (null === obj || \"object\" !== _typeof(obj) && \"function\" !== typeof obj) {\r\n        return {\r\n            \"default\": obj\r\n        }\r\n    }\r\n    var cache = _getRequireWildcardCache();\r\n    if (cache && cache.has(obj)) {\r\n        return cache.get(obj)\r\n    }\r\n    var newObj = {};\r\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\r\n    for (var key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\r\n            if (desc && (desc.get || desc.set)) {\r\n                Object.defineProperty(newObj, key, desc)\r\n            } else {\r\n                newObj[key] = obj[key]\r\n            }\r\n        }\r\n    }\r\n    newObj.default = obj;\r\n    if (cache) {\r\n        cache.set(obj, newObj)\r\n    }\r\n    return newObj\r\n}\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TABLE_CLASS = \"table\";\r\nvar BORDERS_CLASS = \"borders\";\r\nvar TABLE_FIXED_CLASS = \"table-fixed\";\r\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\r\nvar TEXT_CONTENT_CLASS = \"text-content\";\r\nvar HIDDEN_CLASS = \"dx-hidden\";\r\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\r\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\r\nvar EDITORS_INPUT_SELECTOR = \"input:not([type='hidden'])\";\r\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\r\nvar isPercentWidth = function(width) {\r\n    return (0, _type.isString)(width) && \"%\" === width.slice(-1)\r\n};\r\nvar isPixelWidth = function(width) {\r\n    return (0, _type.isString)(width) && \"px\" === width.slice(-2)\r\n};\r\nvar mergeArraysByMaxValue = function(values1, values2) {\r\n    var result = [];\r\n    if (values1 && values2 && values1.length && values1.length === values2.length) {\r\n        for (var i = 0; i < values1.length; i++) {\r\n            result.push(values1[i] > values2[i] ? values1[i] : values2[i])\r\n        }\r\n    } else {\r\n        if (values1 && values1.length) {\r\n            result = values1\r\n        } else {\r\n            if (values2) {\r\n                result = values2\r\n            }\r\n        }\r\n    }\r\n    return result\r\n};\r\nvar getContainerHeight = function($container) {\r\n    var clientHeight = $container.get(0).clientHeight;\r\n    var paddingTop = parseFloat($container.css(\"paddingTop\"));\r\n    var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\r\n    return clientHeight - paddingTop - paddingBottom\r\n};\r\nvar calculateFreeWidth = function(that, widths) {\r\n    var contentWidth = that._rowsView.contentWidth();\r\n    var totalWidth = that._getTotalWidth(widths, contentWidth);\r\n    return contentWidth - totalWidth\r\n};\r\nvar calculateFreeWidthWithCurrentMinWidth = function(that, columnIndex, currentMinWidth, widths) {\r\n    return calculateFreeWidth(that, widths.map(function(width, index) {\r\n        return index === columnIndex ? currentMinWidth : width\r\n    }))\r\n};\r\nvar restoreFocus = function(focusedElement, selectionRange) {\r\n    accessibility.hiddenFocus(focusedElement);\r\n    _uiGrid_core2.default.setSelectionRange(focusedElement, selectionRange)\r\n};\r\nvar ResizingController = _uiGrid_core.default.ViewController.inherit({\r\n    _initPostRenderHandlers: function() {\r\n        var that = this;\r\n        var dataController = that._dataController;\r\n        if (!that._refreshSizesHandler) {\r\n            that._refreshSizesHandler = function(e) {\r\n                dataController.changed.remove(that._refreshSizesHandler);\r\n                var resizeDeferred;\r\n                var changeType = e && e.changeType;\r\n                var isDelayed = e && e.isDelayed;\r\n                var items = dataController.items();\r\n                if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\r\n                    if (!isDelayed) {\r\n                        resizeDeferred = that.resize()\r\n                    }\r\n                } else {\r\n                    if (\"update\" === changeType && e.changeTypes) {\r\n                        if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\r\n                            (0, _common.deferUpdate)(function() {\r\n                                that._rowsView.resize()\r\n                            })\r\n                        } else {\r\n                            resizeDeferred = that.resize()\r\n                        }\r\n                    }\r\n                }\r\n                if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && !isDelayed) {\r\n                    (0, _deferred.when)(resizeDeferred).done(function() {\r\n                        that._setAriaRowColCount();\r\n                        that.fireContentReadyAction()\r\n                    })\r\n                }\r\n            };\r\n            that._dataController.changed.add(function() {\r\n                that._dataController.changed.add(that._refreshSizesHandler)\r\n            })\r\n        }\r\n    },\r\n    fireContentReadyAction: function() {\r\n        this.component._fireContentReadyAction()\r\n    },\r\n    _setAriaRowColCount: function() {\r\n        var component = this.component;\r\n        component.setAria({\r\n            rowCount: this._dataController.totalItemsCount(),\r\n            colCount: component.columnCount()\r\n        }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS))\r\n    },\r\n    _getBestFitWidths: function() {\r\n        var _this$_footerView;\r\n        var rowsView = this._rowsView;\r\n        var columnHeadersView = this._columnHeadersView;\r\n        if (!this.option(\"legacyRendering\")) {\r\n            var _widths;\r\n            var widths = rowsView.getColumnWidths();\r\n            if (!(null !== (_widths = widths) && void 0 !== _widths && _widths.length)) {\r\n                var _rowsView$getTableEle;\r\n                var headersTableElement = columnHeadersView.getTableElement();\r\n                columnHeadersView.setTableElement(null === (_rowsView$getTableEle = rowsView.getTableElement()) || void 0 === _rowsView$getTableEle ? void 0 : _rowsView$getTableEle.children(\".dx-header\"));\r\n                widths = columnHeadersView.getColumnWidths();\r\n                columnHeadersView.setTableElement(headersTableElement)\r\n            }\r\n            return widths\r\n        }\r\n        var rowsColumnWidths = rowsView.getColumnWidths();\r\n        var headerColumnWidths = null === columnHeadersView || void 0 === columnHeadersView ? void 0 : columnHeadersView.getColumnWidths();\r\n        var footerColumnWidths = null === (_this$_footerView = this._footerView) || void 0 === _this$_footerView ? void 0 : _this$_footerView.getColumnWidths();\r\n        var resultWidths = mergeArraysByMaxValue(rowsColumnWidths, headerColumnWidths);\r\n        resultWidths = mergeArraysByMaxValue(resultWidths, footerColumnWidths);\r\n        return resultWidths\r\n    },\r\n    _setVisibleWidths: function(visibleColumns, widths) {\r\n        var columnsController = this._columnsController;\r\n        columnsController.beginUpdate();\r\n        (0, _iterator.each)(visibleColumns, function(index, column) {\r\n            var columnId = columnsController.getColumnId(column);\r\n            columnsController.columnOption(columnId, \"visibleWidth\", widths[index])\r\n        });\r\n        columnsController.endUpdate()\r\n    },\r\n    _toggleBestFitModeForView: function(view, className, isBestFit) {\r\n        var _this = this;\r\n        if (!view || !view.isVisible()) {\r\n            return\r\n        }\r\n        var $rowsTables = this._rowsView.getTableElements();\r\n        var $viewTables = view.getTableElements();\r\n        (0, _iterator.each)($rowsTables, function(index, tableElement) {\r\n            var $tableBody;\r\n            var $rowsTable = (0, _renderer.default)(tableElement);\r\n            var $viewTable = $viewTables.eq(index);\r\n            if ($viewTable && $viewTable.length) {\r\n                if (isBestFit) {\r\n                    $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable)\r\n                } else {\r\n                    $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable)\r\n                }\r\n                $tableBody.toggleClass(className, isBestFit);\r\n                $tableBody.toggleClass(_this.addWidgetPrefix(\"best-fit\"), isBestFit)\r\n            }\r\n        })\r\n    },\r\n    _toggleBestFitMode: function(isBestFit) {\r\n        var $element = this.component.$element();\r\n        var that = this;\r\n        if (!that.option(\"legacyRendering\")) {\r\n            var $rowsTable = that._rowsView.getTableElement();\r\n            var $rowsFixedTable = that._rowsView.getTableElements().eq(1);\r\n            if (!$rowsTable) {\r\n                return\r\n            }\r\n            $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\r\n            $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\r\n            $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\r\n            that._toggleBestFitModeForView(that._columnHeadersView, \"dx-header\", isBestFit);\r\n            that._toggleBestFitModeForView(that._footerView, \"dx-footer\", isBestFit);\r\n            if (that._needStretch()) {\r\n                $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\"\r\n            }\r\n            if (_browser.default.msie && 11 === parseInt(_browser.default.version)) {\r\n                $rowsTable.find(\".\" + this.addWidgetPrefix(TABLE_FIXED_CLASS)).each(function() {\r\n                    this.style.width = isBestFit ? \"10px\" : \"\"\r\n                })\r\n            }\r\n        } else {\r\n            $element.find(\".\" + this.addWidgetPrefix(TABLE_CLASS)).toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\r\n            $element.find(EDITORS_INPUT_SELECTOR).toggleClass(HIDDEN_CLASS, isBestFit);\r\n            $element.find(\".dx-group-cell\").toggleClass(HIDDEN_CLASS, isBestFit);\r\n            $element.find(\".dx-header-row .\" + this.addWidgetPrefix(TEXT_CONTENT_CLASS)).css(\"maxWidth\", \"\")\r\n        }\r\n    },\r\n    _synchronizeColumns: function() {\r\n        var that = this;\r\n        var columnsController = that._columnsController;\r\n        var visibleColumns = columnsController.getVisibleColumns();\r\n        var columnAutoWidth = that.option(\"columnAutoWidth\");\r\n        var legacyRendering = that.option(\"legacyRendering\");\r\n        var needBestFit = that._needBestFit();\r\n        var hasMinWidth = false;\r\n        var resetBestFitMode;\r\n        var isColumnWidthsCorrected = false;\r\n        var resultWidths = [];\r\n        var focusedElement;\r\n        var selectionRange;\r\n        var normalizeWidthsByExpandColumns = function() {\r\n            var expandColumnWidth;\r\n            (0, _iterator.each)(visibleColumns, function(index, column) {\r\n                if (\"groupExpand\" === column.type) {\r\n                    expandColumnWidth = resultWidths[index]\r\n                }\r\n            });\r\n            (0, _iterator.each)(visibleColumns, function(index, column) {\r\n                if (\"groupExpand\" === column.type && expandColumnWidth) {\r\n                    resultWidths[index] = expandColumnWidth\r\n                }\r\n            })\r\n        };\r\n        !needBestFit && (0, _iterator.each)(visibleColumns, function(index, column) {\r\n            if (\"auto\" === column.width || legacyRendering && column.fixed) {\r\n                needBestFit = true;\r\n                return false\r\n            }\r\n        });\r\n        (0, _iterator.each)(visibleColumns, function(index, column) {\r\n            if (column.minWidth) {\r\n                hasMinWidth = true;\r\n                return false\r\n            }\r\n        });\r\n        that._setVisibleWidths(visibleColumns, []);\r\n        if (needBestFit) {\r\n            focusedElement = _dom_adapter.default.getActiveElement();\r\n            selectionRange = _uiGrid_core2.default.getSelectionRange(focusedElement);\r\n            that._toggleBestFitMode(true);\r\n            resetBestFitMode = true\r\n        }(0, _common.deferUpdate)(function() {\r\n            if (needBestFit) {\r\n                resultWidths = that._getBestFitWidths();\r\n                (0, _iterator.each)(visibleColumns, function(index, column) {\r\n                    var columnId = columnsController.getColumnId(column);\r\n                    columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true)\r\n                })\r\n            } else {\r\n                if (hasMinWidth) {\r\n                    resultWidths = that._getBestFitWidths()\r\n                }\r\n            }(0, _iterator.each)(visibleColumns, function(index) {\r\n                var width = this.width;\r\n                if (\"auto\" !== width) {\r\n                    if ((0, _type.isDefined)(width)) {\r\n                        resultWidths[index] = (0, _type.isNumeric)(width) || isPixelWidth(width) ? parseFloat(width) : width\r\n                    } else {\r\n                        if (!columnAutoWidth) {\r\n                            resultWidths[index] = void 0\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            if (resetBestFitMode) {\r\n                that._toggleBestFitMode(false);\r\n                resetBestFitMode = false;\r\n                if (focusedElement && focusedElement !== _dom_adapter.default.getActiveElement()) {\r\n                    var isFocusOutsideWindow = (0, _position.getBoundingRect)(focusedElement).bottom < 0;\r\n                    if (!isFocusOutsideWindow) {\r\n                        if (_browser.default.msie) {\r\n                            setTimeout(function() {\r\n                                restoreFocus(focusedElement, selectionRange)\r\n                            })\r\n                        } else {\r\n                            restoreFocus(focusedElement, selectionRange)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            isColumnWidthsCorrected = that._correctColumnWidths(resultWidths, visibleColumns);\r\n            if (columnAutoWidth) {\r\n                normalizeWidthsByExpandColumns();\r\n                if (that._needStretch()) {\r\n                    that._processStretch(resultWidths, visibleColumns)\r\n                }\r\n            }(0, _common.deferRender)(function() {\r\n                if (needBestFit || isColumnWidthsCorrected) {\r\n                    that._setVisibleWidths(visibleColumns, resultWidths)\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _needBestFit: function() {\r\n        return this.option(\"columnAutoWidth\")\r\n    },\r\n    _needStretch: function() {\r\n        return this.option(\"legacyRendering\") || this._columnsController.getVisibleColumns().some(function(c) {\r\n            return \"auto\" === c.width && !c.command\r\n        })\r\n    },\r\n    _getAverageColumnsWidth: function(resultWidths) {\r\n        var freeWidth = calculateFreeWidth(this, resultWidths);\r\n        var columnCountWithoutWidth = resultWidths.filter(function(width) {\r\n            return void 0 === width\r\n        }).length;\r\n        return freeWidth / columnCountWithoutWidth\r\n    },\r\n    _correctColumnWidths: function(resultWidths, visibleColumns) {\r\n        var that = this;\r\n        var i;\r\n        var hasPercentWidth = false;\r\n        var hasAutoWidth = false;\r\n        var isColumnWidthsCorrected = false;\r\n        var $element = that.component.$element();\r\n        var hasWidth = that._hasWidth;\r\n        var _loop = function() {\r\n            var index = i;\r\n            var column = visibleColumns[index];\r\n            var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\r\n            var width = resultWidths[index];\r\n            var minWidth = column.minWidth;\r\n            if (minWidth) {\r\n                if (void 0 === width) {\r\n                    var averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\r\n                    width = averageColumnsWidth\r\n                } else {\r\n                    if (isPercentWidth(width)) {\r\n                        var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\r\n                        if (freeWidth < 0) {\r\n                            width = -1\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            var realColumnWidth = that._getRealColumnWidth(index, resultWidths.map(function(columnWidth, columnIndex) {\r\n                return index === columnIndex ? width : columnWidth\r\n            }));\r\n            if (minWidth && !isHiddenColumn && realColumnWidth < minWidth) {\r\n                resultWidths[index] = minWidth;\r\n                isColumnWidthsCorrected = true;\r\n                i = -1\r\n            }\r\n            if (!(0, _type.isDefined)(column.width)) {\r\n                hasAutoWidth = true\r\n            }\r\n            if (isPercentWidth(column.width)) {\r\n                hasPercentWidth = true\r\n            }\r\n        };\r\n        for (i = 0; i < visibleColumns.length; i++) {\r\n            _loop()\r\n        }\r\n        if ($element && that._maxWidth) {\r\n            delete that._maxWidth;\r\n            $element.css(\"maxWidth\", \"\")\r\n        }\r\n        if (!hasAutoWidth && resultWidths.length) {\r\n            var contentWidth = that._rowsView.contentWidth();\r\n            var scrollbarWidth = that._rowsView.getScrollbarWidth();\r\n            var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\r\n            if (totalWidth < contentWidth) {\r\n                var lastColumnIndex = _uiGrid_core2.default.getLastResizableColumnIndex(visibleColumns, resultWidths);\r\n                if (lastColumnIndex >= 0) {\r\n                    resultWidths[lastColumnIndex] = \"auto\";\r\n                    isColumnWidthsCorrected = true;\r\n                    if (false === hasWidth && !hasPercentWidth) {\r\n                        that._maxWidth = totalWidth + scrollbarWidth + (that.option(\"showBorders\") ? 2 : 0);\r\n                        $element.css(\"maxWidth\", that._maxWidth)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return isColumnWidthsCorrected\r\n    },\r\n    _processStretch: function(resultSizes, visibleColumns) {\r\n        var groupSize = this._rowsView.contentWidth();\r\n        var tableSize = this._getTotalWidth(resultSizes, groupSize);\r\n        var unusedIndexes = {\r\n            length: 0\r\n        };\r\n        if (!resultSizes.length) {\r\n            return\r\n        }(0, _iterator.each)(visibleColumns, function(index) {\r\n            if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\r\n                unusedIndexes[index] = true;\r\n                unusedIndexes.length++\r\n            }\r\n        });\r\n        var diff = groupSize - tableSize;\r\n        var diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\r\n        var onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\r\n        if (diff >= 0) {\r\n            for (var i = 0; i < resultSizes.length; i++) {\r\n                if (unusedIndexes[i]) {\r\n                    continue\r\n                }\r\n                resultSizes[i] += diffElement;\r\n                if (onePixelElementsCount > 0) {\r\n                    if (onePixelElementsCount < 1) {\r\n                        resultSizes[i] += onePixelElementsCount;\r\n                        onePixelElementsCount = 0\r\n                    } else {\r\n                        resultSizes[i]++;\r\n                        onePixelElementsCount--\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _getRealColumnWidth: function(columnIndex, columnWidths, groupWidth) {\r\n        var ratio = 1;\r\n        var width = columnWidths[columnIndex];\r\n        if (!isPercentWidth(width)) {\r\n            return parseFloat(width)\r\n        }\r\n        var percentTotalWidth = columnWidths.reduce(function(sum, width, index) {\r\n            if (!isPercentWidth(width)) {\r\n                return sum\r\n            }\r\n            return sum + parseFloat(width)\r\n        }, 0);\r\n        var pixelTotalWidth = columnWidths.reduce(function(sum, width) {\r\n            if (!width || width === HIDDEN_COLUMNS_WIDTH || isPercentWidth(width)) {\r\n                return sum\r\n            }\r\n            return sum + parseFloat(width)\r\n        }, 0);\r\n        groupWidth = groupWidth || this._rowsView.contentWidth();\r\n        var freeSpace = groupWidth - pixelTotalWidth;\r\n        var percentTotalWidthInPixel = percentTotalWidth * groupWidth / 100;\r\n        if (pixelTotalWidth > 0 && percentTotalWidthInPixel + pixelTotalWidth >= groupWidth) {\r\n            ratio = percentTotalWidthInPixel > freeSpace ? freeSpace / percentTotalWidthInPixel : 1\r\n        }\r\n        return parseFloat(width) * groupWidth * ratio / 100\r\n    },\r\n    _getTotalWidth: function(widths, groupWidth) {\r\n        var result = 0;\r\n        for (var i = 0; i < widths.length; i++) {\r\n            var width = widths[i];\r\n            if (width && width !== HIDDEN_COLUMNS_WIDTH) {\r\n                result += this._getRealColumnWidth(i, widths, groupWidth)\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    updateSize: function($rootElement) {\r\n        var that = this;\r\n        var $groupElement;\r\n        var width;\r\n        var importantMarginClass = that.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\r\n        if (void 0 === that._hasHeight && $rootElement && $rootElement.is(\":visible\") && $rootElement.width()) {\r\n            $groupElement = $rootElement.children(\".\" + that.getWidgetContainerClass());\r\n            if ($groupElement.length) {\r\n                $groupElement.detach()\r\n            }\r\n            that._hasHeight = !!getContainerHeight($rootElement);\r\n            width = $rootElement.width();\r\n            $rootElement.addClass(importantMarginClass);\r\n            that._hasWidth = $rootElement.width() === width;\r\n            $rootElement.removeClass(importantMarginClass);\r\n            if ($groupElement.length) {\r\n                $groupElement.appendTo($rootElement)\r\n            }\r\n        }\r\n    },\r\n    publicMethods: function() {\r\n        return [\"resize\", \"updateDimensions\"]\r\n    },\r\n    resize: function() {\r\n        return !this.component._requireResize && this.updateDimensions()\r\n    },\r\n    updateDimensions: function(checkSize) {\r\n        var that = this;\r\n        that._initPostRenderHandlers();\r\n        if (!that._checkSize(checkSize)) {\r\n            return\r\n        }\r\n        var prevResult = that._resizeDeferred;\r\n        var result = that._resizeDeferred = new _deferred.Deferred;\r\n        (0, _deferred.when)(prevResult).always(function() {\r\n            (0, _common.deferRender)(function() {\r\n                if (that._dataController.isLoaded()) {\r\n                    that._synchronizeColumns()\r\n                }\r\n                that._resetGroupElementHeight();\r\n                (0, _common.deferUpdate)(function() {\r\n                    (0, _common.deferRender)(function() {\r\n                        (0, _common.deferUpdate)(function() {\r\n                            that._updateDimensionsCore()\r\n                        })\r\n                    })\r\n                })\r\n            }).done(result.resolve).fail(result.reject)\r\n        });\r\n        return result.promise()\r\n    },\r\n    _resetGroupElementHeight: function() {\r\n        var groupElement = this.component.$element().children().get(0);\r\n        var scrollable = this._rowsView.getScrollable();\r\n        if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\r\n            groupElement.style.height = \"\"\r\n        }\r\n    },\r\n    _checkSize: function(checkSize) {\r\n        var $rootElement = this.component.$element();\r\n        if (checkSize && (this._lastWidth === $rootElement.width() && this._lastHeight === $rootElement.height() || !$rootElement.is(\":visible\"))) {\r\n            return false\r\n        }\r\n        return true\r\n    },\r\n    _setScrollerSpacingCore: function(hasHeight) {\r\n        var that = this;\r\n        var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\r\n        var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\r\n        (0, _common.deferRender)(function() {\r\n            that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\r\n            that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\r\n            that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth)\r\n        })\r\n    },\r\n    _setScrollerSpacing: function(hasHeight) {\r\n        var _this2 = this;\r\n        if (true === this.option(\"scrolling.useNative\")) {\r\n            (0, _common.deferRender)(function() {\r\n                (0, _common.deferUpdate)(function() {\r\n                    _this2._setScrollerSpacingCore(hasHeight)\r\n                })\r\n            })\r\n        } else {\r\n            this._setScrollerSpacingCore(hasHeight)\r\n        }\r\n    },\r\n    _updateDimensionsCore: function() {\r\n        var that = this;\r\n        var dataController = that._dataController;\r\n        var rowsView = that._rowsView;\r\n        var $rootElement = that.component.$element();\r\n        var groupElement = $rootElement.children().get(0);\r\n        var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || $rootElement.height());\r\n        var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\r\n        var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\r\n        var height = that.option(\"height\") || $rootElement.get(0).style.height;\r\n        var editorFactory = that.getController(\"editorFactory\");\r\n        var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\r\n        var $testDiv;\r\n        that.updateSize($rootElement);\r\n        var hasHeight = that._hasHeight || maxHeightHappened;\r\n        if (height && that._hasHeight ^ \"auto\" !== height) {\r\n            $testDiv = (0, _renderer.default)(\"<div>\").height(height).appendTo($rootElement);\r\n            that._hasHeight = !!$testDiv.height();\r\n            $testDiv.remove()\r\n        }(0, _common.deferRender)(function() {\r\n            rowsView.height(null, hasHeight);\r\n            if (maxHeightHappened && !isMaxHeightApplied) {\r\n                (0, _renderer.default)(groupElement).css(\"height\", maxHeight)\r\n            }\r\n            if (!dataController.isLoaded()) {\r\n                rowsView.setLoading(dataController.isLoading());\r\n                return\r\n            }(0, _common.deferUpdate)(function() {\r\n                that._updateLastSizes($rootElement);\r\n                that._setScrollerSpacing(hasHeight);\r\n                (0, _iterator.each)(VIEW_NAMES, function(index, viewName) {\r\n                    var view = that.getView(viewName);\r\n                    if (view) {\r\n                        view.resize()\r\n                    }\r\n                });\r\n                editorFactory && editorFactory.resize()\r\n            })\r\n        })\r\n    },\r\n    _updateLastSizes: function($rootElement) {\r\n        this._lastWidth = $rootElement.width();\r\n        this._lastHeight = $rootElement.height()\r\n    },\r\n    optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"width\":\r\n            case \"height\":\r\n                this.component._renderDimensions();\r\n                this.resize();\r\n            case \"legacyRendering\":\r\n            case \"renderAsync\":\r\n                args.handled = true;\r\n                return;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        that._dataController = that.getController(\"data\");\r\n        that._columnsController = that.getController(\"columns\");\r\n        that._columnHeadersView = that.getView(\"columnHeadersView\");\r\n        that._footerView = that.getView(\"footerView\");\r\n        that._rowsView = that.getView(\"rowsView\")\r\n    }\r\n});\r\nvar SynchronizeScrollingController = _uiGrid_core.default.ViewController.inherit({\r\n    _scrollChangedHandler: function(views, pos, viewName) {\r\n        for (var j = 0; j < views.length; j++) {\r\n            if (views[j] && views[j].name !== viewName) {\r\n                views[j].scrollTo({\r\n                    left: pos.left,\r\n                    top: pos.top\r\n                })\r\n            }\r\n        }\r\n    },\r\n    init: function() {\r\n        var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\r\n        for (var i = 0; i < views.length; i++) {\r\n            var view = views[i];\r\n            if (view) {\r\n                view.scrollChanged.add(this._scrollChangedHandler.bind(this, views))\r\n            }\r\n        }\r\n    }\r\n});\r\nvar GridView = _uiGrid_core.default.View.inherit({\r\n    _endUpdateCore: function() {\r\n        if (this.component._requireResize) {\r\n            this.component._requireResize = false;\r\n            this._resizingController.resize()\r\n        }\r\n    },\r\n    _getWidgetAriaLabel: function() {\r\n        return \"dxDataGrid-ariaDataGrid\"\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        that._resizingController = that.getController(\"resizing\");\r\n        that._dataController = that.getController(\"data\")\r\n    },\r\n    getView: function(name) {\r\n        return this.component._views[name]\r\n    },\r\n    element: function() {\r\n        return this._groupElement\r\n    },\r\n    optionChanged: function(args) {\r\n        var that = this;\r\n        if ((0, _type.isDefined)(that._groupElement) && \"showBorders\" === args.name) {\r\n            that._groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!args.value);\r\n            args.handled = true\r\n        } else {\r\n            that.callBase(args)\r\n        }\r\n    },\r\n    _renderViews: function($groupElement) {\r\n        var that = this;\r\n        (0, _iterator.each)(VIEW_NAMES, function(index, viewName) {\r\n            var view = that.getView(viewName);\r\n            if (view) {\r\n                view.render($groupElement)\r\n            }\r\n        })\r\n    },\r\n    _getTableRoleName: function() {\r\n        return \"grid\"\r\n    },\r\n    render: function($rootElement) {\r\n        var that = this;\r\n        var isFirstRender = !that._groupElement;\r\n        var $groupElement = that._groupElement || (0, _renderer.default)(\"<div>\").addClass(that.getWidgetContainerClass());\r\n        $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\r\n        $groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!that.option(\"showBorders\"));\r\n        that.setAria(\"role\", \"presentation\", $rootElement);\r\n        that.component.setAria({\r\n            role: this._getTableRoleName(),\r\n            label: _message.default.format(that._getWidgetAriaLabel())\r\n        }, $groupElement);\r\n        that._rootElement = $rootElement || that._rootElement;\r\n        if (isFirstRender) {\r\n            that._groupElement = $groupElement;\r\n            (0, _window.hasWindow)() && that.getController(\"resizing\").updateSize($rootElement);\r\n            $groupElement.appendTo($rootElement)\r\n        }\r\n        that._renderViews($groupElement)\r\n    },\r\n    update: function() {\r\n        var that = this;\r\n        var $rootElement = that._rootElement;\r\n        var $groupElement = that._groupElement;\r\n        var resizingController = that.getController(\"resizing\");\r\n        if ($rootElement && $groupElement) {\r\n            resizingController.resize();\r\n            if (that._dataController.isLoaded()) {\r\n                that._resizingController.fireContentReadyAction()\r\n            }\r\n        }\r\n    }\r\n});\r\nvar _default = {\r\n    defaultOptions: function() {\r\n        return {\r\n            showBorders: false,\r\n            renderAsync: false,\r\n            legacyRendering: false\r\n        }\r\n    },\r\n    controllers: {\r\n        resizing: ResizingController,\r\n        synchronizeScrolling: SynchronizeScrollingController\r\n    },\r\n    views: {\r\n        gridView: GridView\r\n    }\r\n};\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}