{"ast":null,"code":"/**\r\n * DevExtreme (ui/shared/accessibility.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.subscribeVisibilityChange = subscribeVisibilityChange;\nexports.unsubscribeVisibilityChange = unsubscribeVisibilityChange;\nexports.hiddenFocus = hiddenFocus;\nexports.registerKeyboardAction = registerKeyboardAction;\nexports.restoreFocus = restoreFocus;\nexports.selectView = selectView;\nexports.setTabIndex = setTabIndex;\n\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\n\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\n\nvar _index = require(\"../../events/utils/index\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\n\nvar _common = require(\"../../core/utils/common\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar FOCUS_STATE_CLASS = \"dx-state-focused\";\nvar FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar FOCUSED_ROW_SELECTOR = \".dx-row-focused\";\nvar GRID_ROW_SELECTOR = \".dx-datagrid-rowsview .dx-row\";\nvar GRID_CELL_SELECTOR = \"\".concat(GRID_ROW_SELECTOR, \" > td\");\nvar TREELIST_ROW_SELECTOR = \".dx-treelist-rowsview .dx-row\";\nvar TREELIST_CELL_SELECTOR = \"\".concat(TREELIST_ROW_SELECTOR, \" > td\");\nvar viewItemSelectorMap = {\n  groupPanel: [\".dx-datagrid-group-panel .dx-group-panel-item[tabindex]\"],\n  columnHeaders: [\".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action\", \".dx-treelist-headers .dx-header-row > td.dx-treelist-action\"],\n  filterRow: [\".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input\", \".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input\"],\n  rowsView: [\"\".concat(FOCUSED_ROW_SELECTOR), \"\".concat(GRID_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR), \"\".concat(TREELIST_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR)],\n  footer: [\".dx-datagrid-total-footer .dx-datagrid-summary-item\", \".dx-treelist-total-footer .dx-treelist-summary-item\"],\n  filterPanel: [\".dx-datagrid-filter-panel .dx-icon-filter\", \".dx-treelist-filter-panel .dx-icon-filter\"],\n  pager: [\".dx-datagrid-pager [tabindex]\", \".dx-treelist-pager [tabindex]\"]\n};\nvar isMouseDown = false;\nvar isHiddenFocusing = false;\nvar focusedElementInfo = null;\n\nfunction processKeyDown(viewName, instance, event, action, $mainElement, executeKeyDown) {\n  var isHandled = fireKeyDownEvent(instance, event.originalEvent, executeKeyDown);\n\n  if (isHandled) {\n    return;\n  }\n\n  var keyName = (0, _index.normalizeKeyName)(event);\n\n  if (\"enter\" === keyName || \"space\" === keyName) {\n    saveFocusedElementInfo(event.target, instance);\n    action && action({\n      event: event\n    });\n  } else {\n    if (\"tab\" === keyName) {\n      $mainElement.addClass(FOCUS_STATE_CLASS);\n    } else {\n      selectView(viewName, instance, event);\n    }\n  }\n}\n\nfunction saveFocusedElementInfo(target, instance) {\n  var $target = (0, _renderer.default)(target);\n  var ariaLabel = $target.attr(\"aria-label\");\n  var $activeElements = getActiveAccessibleElements(ariaLabel, instance.element());\n  var targetIndex = $activeElements.index($target);\n  focusedElementInfo = (0, _extend.extend)({}, {\n    ariaLabel: ariaLabel,\n    index: targetIndex\n  }, {\n    viewInstance: instance\n  });\n}\n\nfunction getActiveAccessibleElements(ariaLabel, viewElement) {\n  var $viewElement = (0, _renderer.default)(viewElement);\n  var $activeElements;\n\n  if (ariaLabel) {\n    $activeElements = $viewElement.find('[aria-label=\"'.concat(ariaLabel, '\"][tabindex]'));\n  } else {\n    $activeElements = $viewElement.find(\"[tabindex]\");\n  }\n\n  return $activeElements;\n}\n\nfunction findFocusedViewElement(viewSelectors) {\n  for (var index in viewSelectors) {\n    var selector = viewSelectors[index];\n    var $focusViewElement = (0, _renderer.default)(selector).first();\n\n    if ($focusViewElement.length) {\n      return $focusViewElement;\n    }\n  }\n}\n\nfunction fireKeyDownEvent(instance, event, executeAction) {\n  var args = {\n    event: event,\n    handled: false\n  };\n\n  if (executeAction) {\n    executeAction(args);\n  } else {\n    instance._createActionByOption(\"onKeyDown\")(args);\n  }\n\n  return args.handled;\n}\n\nfunction onDocumentVisibilityChange() {\n  isHiddenFocusing = \"visible\" === _dom_adapter.default.getDocument().visibilityState;\n}\n\nfunction subscribeVisibilityChange() {\n  _events_engine.default.on(_dom_adapter.default.getDocument(), \"visibilitychange\", onDocumentVisibilityChange);\n}\n\nfunction unsubscribeVisibilityChange() {\n  _events_engine.default.off(_dom_adapter.default.getDocument(), \"visibilitychange\", onDocumentVisibilityChange);\n}\n\nfunction hiddenFocus(element) {\n  isHiddenFocusing = true;\n  element.focus();\n  isHiddenFocusing = false;\n}\n\nfunction registerKeyboardAction(viewName, instance, $element, selector, action, executeKeyDown) {\n  if (instance.option(\"useLegacyKeyboardNavigation\")) {\n    return _common.noop;\n  }\n\n  var $mainElement = (0, _renderer.default)(instance.element());\n\n  var keyDownHandler = function (e) {\n    return processKeyDown(viewName, instance, e, action, $mainElement, executeKeyDown);\n  };\n\n  var mouseDownHandler = function () {\n    isMouseDown = true;\n    $mainElement.removeClass(FOCUS_STATE_CLASS);\n  };\n\n  var focusinHandler = function () {\n    var needShowOverlay = !isMouseDown && !isHiddenFocusing;\n\n    if (needShowOverlay) {\n      $mainElement.addClass(FOCUS_STATE_CLASS);\n    }\n\n    isMouseDown = false;\n  };\n\n  _events_engine.default.on($element, \"keydown\", selector, keyDownHandler);\n\n  _events_engine.default.on($element, \"mousedown\", selector, mouseDownHandler);\n\n  _events_engine.default.on($element, \"focusin\", selector, focusinHandler);\n\n  return function () {\n    _events_engine.default.off($element, \"keydown\", selector, keyDownHandler);\n\n    _events_engine.default.off($element, \"mousedown\", selector, mouseDownHandler);\n\n    _events_engine.default.off($element, \"focusin\", selector, focusinHandler);\n  };\n}\n\nfunction restoreFocus(instance) {\n  if (!instance.option(\"useLegacyKeyboardNavigation\") && focusedElementInfo) {\n    var viewInstance = focusedElementInfo.viewInstance;\n\n    if (viewInstance) {\n      var $activeElements = getActiveAccessibleElements(focusedElementInfo.ariaLabel, viewInstance.element());\n      var $targetElement = $activeElements.eq(focusedElementInfo.index);\n      focusedElementInfo = null;\n\n      _events_engine.default.trigger($targetElement, \"focus\");\n    }\n  }\n}\n\nfunction selectView(viewName, instance, event) {\n  var keyName = (0, _index.normalizeKeyName)(event);\n\n  if (event.ctrlKey && (\"upArrow\" === keyName || \"downArrow\" === keyName)) {\n    var viewNames = Object.keys(viewItemSelectorMap);\n    var viewItemIndex = viewNames.indexOf(viewName);\n\n    while (viewItemIndex >= 0 && viewItemIndex < viewNames.length) {\n      viewItemIndex = \"upArrow\" === keyName ? --viewItemIndex : ++viewItemIndex;\n      var _viewName = viewNames[viewItemIndex];\n      var viewSelectors = viewItemSelectorMap[_viewName];\n      var $focusViewElement = findFocusedViewElement(viewSelectors);\n\n      if ($focusViewElement && $focusViewElement.length) {\n        $focusViewElement.attr(\"tabindex\", instance.option(\"tabindex\") || 0);\n\n        _events_engine.default.trigger($focusViewElement, \"focus\");\n\n        $focusViewElement.removeClass(FOCUS_DISABLED_CLASS);\n        break;\n      }\n    }\n  }\n}\n\nfunction setTabIndex(instance, $element) {\n  if (!instance.option(\"useLegacyKeyboardnavigation\")) {\n    $element.attr(\"tabindex\", instance.option(\"tabindex\") || 0);\n  }\n}","map":{"version":3,"sources":["C:/Users/CapiniaC/Desktop/Collection/Work/project/security/node_modules/devextreme/ui/shared/accessibility.js"],"names":["exports","subscribeVisibilityChange","unsubscribeVisibilityChange","hiddenFocus","registerKeyboardAction","restoreFocus","selectView","setTabIndex","_renderer","_interopRequireDefault","require","_events_engine","_index","_extend","_dom_adapter","_common","obj","__esModule","FOCUS_STATE_CLASS","FOCUS_DISABLED_CLASS","FOCUSED_ROW_SELECTOR","GRID_ROW_SELECTOR","GRID_CELL_SELECTOR","concat","TREELIST_ROW_SELECTOR","TREELIST_CELL_SELECTOR","viewItemSelectorMap","groupPanel","columnHeaders","filterRow","rowsView","footer","filterPanel","pager","isMouseDown","isHiddenFocusing","focusedElementInfo","processKeyDown","viewName","instance","event","action","$mainElement","executeKeyDown","isHandled","fireKeyDownEvent","originalEvent","keyName","normalizeKeyName","saveFocusedElementInfo","target","addClass","$target","default","ariaLabel","attr","$activeElements","getActiveAccessibleElements","element","targetIndex","index","extend","viewInstance","viewElement","$viewElement","find","findFocusedViewElement","viewSelectors","selector","$focusViewElement","first","length","executeAction","args","handled","_createActionByOption","onDocumentVisibilityChange","getDocument","visibilityState","on","off","focus","$element","option","noop","keyDownHandler","e","mouseDownHandler","removeClass","focusinHandler","needShowOverlay","$targetElement","eq","trigger","ctrlKey","viewNames","Object","keys","viewItemIndex","indexOf","_viewName"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/shared/accessibility.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.subscribeVisibilityChange = subscribeVisibilityChange;\r\nexports.unsubscribeVisibilityChange = unsubscribeVisibilityChange;\r\nexports.hiddenFocus = hiddenFocus;\r\nexports.registerKeyboardAction = registerKeyboardAction;\r\nexports.restoreFocus = restoreFocus;\r\nexports.selectView = selectView;\r\nexports.setTabIndex = setTabIndex;\r\nvar _renderer = _interopRequireDefault(require(\"../../core/renderer\"));\r\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\r\nvar _index = require(\"../../events/utils/index\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _dom_adapter = _interopRequireDefault(require(\"../../core/dom_adapter\"));\r\nvar _common = require(\"../../core/utils/common\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar FOCUS_STATE_CLASS = \"dx-state-focused\";\r\nvar FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar FOCUSED_ROW_SELECTOR = \".dx-row-focused\";\r\nvar GRID_ROW_SELECTOR = \".dx-datagrid-rowsview .dx-row\";\r\nvar GRID_CELL_SELECTOR = \"\".concat(GRID_ROW_SELECTOR, \" > td\");\r\nvar TREELIST_ROW_SELECTOR = \".dx-treelist-rowsview .dx-row\";\r\nvar TREELIST_CELL_SELECTOR = \"\".concat(TREELIST_ROW_SELECTOR, \" > td\");\r\nvar viewItemSelectorMap = {\r\n    groupPanel: [\".dx-datagrid-group-panel .dx-group-panel-item[tabindex]\"],\r\n    columnHeaders: [\".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action\", \".dx-treelist-headers .dx-header-row > td.dx-treelist-action\"],\r\n    filterRow: [\".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input\", \".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input\"],\r\n    rowsView: [\"\".concat(FOCUSED_ROW_SELECTOR), \"\".concat(GRID_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR), \"\".concat(TREELIST_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR)],\r\n    footer: [\".dx-datagrid-total-footer .dx-datagrid-summary-item\", \".dx-treelist-total-footer .dx-treelist-summary-item\"],\r\n    filterPanel: [\".dx-datagrid-filter-panel .dx-icon-filter\", \".dx-treelist-filter-panel .dx-icon-filter\"],\r\n    pager: [\".dx-datagrid-pager [tabindex]\", \".dx-treelist-pager [tabindex]\"]\r\n};\r\nvar isMouseDown = false;\r\nvar isHiddenFocusing = false;\r\nvar focusedElementInfo = null;\r\n\r\nfunction processKeyDown(viewName, instance, event, action, $mainElement, executeKeyDown) {\r\n    var isHandled = fireKeyDownEvent(instance, event.originalEvent, executeKeyDown);\r\n    if (isHandled) {\r\n        return\r\n    }\r\n    var keyName = (0, _index.normalizeKeyName)(event);\r\n    if (\"enter\" === keyName || \"space\" === keyName) {\r\n        saveFocusedElementInfo(event.target, instance);\r\n        action && action({\r\n            event: event\r\n        })\r\n    } else {\r\n        if (\"tab\" === keyName) {\r\n            $mainElement.addClass(FOCUS_STATE_CLASS)\r\n        } else {\r\n            selectView(viewName, instance, event)\r\n        }\r\n    }\r\n}\r\n\r\nfunction saveFocusedElementInfo(target, instance) {\r\n    var $target = (0, _renderer.default)(target);\r\n    var ariaLabel = $target.attr(\"aria-label\");\r\n    var $activeElements = getActiveAccessibleElements(ariaLabel, instance.element());\r\n    var targetIndex = $activeElements.index($target);\r\n    focusedElementInfo = (0, _extend.extend)({}, {\r\n        ariaLabel: ariaLabel,\r\n        index: targetIndex\r\n    }, {\r\n        viewInstance: instance\r\n    })\r\n}\r\n\r\nfunction getActiveAccessibleElements(ariaLabel, viewElement) {\r\n    var $viewElement = (0, _renderer.default)(viewElement);\r\n    var $activeElements;\r\n    if (ariaLabel) {\r\n        $activeElements = $viewElement.find('[aria-label=\"'.concat(ariaLabel, '\"][tabindex]'))\r\n    } else {\r\n        $activeElements = $viewElement.find(\"[tabindex]\")\r\n    }\r\n    return $activeElements\r\n}\r\n\r\nfunction findFocusedViewElement(viewSelectors) {\r\n    for (var index in viewSelectors) {\r\n        var selector = viewSelectors[index];\r\n        var $focusViewElement = (0, _renderer.default)(selector).first();\r\n        if ($focusViewElement.length) {\r\n            return $focusViewElement\r\n        }\r\n    }\r\n}\r\n\r\nfunction fireKeyDownEvent(instance, event, executeAction) {\r\n    var args = {\r\n        event: event,\r\n        handled: false\r\n    };\r\n    if (executeAction) {\r\n        executeAction(args)\r\n    } else {\r\n        instance._createActionByOption(\"onKeyDown\")(args)\r\n    }\r\n    return args.handled\r\n}\r\n\r\nfunction onDocumentVisibilityChange() {\r\n    isHiddenFocusing = \"visible\" === _dom_adapter.default.getDocument().visibilityState\r\n}\r\n\r\nfunction subscribeVisibilityChange() {\r\n    _events_engine.default.on(_dom_adapter.default.getDocument(), \"visibilitychange\", onDocumentVisibilityChange)\r\n}\r\n\r\nfunction unsubscribeVisibilityChange() {\r\n    _events_engine.default.off(_dom_adapter.default.getDocument(), \"visibilitychange\", onDocumentVisibilityChange)\r\n}\r\n\r\nfunction hiddenFocus(element) {\r\n    isHiddenFocusing = true;\r\n    element.focus();\r\n    isHiddenFocusing = false\r\n}\r\n\r\nfunction registerKeyboardAction(viewName, instance, $element, selector, action, executeKeyDown) {\r\n    if (instance.option(\"useLegacyKeyboardNavigation\")) {\r\n        return _common.noop\r\n    }\r\n    var $mainElement = (0, _renderer.default)(instance.element());\r\n    var keyDownHandler = function(e) {\r\n        return processKeyDown(viewName, instance, e, action, $mainElement, executeKeyDown)\r\n    };\r\n    var mouseDownHandler = function() {\r\n        isMouseDown = true;\r\n        $mainElement.removeClass(FOCUS_STATE_CLASS)\r\n    };\r\n    var focusinHandler = function() {\r\n        var needShowOverlay = !isMouseDown && !isHiddenFocusing;\r\n        if (needShowOverlay) {\r\n            $mainElement.addClass(FOCUS_STATE_CLASS)\r\n        }\r\n        isMouseDown = false\r\n    };\r\n    _events_engine.default.on($element, \"keydown\", selector, keyDownHandler);\r\n    _events_engine.default.on($element, \"mousedown\", selector, mouseDownHandler);\r\n    _events_engine.default.on($element, \"focusin\", selector, focusinHandler);\r\n    return function() {\r\n        _events_engine.default.off($element, \"keydown\", selector, keyDownHandler);\r\n        _events_engine.default.off($element, \"mousedown\", selector, mouseDownHandler);\r\n        _events_engine.default.off($element, \"focusin\", selector, focusinHandler)\r\n    }\r\n}\r\n\r\nfunction restoreFocus(instance) {\r\n    if (!instance.option(\"useLegacyKeyboardNavigation\") && focusedElementInfo) {\r\n        var viewInstance = focusedElementInfo.viewInstance;\r\n        if (viewInstance) {\r\n            var $activeElements = getActiveAccessibleElements(focusedElementInfo.ariaLabel, viewInstance.element());\r\n            var $targetElement = $activeElements.eq(focusedElementInfo.index);\r\n            focusedElementInfo = null;\r\n            _events_engine.default.trigger($targetElement, \"focus\")\r\n        }\r\n    }\r\n}\r\n\r\nfunction selectView(viewName, instance, event) {\r\n    var keyName = (0, _index.normalizeKeyName)(event);\r\n    if (event.ctrlKey && (\"upArrow\" === keyName || \"downArrow\" === keyName)) {\r\n        var viewNames = Object.keys(viewItemSelectorMap);\r\n        var viewItemIndex = viewNames.indexOf(viewName);\r\n        while (viewItemIndex >= 0 && viewItemIndex < viewNames.length) {\r\n            viewItemIndex = \"upArrow\" === keyName ? --viewItemIndex : ++viewItemIndex;\r\n            var _viewName = viewNames[viewItemIndex];\r\n            var viewSelectors = viewItemSelectorMap[_viewName];\r\n            var $focusViewElement = findFocusedViewElement(viewSelectors);\r\n            if ($focusViewElement && $focusViewElement.length) {\r\n                $focusViewElement.attr(\"tabindex\", instance.option(\"tabindex\") || 0);\r\n                _events_engine.default.trigger($focusViewElement, \"focus\");\r\n                $focusViewElement.removeClass(FOCUS_DISABLED_CLASS);\r\n                break\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction setTabIndex(instance, $element) {\r\n    if (!instance.option(\"useLegacyKeyboardnavigation\")) {\r\n        $element.attr(\"tabindex\", instance.option(\"tabindex\") || 0)\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"script"}